webpackJsonp([1],{"+JGB":function(e,t){},"+KE6":function(e,t){},"/Cky":function(e,t){},"0YKu":function(e,t){},"1elH":function(e,t){},"4qRi":function(e,t){},"5rvl":function(e,t){},"5xo9":function(e,t){},"6CuI":function(e,t){},"6NRn":function(e,t){},"7/v3":function(e,t){},"8uaj":function(e,t){},"95g0":function(e,t){},"9n10":function(e,t){},"BT/E":function(e,t){},Effp:function(e,t){},Fx4z:function(e,t){},H1RU:function(e,t){},HLrs:function(e,t){},HagG:function(e,t){},LQZ3:function(e,t){},LlQz:function(e,t){},NHnr:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("7+uW"),i=a("/ocq"),o=a("Dd8w"),n=a.n(o),l=a("NYxO"),r={name:"Header",data:function(){return{menuBtn:"el-icon-newfont-caidan",username:"",nickname:"",user:{oldpwd:"",newpwd:"",newpwdagain:""},dialog:{dialogFormVisible:!1,title:"修改密码",close:!1}}},computed:{isActive:function(){return!this.$store.getters.sidebar.opened}},created:function(){var e=window.localStorage,t=JSON.parse(e.user);this.username=t.user.account,this.nickname=t.name},methods:n()({},Object(l.c)({bindLogout:"BIND_LOGOUT"}),{handleMenu:function(){this.$store.dispatch("ToggleSideBar")},logout:function(){var e=this;this.$confirm("是否退出账户?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t=e;t.$api.post("/super_admin/logout",t.user,function(a){if(a.status>=200&&a.status<300){console.log(a.data);var s=a.data;0==s.code?(t.$message({message:"退出登录成功",type:"success"}),t.dialog.dialogFormVisible=!1,t.$router.push("/superAdmin/login")):t.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"})})}).catch(function(){})},handleEdit:function(){this.user.oldpwd="",this.user.newpwd="",this.user.newpwdagain="",this.dialog.dialogFormVisible=!0},handleSave:function(){var e=this;if(this.user.newpwd==this.user.newpwdagain){var t=this;t.$api.put("/super_admin/setpassword",t.user,function(a){if(a.status>=200&&a.status<300){console.log(a.data);var s=a.data;0==s.code?(e.$message({message:"修改成功,请使用新密码登录",type:"success"}),t.dialog.dialogFormVisible=!1,t.$router.push("/superAdmin/login")):t.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"})})}else this.$message({type:"error",message:"两次输入的新密码不一致"})}})},c={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"header"},[a("div",{staticClass:"logo",class:{"is-active":e.isActive}},[e._v("\n    点餐系统\n  ")]),e._v(" "),a("div",{staticClass:"navbar"},[a("div",{staticClass:"btn",class:{"is-active":e.isActive},on:{click:e.handleMenu}},[a("span",{class:e.menuBtn})]),e._v(" "),a("el-dropdown",{attrs:{trigger:"click"}},[a("span",{staticClass:"el-dropdown-link"},[e._v("\n        "+e._s(e.nickname)),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{nativeOn:{click:function(t){return e.handleEdit(t)}}},[e._v("修改密码")]),e._v(" "),a("el-dropdown-item",{nativeOn:{click:function(t){return e.logout(t)}}},[e._v("退出 ")])],1)],1)],1),e._v(" "),a("el-dialog",{attrs:{title:e.dialog.title,visible:e.dialog.dialogFormVisible,"close-on-click-modal":e.dialog.close},on:{"update:visible":function(t){return e.$set(e.dialog,"dialogFormVisible",t)}}},[a("el-form",{attrs:{model:e.user}},[a("el-form-item",{attrs:{label:"原密码","label-width":"100px"}},[a("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:e.user.oldpwd,callback:function(t){e.$set(e.user,"oldpwd",t)},expression:"user.oldpwd"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"新密码","label-width":"100px"}},[a("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:e.user.newpwd,callback:function(t){e.$set(e.user,"newpwd",t)},expression:"user.newpwd"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"重输新密码","label-width":"100px"}},[a("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:e.user.newpwdagain,callback:function(t){e.$set(e.user,"newpwdagain",t)},expression:"user.newpwdagain"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialog.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleSave}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var d=a("VU/8")(r,c,!1,function(e){a("WuM8")},"data-v-613b00d0",null).exports,u={name:"Breadcrumb",computed:{list:function(){return this.$route.matched}},created:function(){console.log(this.$route)}},g={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"breadcrumb"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/manage"}}},[e._v("首页")]),e._v(" "),e._l(e.$route.meta,function(t,s){return a("el-breadcrumb-item",{key:s,attrs:{to:{path:t.path}}},[e._v(e._s(t.name))])})],2)],1)},staticRenderFns:[]};var p=a("VU/8")(u,g,!1,function(e){a("hNsE")},"data-v-5269820b",null).exports,m={render:function(){var e=this.$createElement;return(this._self._c||e)("div",{staticClass:"footer"},[this._v("\n   版权所有 Copyright @ 2019 - 2099\n")])},staticRenderFns:[]};var h=a("VU/8")({},m,!1,function(e){a("bbGG")},"data-v-5199f4f8",null).exports,v={name:"Sidebar",data:function(){return{}},computed:n()({},Object(l.b)(["sidebar"]),{isCollapse:function(){return!this.sidebar.opened},activeIndex:function(){var e=this.$route.path;return"details"===this.$route.name?"/tables/details":e}}),methods:{}},f={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"sidebar"},[t("el-menu",{staticClass:"el-menu-vertical-demo",attrs:{"default-active":this.activeIndex,router:"",collapse:this.isCollapse,"background-color":"#545c64","text-color":"#fff","active-text-color":"#ffd04b"}},[t("el-menu-item",{attrs:{index:"/superAdmin/mainStore"}},[t("i",{staticClass:"el-icon-service"}),this._v(" "),t("span",{attrs:{slot:"title"},slot:"title"},[this._v("店家管理")])]),this._v(" "),t("el-menu-item",{attrs:{index:"/superAdmin/active"}},[t("i",{staticClass:"el-icon-setting"}),this._v(" "),t("span",{attrs:{slot:"title"},slot:"title"},[this._v("系统设置")])])],1)],1)},staticRenderFns:[]};var _=a("VU/8")(v,f,!1,function(e){a("nnuq")},"data-v-64b68e7e",null).exports,b={name:"Scrolltotop",data:function(){return{show:!1,scrollTop:document.documentElement.scrollTop||document.body.scrollTop}},computed:{},mounted:function(){this.$nextTick(function(){window.addEventListener("scroll",this.bindScroll,!0)})},destroyed:function(){window.addEventListener("scroll",this.bindScroll,!0)},methods:{bindScroll:function(){this.scrollTop=document.documentElement.scrollTop||document.body.scrollTop,this.scrollTop>100?this.show=!0:this.show=!1},backToTop:function(){var e=setInterval(function(){document.documentElement.scrollTop||document.body.scrollTop?(document.body.scrollTop-=100,document.documentElement.scrollTop-=100):clearInterval(e)},0)}}},y={render:function(){var e=this.$createElement,t=this._self._c||e;return t("transition",{attrs:{name:"slide"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:this.show,expression:"show"}],staticClass:"scrolltotop",on:{click:this.backToTop}},[t("i",{staticClass:"el-icon-arrow-up"})])])},staticRenderFns:[]};var w=a("VU/8")(b,y,!1,function(e){a("Effp")},"data-v-4e240626",null).exports,$=a("lbHh"),k=a.n($),x={state:{sidebar:{opened:!+k.a.get("sidebarStatus")},device:"desktop"},mutations:{TOGGLE_SIDEBAR:function(e){e.sidebar.opened?k.a.set("sidebarStatus",1):k.a.set("sidebarStatus",0),e.sidebar.opened=!e.sidebar.opened},CLOSE_SIDEBAR:function(e){k.a.set("sidebarStatus",1),e.sidebar.opened=!1},TOGGLE_DEVICE:function(e,t){e.device=t}},actions:{ToggleSideBar:function(e){(0,e.commit)("TOGGLE_SIDEBAR")},CloseSideBar:function(e){(0,e.commit)("CLOSE_SIDEBAR")},ToggleDevice:function(e,t){(0,e.commit)("TOGGLE_DEVICE",t)}}},S={sidebar:function(e){return e.app.sidebar},device:function(e){return e.app.device}};s.default.use(l.a);var D=new l.a.Store({modules:{app:x},getters:S}),C=document.body,F={watch:{$route:function(){"mobile"===this.$store.state.app.device&&this.$store.state.app.sidebar.opened&&D.dispatch("CloseSideBar")}},beforeMount:function(){window.addEventListener("resize",this.resizeHandler)},mounted:function(){this.isMobile()&&(D.dispatch("ToggleDevice","mobile"),D.dispatch("CloseSideBar"))},methods:{isMobile:function(){return C.getBoundingClientRect().width-1<992},resizeHandler:function(){if(!document.hidden){var e=this.isMobile();D.dispatch("ToggleDevice",e?"mobile":"desktop"),e&&D.dispatch("CloseSideBar")}}}},T={name:"Full",components:{Header:d,Breadcrumb:p,Footer:h,Siderbar:_,Scrolltotop:w},mixins:[F],computed:{},created:function(){},methods:{}},P={render:function(){var e=this.$createElement,t=this._self._c||e;return t("el-container",[t("el-header",[t("Header")],1),this._v(" "),t("el-container",[t("Siderbar"),this._v(" "),t("el-container",[t("el-main",[t("Breadcrumb"),this._v(" "),t("transition",{attrs:{name:"fade-transform",mode:"out-in"}},[t("router-view")],1)],1),this._v(" "),t("el-footer",[t("Footer")],1)],1)],1),this._v(" "),t("Scrolltotop")],1)},staticRenderFns:[]};var V=a("VU/8")(T,P,!1,function(e){a("95g0")},"data-v-09a8c893",null).exports,z=a("mvHQ"),U=a.n(z),E="/api",B="",N="//qc.fangwei6.com";B="//static.fangwei6.com";var M={name:"Login",components:{},data:function(){return{baseUrl:E,user:{account:"",password:""},rules:{account:[{validator:function(e,t,a){""===t?a(new Error("请输入用户名")):a()},trigger:"change"}],password:[{validator:function(e,t,a){""===t?a(new Error("请输入密码")):a()},trigger:"change"}]}}},mounted:function(){},methods:{login:function(e){var t=this;this.$refs[e].validate(function(e){if(e){var a=t;a.$api.post("/super_admin/login",a.user,function(e){if(e.status>=200&&e.status<300){console.log(e.data);var a=e.data;if(0==a.code){t.$message({message:"登录成功",type:"success"}),console.log(a.data);var s=window.localStorage;s.access_token=a.data.user.user.accessToken,s.user=U()(a.data.user),t.$router.push("/superAdmin/index")}else t.$message({message:a.msg,type:"warning"})}else t.$message({message:"服务器维护中",type:"error"})})}})},gotoRegist:function(){this.$router.push({path:"/register"})}}},O={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"login-wrapper"},[a("div",{staticClass:"login"},[a("p",{staticClass:"title"},[e._v("点餐系统(平台)")]),e._v(" "),a("el-form",{ref:"user",staticClass:"demo-ruleForm",attrs:{model:e.user,"status-icon":"",rules:e.rules,"label-width":"0"}},[a("el-form-item",{attrs:{prop:"account"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入用户名"},model:{value:e.user.account,callback:function(t){e.$set(e.user,"account",t)},expression:"user.account"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"password"}},[a("el-input",{attrs:{type:"password","auto-complete":"off",placeholder:"输入密码"},model:{value:e.user.password,callback:function(t){e.$set(e.user,"password",t)},expression:"user.password"}})],1),e._v(" "),a("el-form-item",[a("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:function(t){return e.login("user")}}},[e._v("登录")])],1)],1)],1)])])},staticRenderFns:[]};var R=a("VU/8")(M,O,!1,function(e){a("SWsK")},"data-v-6c85be4f",null).exports,I={data:function(){return{baseUrl:E,baseImgPath:B,loading:!1,admin:{id:0,account:"",storePrefix:"",name:"",province:"",city:"",area:"",address:"",telephons:"",limitStore:"",note:"",isFreeze:"0"},dialog:{dialogFormVisible:!1,title:"新增店家",close:!1},pages:{offset:0,pageSize:10,page:1,total:0},userTableData:[]}},created:function(){this.initData()},methods:{initData:function(){var e=this;this.loading=!0;var t=this;t.$api.get("/super_admin/main_store",t.pages,function(a){if(a.status>=200&&a.status<300){var s=a.data;0==s.code?(t.userTableData=s.data.main_store.content,t.pages.total=s.data.main_store.totalElements):e.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"});e.loading=!1})},handleSizeChange:function(e){console.log("每页 "+e+" 条")},handleCurrentChange:function(e){this.pages.page=e,this.pages.offset=(e-1)*this.pages.pageSize,this.initData()},rreezeFormat:function(e,t){return 1==e.user.isFreeze?"冻结":"正常"},handleEdit:function(e,t,a){"edit"==a?(this.dialog.title="修改店家",this.admin.id=t.id,this.admin.account=t.user.account,this.admin.name=t.name,this.admin.province=t.province,this.admin.city=t.city,this.admin.area=t.area,this.admin.address=t.address,this.admin.telephons=t.telephons,this.admin.limitStore=t.limitStore,this.admin.note=t.note,this.admin.isFreeze=""+t.user.isFreeze,this.admin.storePrefix=t.storePrefix,this.dialog.dialogFormVisible=!0):"add"==a&&(this.dialog.title="新增店家",this.admin.id=0,this.admin.account="",this.admin.name="",this.admin.province="",this.admin.city="",this.admin.area="",this.admin.address="",this.admin.telephons="",this.admin.limitStore=1,this.admin.note="",this.admin.isFreeze="0",this.admin.storePrefix="",this.dialog.dialogFormVisible=!0)},handleSave:function(){var e=this;this.loading=!0;var t=this;t.$api.post("/super_admin/main_store",t.admin,function(a){if(a.status>=200&&a.status<300){console.log(a.data);var s=a.data;0==s.code?(e.$message({message:t.dialog.title+"成功",type:"success"}),e.dialog.dialogFormVisible=!1,e.initData()):e.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"})}),this.loading=!1},handleDeleteAlert:function(e){var t=this;this.$confirm("此操作将删除该店家, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.handleDelete(e)}).catch(function(){})},handleDelete:function(e){var t=this;this.loading=!0;this.$api.delete("/super_admin/main_store/"+e.id,null,function(e){if(e.status>=200&&e.status<300){console.log(e.data);var a=e.data;0==a.code?(t.$message({message:"删除成功",type:"success"}),t.loading=!1,t.initData()):t.$message({message:a.msg,type:"warning"})}else t.$message({message:"服务器维护中",type:"error"})})}}},A={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fillcontain"},[a("div",{staticClass:"table_container"},[a("el-row",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleEdit(0,"","add")}}},[e._v("新增店家")])],1),e._v(" "),a("br"),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.userTableData}},[a("el-table-column",{attrs:{label:"店名",prop:"name"}}),e._v(" "),a("el-table-column",{attrs:{label:"账号",prop:"user.account"}}),e._v(" "),a("el-table-column",{attrs:{label:"电话",prop:"telephons"}}),e._v(" "),a("el-table-column",{attrs:{label:"分店数",prop:"limitStore"}}),e._v(" "),a("el-table-column",{attrs:{label:"备注",prop:"note","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{label:"状态",formatter:e.rreezeFormat}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleEdit(t.$index,t.row,"edit")}}},[e._v("\n                    编辑\n                ")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.handleDeleteAlert(t.row)}}},[e._v("\n                  删除\n                ")])]}}])})],1),e._v(" "),a("div",{staticClass:"Pagination"},[a("el-pagination",{attrs:{"current-page":e.pages.page,"page-size":e.pages.pageSize,layout:"total, prev, pager, next",total:e.pages.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:e.dialog.title,visible:e.dialog.dialogFormVisible,"close-on-click-modal":e.dialog.close},on:{"update:visible":function(t){return e.$set(e.dialog,"dialogFormVisible",t)}}},[a("el-form",{attrs:{model:e.admin}},[a("el-form-item",{attrs:{label:"账号","label-width":"100px"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.admin.account,callback:function(t){e.$set(e.admin,"account",t)},expression:"admin.account"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"账号前缀","label-width":"100px"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.admin.storePrefix,callback:function(t){e.$set(e.admin,"storePrefix",t)},expression:"admin.storePrefix"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"店名","label-width":"100px"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.admin.name,callback:function(t){e.$set(e.admin,"name",t)},expression:"admin.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"省","label-width":"100px"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.admin.province,callback:function(t){e.$set(e.admin,"province",t)},expression:"admin.province"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"市","label-width":"100px"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.admin.city,callback:function(t){e.$set(e.admin,"city",t)},expression:"admin.city"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"区","label-width":"100px"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.admin.area,callback:function(t){e.$set(e.admin,"area",t)},expression:"admin.area"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"地址","label-width":"100px"}},[a("el-input",{attrs:{type:"textarea",rows:"4"},model:{value:e.admin.address,callback:function(t){e.$set(e.admin,"address",t)},expression:"admin.address"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"电话","label-width":"100px"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.admin.telephons,callback:function(t){e.$set(e.admin,"telephons",t)},expression:"admin.telephons"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"分店数","label-width":"100px"}},[a("el-input-number",{model:{value:e.admin.limitStore,callback:function(t){e.$set(e.admin,"limitStore",t)},expression:"admin.limitStore"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"备注","label-width":"100px"}},[a("el-input",{attrs:{type:"textarea",rows:"4"},model:{value:e.admin.note,callback:function(t){e.$set(e.admin,"note",t)},expression:"admin.note"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"状态","label-width":"100px"}},[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-text":"生效","inactive-text":"冻结","active-value":"0","inactive-value":"1"},model:{value:e.admin.isFreeze,callback:function(t){e.$set(e.admin,"isFreeze",t)},expression:"admin.isFreeze"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialog.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleSave}},[e._v("确 定")])],1)],1)],1)])},staticRenderFns:[]};var G=a("VU/8")(I,A,!1,function(e){a("5xo9")},null,null).exports,H={data:function(){return{baseUrl:E,baseImgPath:B,loading:!1,active:{host:"",endTime:"",overDay:"",code:""}}},created:function(){this.initData()},methods:{initData:function(){var e=this;this.loading=!0;var t=this;t.$api.get("/super_admin/system_active",null,function(a){if(a.status>=200&&a.status<300){var s=a.data;0==s.code?(t.active.host=s.data.host,t.active.endTime=s.data.endTime,t.active.overDay=s.data.overDay):e.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"});e.loading=!1})},save:function(){var e=this;this.loading=!0;this.$api.post("/super_admin/system_active",{code:this.active.code},function(t){if(t.status>=200&&t.status<300){console.log(t.data);var a=t.data;0==a.code?(e.$message({message:"激活成功",type:"success"}),e.initData()):e.$message({message:a.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"})}),this.loading=!1}}},L={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fillcontain"},[a("div",{staticClass:"table_container"},[a("el-form",{attrs:{model:e.active}},[null==e.active.host?a("el-form-item",{attrs:{label:"授权状态","label-width":"80px"}},[a("span",{staticStyle:{color:"red"}},[e._v("未授权")])]):e._e(),e._v(" "),null!=e.active.host?a("el-form-item",{attrs:{label:"授权域名","label-width":"80px"}},[e._v("\n            "+e._s(e.active.host)+"\n          ")]):e._e(),e._v(" "),null!=e.active.host?a("el-form-item",{attrs:{label:"有效期","label-width":"80px"}},[e.active.overDay>=36500?a("span",{staticStyle:{color:"green"}},[e._v("永久")]):e.active.overDay<=0?a("span",{staticStyle:{color:"red"}},[e._v("已过期")]):e.active.overDay<=7?a("span",{staticStyle:{color:"darkorange"}},[e._v("还有"+e._s(e.active.overDay)+"天过期")]):a("span",{staticStyle:{color:"green"}},[e._v(e._s(e.active.endTime))])]):e._e(),e._v(" "),a("el-form-item",{attrs:{label:"激活码","label-width":"80px"}},[a("el-input",{attrs:{type:"textarea",rows:"4",placeholder:"请输入激活码激活/延期"},model:{value:e.active.code,callback:function(t){e.$set(e.active,"code",t)},expression:"active.code"}})],1),e._v(" "),a("el-form-item",{attrs:{"label-width":"80px"}},[a("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("确 定")])],1)],1)],1)])},staticRenderFns:[]};var q=a("VU/8")(H,L,!1,function(e){a("lQ6k")},null,null).exports,j={name:"Header",data:function(){return{menuBtn:"el-icon-newfont-caidan",username:"",nickname:"",storeName:"",user:{oldpwd:"",newpwd:"",newpwdagain:""},dialog:{dialogFormVisible:!1,title:"修改密码",close:!1}}},computed:{isActive:function(){return!this.$store.getters.sidebar.opened}},created:function(){var e=window.localStorage,t=JSON.parse(e.user);this.username=t.user.account,this.nickname=t.name,this.storeName=t.name},methods:n()({},Object(l.c)({bindLogout:"BIND_LOGOUT"}),{handleMenu:function(){this.$store.dispatch("ToggleSideBar")},logout:function(){var e=this;this.$confirm("是否退出账户?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t=e;t.$api.post("/main_store/logout",t.user,function(a){if(a.status>=200&&a.status<300){console.log(a.data);var s=a.data;0==s.code?(t.$message({message:"退出登录成功",type:"success"}),t.dialog.dialogFormVisible=!1,t.$router.push("/mainStore/login")):t.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"})})}).catch(function(){})},handleEdit:function(){this.user.oldpwd="",this.user.newpwd="",this.user.newpwdagain="",this.dialog.dialogFormVisible=!0},handleSave:function(){var e=this;if(this.user.newpwd==this.user.newpwdagain){var t=this;t.$api.put("/main_store/setpassword",t.user,function(a){if(a.status>=200&&a.status<300){console.log(a.data);var s=a.data;0==s.code?(e.$message({message:"修改成功,请使用新密码登录",type:"success"}),t.dialog.dialogFormVisible=!1,t.$router.push("/mainStore/login")):t.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"})})}else this.$message({type:"error",message:"两次输入的新密码不一致"})}})},W={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"header"},[a("div",{staticClass:"logo",class:{"is-active":e.isActive}},[e._v("\n    "+e._s(e.storeName)+"-管理员后台\n  ")]),e._v(" "),a("div",{staticClass:"navbar"},[a("div",{staticClass:"btn",class:{"is-active":e.isActive},on:{click:e.handleMenu}},[a("span",{class:e.menuBtn})]),e._v(" "),a("el-dropdown",{attrs:{trigger:"click"}},[a("span",{staticClass:"el-dropdown-link"},[e._v("\n        "+e._s(e.nickname)),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{nativeOn:{click:function(t){return e.handleEdit(t)}}},[e._v("修改密码")]),e._v(" "),a("el-dropdown-item",{nativeOn:{click:function(t){return e.logout(t)}}},[e._v("退出 ")])],1)],1)],1),e._v(" "),a("el-dialog",{attrs:{title:e.dialog.title,visible:e.dialog.dialogFormVisible,"close-on-click-modal":e.dialog.close},on:{"update:visible":function(t){return e.$set(e.dialog,"dialogFormVisible",t)}}},[a("el-form",{attrs:{model:e.user}},[a("el-form-item",{attrs:{label:"原密码","label-width":"100px"}},[a("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:e.user.oldpwd,callback:function(t){e.$set(e.user,"oldpwd",t)},expression:"user.oldpwd"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"新密码","label-width":"100px"}},[a("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:e.user.newpwd,callback:function(t){e.$set(e.user,"newpwd",t)},expression:"user.newpwd"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"重输新密码","label-width":"100px"}},[a("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:e.user.newpwdagain,callback:function(t){e.$set(e.user,"newpwdagain",t)},expression:"user.newpwdagain"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialog.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleSave}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var Q=a("VU/8")(j,W,!1,function(e){a("q405")},"data-v-17c9e24e",null).exports,J={name:"Sidebar",data:function(){return{}},computed:n()({},Object(l.b)(["sidebar"]),{isCollapse:function(){return!this.sidebar.opened},activeIndex:function(){var e=this.$route.path;return"details"===this.$route.name?"/tables/details":e}}),methods:{}},Y={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"sidebar"},[a("el-menu",{staticClass:"el-menu-vertical-demo",attrs:{"default-active":e.activeIndex,router:"",collapse:e.isCollapse,"background-color":"#545c64","text-color":"#fff","active-text-color":"#ffd04b"}},[a("el-menu-item",{attrs:{index:"/mainStore/store"}},[a("i",{staticClass:"el-icon-s-shop"}),e._v(" "),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("分店管理")])]),e._v(" "),a("el-menu-item",{attrs:{index:"/mainStore/orders"}},[a("i",{staticClass:"el-icon-s-order"}),e._v(" "),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("订单管理")])]),e._v(" "),a("el-submenu",{attrs:{index:"/goods"}},[a("template",{slot:"title"},[a("i",{staticClass:"el-icon-picture-outline-round"}),e._v(" "),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("菜品管理")])]),e._v(" "),a("el-menu-item",{attrs:{index:"/mainStore/goods"}},[e._v("菜品")]),e._v(" "),a("el-menu-item",{attrs:{index:"/mainStore/goodsTag"}},[e._v("菜品标签")])],2),e._v(" "),a("el-submenu",{attrs:{index:"/oauth_pay"}},[a("template",{slot:"title"},[a("i",{staticClass:"el-icon-chat-line-round"}),e._v(" "),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("点餐配置")])]),e._v(" "),a("el-menu-item",{attrs:{index:"/mainStore/payment"}},[e._v("支付配置")]),e._v(" "),a("el-menu-item",{attrs:{index:"/mainStore/oauth"}},[e._v("授权配置")]),e._v(" "),a("el-menu-item",{attrs:{index:"/mainStore/pageView"}},[e._v("主题配置")]),e._v(" "),a("el-menu-item",{attrs:{index:"/mainStore/chargeItem"}},[e._v("充值配置")])],2),e._v(" "),a("el-menu-item",{attrs:{index:"/mainStore/printerDataModel"}},[a("i",{staticClass:"el-icon-printer"}),e._v(" "),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("打印模板配置")])]),e._v(" "),a("el-menu-item",{attrs:{index:"/mainStore/pluginsStore"}},[a("i",{staticClass:"el-icon-goods"}),e._v(" "),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("插件市场")])])],1)],1)},staticRenderFns:[]};var K={name:"Full",components:{Header:Q,Breadcrumb:p,Footer:h,Siderbar:a("VU/8")(J,Y,!1,function(e){a("afH/")},"data-v-8e159128",null).exports,Scrolltotop:w},mixins:[F],computed:{},created:function(){},methods:{}},X={render:function(){var e=this.$createElement,t=this._self._c||e;return t("el-container",[t("el-header",[t("Header")],1),this._v(" "),t("el-container",[t("Siderbar"),this._v(" "),t("el-container",[t("el-main",[t("Breadcrumb"),this._v(" "),t("transition",{attrs:{name:"fade-transform",mode:"out-in"}},[t("router-view")],1)],1),this._v(" "),t("el-footer",[t("Footer")],1)],1)],1),this._v(" "),t("Scrolltotop")],1)},staticRenderFns:[]};var Z=a("VU/8")(K,X,!1,function(e){a("duFb")},"data-v-098515db",null).exports,ee={name:"Login",components:{},data:function(){return{baseUrl:E,user:{account:"",password:""},rules:{account:[{validator:function(e,t,a){""===t?a(new Error("请输入用户名")):a()},trigger:"change"}],password:[{validator:function(e,t,a){""===t?a(new Error("请输入密码")):a()},trigger:"change"}]}}},mounted:function(){},methods:{login:function(e){var t=this;this.$refs[e].validate(function(e){if(e){var a=t;a.$api.post("/main_store/login",a.user,function(e){if(e.status>=200&&e.status<300){console.log(e.data);var a=e.data;if(0==a.code){t.$message({message:"登录成功",type:"success"}),console.log(a.data);var s=window.localStorage;s.access_token=a.data.user.user.accessToken,s.user=U()(a.data.user),t.$router.push("/mainStore/index")}else t.$message({message:a.msg,type:"warning"})}else t.$message({message:"服务器维护中",type:"error"})})}})},gotoRegist:function(){this.$router.push({path:"/register"})}}},te={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"login-wrapper"},[a("div",{staticClass:"login"},[a("p",{staticClass:"title"},[e._v("点餐系统(总部)")]),e._v(" "),a("el-form",{ref:"user",staticClass:"demo-ruleForm",attrs:{model:e.user,"status-icon":"",rules:e.rules,"label-width":"0"}},[a("el-form-item",{attrs:{prop:"account"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入用户名"},model:{value:e.user.account,callback:function(t){e.$set(e.user,"account",t)},expression:"user.account"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"password"}},[a("el-input",{attrs:{type:"password","auto-complete":"off",placeholder:"输入密码"},model:{value:e.user.password,callback:function(t){e.$set(e.user,"password",t)},expression:"user.password"}})],1),e._v(" "),a("el-form-item",[a("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:function(t){return e.login("user")}}},[e._v("登录")])],1)],1)],1)])])},staticRenderFns:[]};var ae=a("VU/8")(ee,te,!1,function(e){a("poa5")},"data-v-60f0c935",null).exports,se={data:function(){return{baseUrl:E,baseImgPath:B,loading:!1,admin:{id:0,account:"",name:"",province:"",city:"",area:"",address:"",telephons:"",note:"",isFreeze:"0",startTime:"",endTime:"",configType:"1",payConfig:"1",orderGoodsType:"1"},storePrefix:"",dialog:{dialogFormVisible:!1,title:"新增分店",close:!1},pages:{offset:0,pageSize:10,page:1,total:0},userTableData:[],login_url:""}},created:function(){var e=window.localStorage,t=JSON.parse(e.user);this.storePrefix=t.storePrefix,this.initData()},methods:{initData:function(){var e=this;this.loading=!0;var t=this;t.$api.get("/main_store/store",t.pages,function(a){if(a.status>=200&&a.status<300){var s=a.data;0==s.code?(t.userTableData=s.data.stores.content,t.login_url=s.data.login_url,t.pages.total=s.data.stores.totalElements):e.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"});e.loading=!1})},handleSizeChange:function(e){console.log("每页 "+e+" 条")},handleCurrentChange:function(e){this.pages.page=e,this.pages.offset=(e-1)*this.pages.pageSize,this.initData()},rreezeFormat:function(e,t){return 1==e.user.isFreeze?"冻结":"正常"},handleEdit:function(e,t,a){"edit"==a?(this.dialog.title="修改分店",this.admin.id=t.id,this.admin.account=t.user.account,this.admin.name=t.name,this.admin.province=t.province,this.admin.city=t.city,this.admin.area=t.area,this.admin.address=t.address,this.admin.telephons=t.telephons,this.admin.note=t.note,this.admin.startTime=t.startTime,this.admin.endTime=t.endTime,this.admin.configType=""+t.configType,this.admin.payConfig=""+t.payConfig,this.admin.isFreeze=""+t.user.isFreeze,this.admin.orderGoodsType=""+t.orderGoodsType,this.dialog.dialogFormVisible=!0):"add"==a&&(this.dialog.title="新增分店",this.admin.id=0,this.admin.account="",this.admin.name="",this.admin.province="",this.admin.city="",this.admin.area="",this.admin.address="",this.admin.telephons="",this.admin.note="",this.admin.startTime="",this.admin.endTime="",this.admin.configType="1",this.admin.payConfig="1",this.admin.isFreeze="0",this.admin.orderGoodsType="1",this.dialog.dialogFormVisible=!0)},handleSave:function(){var e=this;this.loading=!0;var t=this;t.$api.post("/main_store/store",t.admin,function(a){if(a.status>=200&&a.status<300){console.log(a.data);var s=a.data;0==s.code?(e.$message({message:t.dialog.title+"成功",type:"success"}),e.dialog.dialogFormVisible=!1,e.initData()):e.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"})}),this.loading=!1},handleResetPwdAlert:function(e){var t=this;this.$confirm("此操作将重置该分店管理员的密码为:888888, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.handleResetPwd(e)}).catch(function(){})},handleResetPwd:function(e){var t=this;this.loading=!0;this.$api.put("/main_store/store/reset_password/"+e.id,null,function(e){if(e.status>=200&&e.status<300){console.log(e.data);var a=e.data;0==a.code?t.$message({message:"重置成功,请立即使用默认密码:888888 登录修改密码",type:"success"}):t.$message({message:a.msg,type:"warning"})}else t.$message({message:"服务器维护中",type:"error"});t.loading=!1})},handleDeleteAlert:function(e){var t=this;this.$confirm("此操作将删除该分店, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.handleDelete(e)}).catch(function(){})},handleDelete:function(e){var t=this;this.loading=!0;this.$api.delete("/main_store/store/"+e.id,null,function(e){if(e.status>=200&&e.status<300){console.log(e.data);var a=e.data;0==a.code?(t.$message({message:"删除成功",type:"success"}),t.loading=!1,t.initData()):t.$message({message:a.msg,type:"warning"})}else t.$message({message:"服务器维护中",type:"error"})})}}},ie={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fillcontain"},[a("div",{staticClass:"table_container"},[a("el-row",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleEdit(0,"","add")}}},[e._v("新增分店")])],1),e._v(" "),a("br"),e._v(" "),a("el-row",[a("el-alert",{attrs:{title:"分店管理员登录地址："+e.login_url,type:"success",closable:!1}})],1),e._v(" "),a("br"),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.userTableData}},[a("el-table-column",{attrs:{label:"店名",prop:"name"}}),e._v(" "),a("el-table-column",{attrs:{label:"账号",prop:"user.account"}}),e._v(" "),a("el-table-column",{attrs:{label:"电话",prop:"telephons"}}),e._v(" "),a("el-table-column",{attrs:{label:"备注",prop:"note","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{label:"状态",formatter:e.rreezeFormat}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"250"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleEdit(t.$index,t.row,"edit")}}},[e._v("\n                    编辑\n                ")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"warning"},on:{click:function(a){return e.handleResetPwdAlert(t.row)}}},[e._v("\n                  重置密码\n                ")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.handleDeleteAlert(t.row)}}},[e._v("\n                  删除\n                ")])]}}])})],1),e._v(" "),a("div",{staticClass:"Pagination"},[a("el-pagination",{attrs:{"current-page":e.pages.page,"page-size":e.pages.pageSize,layout:"total, prev, pager, next",total:e.pages.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:e.dialog.title,visible:e.dialog.dialogFormVisible,"close-on-click-modal":e.dialog.close},on:{"update:visible":function(t){return e.$set(e.dialog,"dialogFormVisible",t)}}},[a("el-form",{attrs:{model:e.admin}},[0==e.admin.id?a("el-form-item",{attrs:{label:"账号","label-width":"100px"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.admin.account,callback:function(t){e.$set(e.admin,"account",t)},expression:"admin.account"}},[a("template",{slot:"prepend"},[e._v(e._s(e.storePrefix))])],2),e._v(" "),a("br"),e._v(" "),""!=e.admin.account?a("el-alert",{attrs:{title:"帐号为："+e.storePrefix+e.admin.account,type:"success",closable:!1}}):e._e()],1):a("el-form-item",{attrs:{label:"账号","label-width":"100px"}},[e._v("\n                "+e._s(e.admin.account)+"\n              ")]),e._v(" "),0==e.admin.id?a("el-form-item",{attrs:{label:"密码","label-width":"100px"}},[a("span",[e._v("初始密码为：888888")])]):e._e(),e._v(" "),a("el-form-item",{attrs:{label:"店名","label-width":"100px"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.admin.name,callback:function(t){e.$set(e.admin,"name",t)},expression:"admin.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"省","label-width":"100px"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.admin.province,callback:function(t){e.$set(e.admin,"province",t)},expression:"admin.province"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"市","label-width":"100px"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.admin.city,callback:function(t){e.$set(e.admin,"city",t)},expression:"admin.city"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"区","label-width":"100px"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.admin.area,callback:function(t){e.$set(e.admin,"area",t)},expression:"admin.area"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"地址","label-width":"100px"}},[a("el-input",{attrs:{type:"textarea",rows:"4"},model:{value:e.admin.address,callback:function(t){e.$set(e.admin,"address",t)},expression:"admin.address"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"电话","label-width":"100px"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.admin.telephons,callback:function(t){e.$set(e.admin,"telephons",t)},expression:"admin.telephons"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"营业时间","label-width":"100px"}},[a("el-time-picker",{attrs:{"value-format":"HH:mm:ss",placeholder:"开始时间"},model:{value:e.admin.startTime,callback:function(t){e.$set(e.admin,"startTime",t)},expression:"admin.startTime"}}),e._v("\n                 至\n                "),a("el-time-picker",{attrs:{"value-format":"HH:mm:ss",placeholder:"结束时间"},model:{value:e.admin.endTime,callback:function(t){e.$set(e.admin,"endTime",t)},expression:"admin.endTime"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"授权/支付配置","label-width":"100px"}},[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-text":"统一配置","inactive-text":"独立配置","active-value":"1","inactive-value":"2"},model:{value:e.admin.configType,callback:function(t){e.$set(e.admin,"configType",t)},expression:"admin.configType"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"付费方式","label-width":"100px"}},[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-text":"下单付费","inactive-text":"吃完付费","active-value":"1","inactive-value":"2"},model:{value:e.admin.payConfig,callback:function(t){e.$set(e.admin,"payConfig",t)},expression:"admin.payConfig"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"后厨出餐模式","label-width":"100px"}},[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-text":"电脑模式","inactive-text":"打印机模式","active-value":"1","inactive-value":"2"},model:{value:e.admin.orderGoodsType,callback:function(t){e.$set(e.admin,"orderGoodsType",t)},expression:"admin.orderGoodsType"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"备注","label-width":"100px"}},[a("el-input",{attrs:{type:"textarea",rows:"4"},model:{value:e.admin.note,callback:function(t){e.$set(e.admin,"note",t)},expression:"admin.note"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"状态","label-width":"100px"}},[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-text":"生效","inactive-text":"冻结","active-value":"0","inactive-value":"1"},model:{value:e.admin.isFreeze,callback:function(t){e.$set(e.admin,"isFreeze",t)},expression:"admin.isFreeze"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialog.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleSave}},[e._v("确 定")])],1)],1)],1)])},staticRenderFns:[]};var oe=a("VU/8")(se,ie,!1,function(e){a("qDlq")},null,null).exports,ne={data:function(){return{baseUrl:E,baseImgPath:B,loading:!1,goods_tag:{id:0,name:""},dialog:{dialogFormVisible:!1,title:"新增菜品标签",close:!1},pages:{offset:0,pageSize:10,page:1,total:0},tableData:[]}},created:function(){this.initData()},methods:{initData:function(){var e=this;this.loading=!0;var t=this;t.$api.get("/main_store/goods_tag",t.pages,function(a){if(a.status>=200&&a.status<300){var s=a.data;0==s.code?(t.tableData=s.data.goods_tags.content,t.pages.total=s.data.goods_tags.totalElements):e.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"});e.loading=!1})},handleSizeChange:function(e){console.log("每页 "+e+" 条")},handleCurrentChange:function(e){this.pages.page=e,this.pages.offset=(e-1)*this.pages.pageSize,this.initData()},handleEdit:function(e,t,a){"edit"==a?(this.dialog.title="修改菜品标签",this.goods_tag.id=t.id,this.goods_tag.name=t.name,this.dialog.dialogFormVisible=!0):"add"==a&&(this.dialog.title="修改菜品标签",this.goods_tag.id=0,this.goods_tag.name="",this.dialog.dialogFormVisible=!0)},handleSave:function(){var e=this;this.loading=!0;var t=this;t.$api.post("/main_store/goods_tag",t.goods_tag,function(a){if(a.status>=200&&a.status<300){console.log(a.data);var s=a.data;0==s.code?(e.$message({message:t.dialog.title+"成功",type:"success"}),e.dialog.dialogFormVisible=!1,e.initData()):e.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"})}),this.loading=!1},handleDeleteAlert:function(e){var t=this;this.$confirm("此操作将删除该菜品标签, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.handleDelete(e)}).catch(function(){})},handleDelete:function(e){var t=this;this.loading=!0;this.$api.delete("/main_store/goods_tag/"+e.id,null,function(e){if(e.status>=200&&e.status<300){console.log(e.data);var a=e.data;0==a.code?(t.$message({message:"删除成功",type:"success"}),t.loading=!1,t.initData()):t.$message({message:a.msg,type:"warning"})}else t.$message({message:"服务器维护中",type:"error"})})}}},le={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fillcontain"},[a("div",{staticClass:"table_container"},[a("el-row",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleEdit(0,"","add")}}},[e._v("新增标签")])],1),e._v(" "),a("br"),e._v(" "),a("el-alert",{attrs:{title:"分店可以通过当前创建好的菜品标签进行快速复制标签",type:"success"}}),e._v(" "),a("br"),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData}},[a("el-table-column",{attrs:{label:"标签名",prop:"name"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleEdit(t.$index,t.row,"edit")}}},[e._v("\n                    编辑\n                ")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.handleDeleteAlert(t.row)}}},[e._v("\n                  删除\n                ")])]}}])})],1),e._v(" "),a("div",{staticClass:"Pagination"},[a("el-pagination",{attrs:{"current-page":e.pages.page,"page-size":e.pages.pageSize,layout:"total, prev, pager, next",total:e.pages.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:e.dialog.title,visible:e.dialog.dialogFormVisible,"close-on-click-modal":e.dialog.close},on:{"update:visible":function(t){return e.$set(e.dialog,"dialogFormVisible",t)}}},[a("el-form",{attrs:{model:e.goods_tag}},[a("el-form-item",{attrs:{label:"标签名","label-width":"100px"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.goods_tag.name,callback:function(t){e.$set(e.goods_tag,"name",t)},expression:"goods_tag.name"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialog.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleSave}},[e._v("确 定")])],1)],1)],1)])},staticRenderFns:[]};var re=a("VU/8")(ne,le,!1,function(e){a("x8PG")},null,null).exports,ce={data:function(){return{baseUrl:E,baseImgPath:B,uploadUrl:E+"/common/imageUpload",loading:!1,goods:{id:0,name:"",number:"",marker_price:"",sell_price:"",note:"",status:"1",pic_ids:"",tag_ids:"",outsideStatus:""},dialog:{dialogFormVisible:!1,title:"新增分店",close:!1},pages:{offset:0,pageSize:10,page:1,total:0,keyword:""},tableData:[],picFiles:[],picVisible:!1,picUrl:"",tagChecks:[]}},created:function(){this.initData()},methods:{initData:function(){var e=this;this.loading=!0;var t=this;t.$api.get("/main_store/goods",t.pages,function(a){if(a.status>=200&&a.status<300){var s=a.data;0==s.code?(t.tableData=s.data.goods.content,t.pages.total=s.data.goods.totalElements):e.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"});e.loading=!1})},handleSizeChange:function(e){console.log("每页 "+e+" 条")},handleCurrentChange:function(e){this.pages.page=e,this.pages.offset=(e-1)*this.pages.pageSize,this.initData()},statusFormat:function(e,t){return 2==e.status?"上架":"下架"},markerPriceFormat:function(e,t){return e.marker_price/100},sellPriceFormat:function(e,t){return e.sell_price/100},handleBeforeRemove:function(e,t){var a=this;return this.$confirm("此操作将删除该图片, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.handleRemove(e,t)}).catch(function(){}),!1},handleRemove:function(e,t){console.log(e);var a=this.picFiles.indexOf(e);console.log(a),a>-1&&this.picFiles.splice(a,1),console.log(this.picFiles)},handleSuccess:function(e,t,a){t.id=e.ids[0],console.log(e),t.url=this.baseUrl+e.thumbnails[0],t.downloadUrl=this.baseUrl+e.data[0],t.ext=e.exts[0],this.picFiles.push(t)},handlPicPreview:function(e){console.log(e),".jpg"==e.ext.toLowerCase()||".bmp"==e.ext.toLowerCase()||".jpeg"==e.ext.toLowerCase()||".png"==e.ext.toLowerCase()?(this.picUrl==e.downloadUrl?this.picVisible=!this.picVisible:this.picVisible=!0,this.picUrl=e.downloadUrl):(this.picVisible=!1,location.href=e.downloadUrl)},in_array:function(e,t){for(var a in t)if(t[a]==e)return!0;return!1},handleEdit:function(e,t,a){var s=this;this.tagChecks=[],this.$api.get("/main_store/goods_tag",{page:1,pageSize:1e4},function(e){if(e.status>=200&&e.status<300){var i=e.data;if(0==i.code){var o=i.data.goods_tags.content;if((r=o.length)>0)for(var n=0;n<r;n++){var l=o[n];s.tagChecks.push({check:!1,name:l.name,id:l.id})}if(s.picFiles=new Array,"edit"==a){var r;if(s.dialog.title="修改菜品",s.goods.id=t.id,s.goods.number=t.number,s.goods.name=t.name,s.goods.marker_price=t.marker_price/100,s.goods.sell_price=t.sell_price/100,s.goods.note=t.note,s.goods.status=""+t.status,s.goods.outsideStatus=""+t.outsideStatus,null!=t.pics&&t.pics.length>0)if((r=t.pics.length)>0)for(n=0;n<r;n++){var c=t.pics[n],d={name:c.name,url:s.baseUrl+c.thumbnail,id:c.id,downloadUrl:s.baseUrl+c.url,ext:c.ext};s.picFiles.push(d)}if(t.goodsTags.length>0&&s.tagChecks.length>0){var u=new Array;for(n=0;n<t.goodsTags.length;n++){l=t.goodsTags[n];u.push(l.id)}for(n=0;n<s.tagChecks.length;n++){l=s.tagChecks[n];s.in_array(l.id,u)&&(s.tagChecks[n].check=!0)}}s.dialog.dialogFormVisible=!0}else"add"==a&&(s.dialog.title="新增菜品",s.goods.id=0,s.goods.number="",s.goods.name="",s.goods.marker_price="",s.goods.sell_price="",s.goods.note="",s.goods.status="1",s.goods.outsideStatus="1",s.dialog.dialogFormVisible=!0)}else s.$message({message:"获取标签失败："+i.msg,type:"warning"})}else s.$message({message:"服务器维护中",type:"error"})})},handleSave:function(){var e=this;this.loading=!0;var t=this;t.goods.pic_ids="";for(var a=0,s=this.picFiles.length;a<s;a++)t.goods.pic_ids+=this.picFiles[a].id+"#";t.goods.tag_ids="",this.tagChecks.forEach(function(e,a){1==e.check&&(t.goods.tag_ids+=e.id+"#")}),t.goods.sell_price=100*t.goods.sell_price,t.goods.marker_price=100*t.goods.marker_price,t.$api.post("/main_store/goods",t.goods,function(a){if(a.status>=200&&a.status<300){console.log(a.data);var s=a.data;0==s.code?(e.$message({message:t.dialog.title+"成功",type:"success"}),e.dialog.dialogFormVisible=!1,e.initData()):e.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"})}),this.loading=!1},handleDeleteAlert:function(e){var t=this;this.$confirm("此操作将删除该菜品, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.handleDelete(e)}).catch(function(){})},handleDelete:function(e){var t=this;this.loading=!0;this.$api.delete("/main_store/goods/"+e.id,null,function(e){if(e.status>=200&&e.status<300){console.log(e.data);var a=e.data;0==a.code?(t.$message({message:"删除成功",type:"success"}),t.loading=!1,t.initData()):t.$message({message:a.msg,type:"warning"})}else t.$message({message:"服务器维护中",type:"error"})})}}},de={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fillcontain"},[a("div",{staticClass:"table_container"},[a("el-row",[a("el-col",{attrs:{span:8}},[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入菜品名字或编号查询"},model:{value:e.pages.keyword,callback:function(t){e.$set(e.pages,"keyword",t)},expression:"pages.keyword"}})],1),e._v(" "),a("el-col",{attrs:{span:3}},[a("el-button",{on:{click:e.initData}},[e._v("搜索")])],1),e._v(" "),a("el-col",{attrs:{span:2}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleEdit(0,"","add")}}},[e._v("新增菜品")])],1)],1),e._v(" "),a("br"),e._v(" "),a("el-row",[a("el-alert",{attrs:{title:"分店可以通过当前创建好的菜品进行快速创建菜单",type:"success"}})],1),e._v(" "),a("br"),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData}},[a("el-table-column",{attrs:{label:"主图"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.pics.length>0?a("img",{attrs:{src:e.baseImgPath+"/api"+t.row.pics[0].url,width:"50",height:"50"}}):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"菜名",prop:"name"}}),e._v(" "),a("el-table-column",{attrs:{label:"编号",prop:"number"}}),e._v(" "),a("el-table-column",{attrs:{label:"市场价",formatter:e.markerPriceFormat}}),e._v(" "),a("el-table-column",{attrs:{label:"销售价",formatter:e.sellPriceFormat}}),e._v(" "),a("el-table-column",{attrs:{label:"备注",prop:"note","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{label:"状态",formatter:e.statusFormat}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleEdit(t.$index,t.row,"edit")}}},[e._v("\n                    编辑\n                ")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.handleDeleteAlert(t.row)}}},[e._v("\n                  删除\n                ")])]}}])})],1),e._v(" "),a("div",{staticClass:"Pagination"},[a("el-pagination",{attrs:{"current-page":e.pages.page,"page-size":e.pages.pageSize,layout:"total, prev, pager, next",total:e.pages.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:e.dialog.title,visible:e.dialog.dialogFormVisible,"close-on-click-modal":e.dialog.close},on:{"update:visible":function(t){return e.$set(e.dialog,"dialogFormVisible",t)}}},[a("el-form",{attrs:{model:e.goods}},[a("el-form-item",{attrs:{label:"菜名","label-width":"80px"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.goods.name,callback:function(t){e.$set(e.goods,"name",t)},expression:"goods.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"编号","label-width":"80px"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.goods.number,callback:function(t){e.$set(e.goods,"number",t)},expression:"goods.number"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"市场价","label-width":"80px"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.goods.marker_price,callback:function(t){e.$set(e.goods,"marker_price",t)},expression:"goods.marker_price"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"销售价","label-width":"80px"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.goods.sell_price,callback:function(t){e.$set(e.goods,"sell_price",t)},expression:"goods.sell_price"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"备注","label-width":"80px"}},[a("el-input",{attrs:{type:"textarea",rows:"4"},model:{value:e.goods.note,callback:function(t){e.$set(e.goods,"note",t)},expression:"goods.note"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"状态","label-width":"80px"}},[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-text":"上架","inactive-text":"下架","active-value":"2","inactive-value":"1"},model:{value:e.goods.status,callback:function(t){e.$set(e.goods,"status",t)},expression:"goods.status"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"只限内部员工查看","label-width":"150px"}},[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-text":"不限制","inactive-text":"限制","active-value":"1","inactive-value":"2"},model:{value:e.goods.outsideStatus,callback:function(t){e.$set(e.goods,"outsideStatus",t)},expression:"goods.outsideStatus"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"标签","label-width":"80px"}},e._l(e.tagChecks,function(t,s){return a("el-checkbox",{key:s,attrs:{border:"",label:t.name,border:""},model:{value:t.check,callback:function(a){e.$set(t,"check",a)},expression:"item.check"}})}),1),e._v(" "),a("el-form-item",{attrs:{label:"图片","label-width":"80px"}},[a("div",{staticStyle:{"text-align":"left",margin:"5px"}},[a("el-upload",{attrs:{action:e.uploadUrl,"list-type":"picture-card","on-preview":e.handlPicPreview,"before-remove":e.handleBeforeRemove,"on-success":e.handleSuccess,"file-list":e.picFiles}},[a("i",{staticClass:"el-icon-plus"})]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.picVisible,expression:"picVisible"}],attrs:{size:"tiny"}},[a("img",{attrs:{width:"100%",src:e.picUrl,alt:""}})])],1)])],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialog.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleSave}},[e._v("确 定")])],1)],1)],1)])},staticRenderFns:[]};var ue=a("VU/8")(ce,de,!1,function(e){a("+JGB")},null,null).exports,ge={data:function(){return{baseUrl:E,baseImgPath:B,uploadUrl:E+"/common/imageUpload",keyUploadUrl:"",loading:!1,payment:{id:0,params:"",status:1},dialog:{dialogFormVisible:!1,title:"新增支付",close:!1},tableData:[],params:[],jsapi_url:""}},created:function(){this.initData()},methods:{initData:function(){var e=this;this.loading=!0;var t=this;t.$api.get("/main_store/payment_config",t.pages,function(a){if(a.status>=200&&a.status<300){var s=a.data;0==s.code?(t.tableData=s.data.paymentsConfigs,t.jsapi_url=s.data.jsapi_url):e.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"});e.loading=!1})},handleRemove:function(e,t){console.log(e,t)},handlePreview:function(e){console.log(e)},handleExceed:function(e,t){},beforeRemove:function(e,t){return this.$confirm("确定移除 "+e.name+"？")},statusFormat:function(e,t){return 2==e.status?"使用中":"未使用"},goBuy:function(e){this.$router.push({path:"/mainStore/pluginsStore",query:{uuid:e.uuid}})},handleSuccess:function(e,t,a){console.log(t),this.params[e.key].value=e.paths[0]},handleEdit:function(e,t,a){this.dialog.title="配置:"+t.name,this.payment.id=t.id,this.payment.status=""+t.status,this.payment.name=t.name,this.params=t.paramsMap,this.dialog.dialogFormVisible=!0},handleSave:function(){var e=this;console.log("++++++++++++++++"),console.log(this.params),this.loading=!0;var t=this;t.payment.params=U()(this.params),t.$api.put("/main_store/payment_config/"+t.payment.id,t.payment,function(a){if(a.status>=200&&a.status<300){console.log(a.data);var s=a.data;0==s.code?(e.$message({message:t.dialog.title+"成功",type:"success"}),e.dialog.dialogFormVisible=!1,e.initData()):e.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"})}),this.loading=!1}}},pe={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fillcontain"},[a("div",{staticClass:"table_container"},[a("el-alert",{attrs:{title:"当分店统一使用支付配置时，此配置会在分店的订单支付时生效",type:"success"}}),e._v(" "),a("br"),e._v(" "),a("el-alert",{attrs:{title:"支付jsapi地址:"+e.jsapi_url,type:"success"}}),e._v(" "),a("br"),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData}},[a("el-table-column",{attrs:{label:"支付方式",prop:"name"}}),e._v(" "),a("el-table-column",{attrs:{label:"使用状态",formatter:e.statusFormat}}),e._v(" "),a("el-table-column",{attrs:{label:"插件状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[4==t.row.plugins.status?a("span",{staticStyle:{color:"green"}},[e._v(e._s(t.row.plugins.statusStr))]):1==t.row.plugins.status?a("span",{staticStyle:{color:"red"}},[e._v(e._s(t.row.plugins.statusStr))]):2==t.row.plugins.status?a("span",{staticStyle:{color:"saddlebrown"}},[e._v(e._s(t.row.plugins.statusStr))]):3==t.row.plugins.status?a("span",{staticStyle:{color:"red"}},[e._v(e._s(t.row.plugins.statusStr))]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[4==t.row.plugins.status?a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleEdit(t.$index,t.row,"edit")}}},[e._v("\n                    配置\n                ")]):e._e(),e._v(" "),1==t.row.plugins.status||3==t.row.plugins.status?a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.goBuy(t.row.plugins)}}},[e._v("\n                  购买\n                ")]):e._e()]}}])})],1),e._v(" "),a("el-dialog",{attrs:{title:e.dialog.title,visible:e.dialog.dialogFormVisible,"close-on-click-modal":e.dialog.close},on:{"update:visible":function(t){return e.$set(e.dialog,"dialogFormVisible",t)}}},[a("el-form",{attrs:{model:e.payment}},[e._l(e.params,function(t,s){return a("el-form-item",{key:s,attrs:{label:s,"label-width":"100px"}},["text"==t.ele_type?a("el-input",{attrs:{"auto-complete":"off",placeholder:t.placeholder},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}}):e._e(),e._v(" "),"file"==t.ele_type?a("div",[""==t.value?a("el-upload",{attrs:{action:e.uploadUrl+"?key="+s,"on-success":e.handleSuccess,limit:1}},[a("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")]),e._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(e._s(t.placeholder))])],1):a("div",[e._v("\n                        已上传"+e._s(s)+"文件  "),a("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(e){t.value=""}}},[e._v("删除")])],1)],1):e._e()],1)}),e._v(" "),a("el-form-item",{attrs:{label:"状态","label-width":"80px"}},[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-text":"使用","inactive-text":"不使用","active-value":"2","inactive-value":"1"},model:{value:e.payment.status,callback:function(t){e.$set(e.payment,"status",t)},expression:"payment.status"}})],1)],2),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialog.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleSave}},[e._v("确 定")])],1)],1)],1)])},staticRenderFns:[]};var me=a("VU/8")(ge,pe,!1,function(e){a("VCSu")},null,null).exports,he={data:function(){return{baseUrl:E,baseImgPath:B,loading:!1,oauth:{id:0,params:"",status:"1"},dialog:{dialogFormVisible:!1,title:"新增授权",close:!1},tableData:[],params:[],oauth_callback_url:""}},created:function(){this.initData()},methods:{initData:function(){var e=this;this.loading=!0;var t=this;t.$api.get("/main_store/oauth_config",t.pages,function(a){if(a.status>=200&&a.status<300){var s=a.data;0==s.code?(t.tableData=s.data.oauthConfigs,t.oauth_callback_url=s.data.oauth_callback_url):e.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"});e.loading=!1})},handleSizeChange:function(e){console.log("每页 "+e+" 条")},handleCurrentChange:function(e){this.pages.page=e,this.pages.offset=(e-1)*this.pages.pageSize,this.initData()},goBuy:function(e){this.$router.push({path:"/mainStore/pluginsStore",query:{uuid:e.uuid}})},statusFormat:function(e,t){return 2==e.status?"使用中":"未使用"},handleEdit:function(e,t,a){this.dialog.title="配置:"+t.name,this.oauth.id=t.id,this.oauth.name=t.name,this.oauth.status=""+t.status,this.params=t.paramsMap,this.dialog.dialogFormVisible=!0},handleSave:function(){var e=this;this.loading=!0;var t=this;t.oauth.params=U()(this.params),t.$api.put("/main_store/oauth_config/"+t.oauth.id,t.oauth,function(a){if(a.status>=200&&a.status<300){console.log(a.data);var s=a.data;0==s.code?(e.$message({message:t.dialog.title+"成功",type:"success"}),e.dialog.dialogFormVisible=!1,e.initData()):e.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"})}),this.loading=!1}}},ve={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fillcontain"},[a("div",{staticClass:"table_container"},[a("el-alert",{attrs:{title:"当分店统一使用授权配置时，此配置会在分店的客户授权时生效",type:"success"}}),e._v(" "),a("el-alert",{attrs:{title:"授权回调地址:"+e.oauth_callback_url,type:"success"}}),e._v(" "),a("br"),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData}},[a("el-table-column",{attrs:{label:"授权方式",prop:"name"}}),e._v(" "),a("el-table-column",{attrs:{label:"使用状态",formatter:e.statusFormat}}),e._v(" "),a("el-table-column",{attrs:{label:"插件状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[4==t.row.plugins.status?a("span",{staticStyle:{color:"green"}},[e._v(e._s(t.row.plugins.statusStr))]):1==t.row.plugins.status?a("span",{staticStyle:{color:"red"}},[e._v(e._s(t.row.plugins.statusStr))]):2==t.row.plugins.status?a("span",{staticStyle:{color:"saddlebrown"}},[e._v(e._s(t.row.plugins.statusStr))]):3==t.row.plugins.status?a("span",{staticStyle:{color:"red"}},[e._v(e._s(t.row.plugins.statusStr))]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[4==t.row.plugins.status?a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleEdit(t.$index,t.row,"edit")}}},[e._v("\n                  配置\n                ")]):e._e(),e._v(" "),1==t.row.plugins.status||3==t.row.plugins.status?a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.goBuy(t.row.plugins)}}},[e._v("\n                  购买\n                ")]):e._e()]}}])})],1),e._v(" "),a("el-dialog",{attrs:{title:e.dialog.title,visible:e.dialog.dialogFormVisible,"close-on-click-modal":e.dialog.close},on:{"update:visible":function(t){return e.$set(e.dialog,"dialogFormVisible",t)}}},[a("el-form",{attrs:{model:e.oauth}},[e._l(e.params,function(t,s){return a("el-form-item",{key:s,attrs:{label:s,"label-width":"100px"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:t.placeholder},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}})],1)}),e._v(" "),a("el-form-item",{attrs:{label:"状态","label-width":"80px"}},[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-text":"使用","inactive-text":"不使用","active-value":"2","inactive-value":"1"},model:{value:e.oauth.status,callback:function(t){e.$set(e.oauth,"status",t)},expression:"oauth.status"}})],1)],2),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialog.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleSave}},[e._v("确 定")])],1)],1)],1)])},staticRenderFns:[]};var fe=a("VU/8")(he,ve,!1,function(e){a("1elH")},null,null).exports,_e={data:function(){return{baseUrl:E,baseImgPath:B,loading:!1,printerDataModel:{id:0,status:1,printData:""},dialog:{dialogFormVisible:!1,title:"新增支付",close:!1},tableData:[],params:[]}},created:function(){this.initData()},methods:{initData:function(){var e=this;this.loading=!0;var t=this;t.$api.get("/main_store/printer_data_model",t.pages,function(a){if(a.status>=200&&a.status<300){var s=a.data;0==s.code?t.tableData=s.data.printerDataModels:e.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"});e.loading=!1})},handleSizeChange:function(e){console.log("每页 "+e+" 条")},handleCurrentChange:function(e){this.pages.page=e,this.pages.offset=(e-1)*this.pages.pageSize,this.initData()},statusFormat:function(e,t){return 2==e.status?"已启用":"未启用"},handleEdit:function(e,t,a){this.dialog.title="配置:"+t.name,this.printerDataModel.id=t.id,this.printerDataModel.name=t.name,this.printerDataModel.printData=t.printData,this.dialog.dialogFormVisible=!0},handleSave:function(){var e=this;this.loading=!0;var t=this;t.$api.put("/main_store/printer_data_model/"+t.printerDataModel.id,t.printerDataModel,function(a){if(a.status>=200&&a.status<300){console.log(a.data);var s=a.data;0==s.code?(e.$message({message:t.dialog.title+"成功",type:"success"}),e.dialog.dialogFormVisible=!1,e.initData()):e.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"})}),this.loading=!1}}},be={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fillcontain"},[a("div",{staticClass:"table_container"},[a("el-row",[a("el-alert",{attrs:{title:"分店在初始化模板数据时，会默认使用当前模板的配置",type:"success"}})],1),e._v(" "),a("br"),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData}},[a("el-table-column",{attrs:{label:"打印点",prop:"name"}}),e._v(" "),a("el-table-column",{attrs:{label:"状态",formatter:e.statusFormat}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleEdit(t.$index,t.row,"edit")}}},[e._v("\n                        配置\n                    ")])]}}])})],1),e._v(" "),a("el-dialog",{attrs:{title:e.dialog.title,visible:e.dialog.dialogFormVisible,"close-on-click-modal":e.dialog.close},on:{"update:visible":function(t){return e.$set(e.dialog,"dialogFormVisible",t)}}},[a("el-form",{attrs:{model:e.printerDataModel}},[a("el-form-item",{attrs:{label:"模板","label-width":"80px"}},[a("el-row",[a("el-col",{attrs:{span:14}},[a("el-input",{attrs:{type:"textarea",rows:"50",placeholder:"订单号: ###b### ###order_no###  ###/b###\n###br###\n桌号: ###table_number###\n###br###\n\n菜品            单价            数量             总计\n###br###\n###start_goods_content###\n###goods_name###            ###goods_sell_price###            ###goods_count###            ###goods_total_price###\n###br###\n###end_goods_content###\n\n###br###\n总金额：###total_price###\n###br###\n###cut###"},model:{value:e.printerDataModel.printData,callback:function(t){e.$set(e.printerDataModel,"printData",t)},expression:"printerDataModel.printData"}})],1),e._v(" "),a("el-col",{staticStyle:{"margin-left":"15px"},attrs:{span:8}},[a("p",[e._v("替换内容")]),e._v(" "),a("p",[e._v("###order_no### : 订单号")]),e._v(" "),a("p",[e._v("###out_no### : 订单序号")]),e._v(" "),a("p",[e._v("###total_price### : 订单总价")]),e._v(" "),a("p",[e._v("###real_price### : 订单支付价格")]),e._v(" "),a("p",[e._v("###table_number### : 餐桌编号")]),e._v(" "),a("p",[e._v("###note### : 订单备注")]),e._v(" "),a("p",[e._v("###goods_name### : 菜品名字")]),e._v(" "),a("p",[e._v("###goods_sell_price### : 菜品单价")]),e._v(" "),a("p",[e._v("###goods_count### : 菜品数量")]),e._v(" "),a("p",[e._v("###goods_count### : 菜品总价")]),e._v(" "),a("p",[e._v("###goods_count### : 菜品数量")]),e._v(" "),a("p",[e._v("###start_goods_content### : 菜品内容开始符")]),e._v(" "),a("p",[e._v("###end_goods_content### : 菜品内容结束符")]),e._v(" "),a("p",[e._v("###br### : 换行")]),e._v(" "),a("p",[e._v("###cut### : 切刀指令(主动切纸,仅限切刀打印机使用才有效果)")]),e._v(" "),a("p",[e._v("###cb###  ###/cb###: 居中放大")]),e._v(" "),a("p",[e._v("###b###  ###/b###: 放大一倍")]),e._v(" "),a("p",[e._v("###c###  ###/c###: 居中")]),e._v(" "),a("p",[e._v("###l###  ###/l###: 字体变高一倍")]),e._v(" "),a("p",[e._v("###w###  ###/w###: 字体变宽一倍")]),e._v(" "),a("p",[e._v("###right###  ###/right###: 右对齐")]),e._v(" "),a("p",[e._v("###bold###  ###/bold###: 加粗")])])],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialog.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleSave}},[e._v("确 定")])],1)],1)],1)])},staticRenderFns:[]};var ye=a("VU/8")(_e,be,!1,function(e){a("6NRn")},null,null).exports,we={data:function(){return{baseUrl:E,baseImgPath:B,loading:!1,order:{},dialog:{dialogFormVisible:!1,title:"新增餐桌",close:!1},pages:{offset:0,pageSize:10,page:1,total:0,store_id:"",keyword:"",created_start_time:"",created_end_time:""},orderData:[],stores:[]}},created:function(){this.storesData(),this.initData()},methods:{initData:function(){var e=this;this.loading=!0;var t=this;t.$api.get("/main_store/orders",t.pages,function(a){if(a.status>=200&&a.status<300){var s=a.data;0==s.code?(t.orderData=s.data.orders.content,t.pages.total=s.data.orders.totalElements):e.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"});e.loading=!1})},storesData:function(){var e=this;this.loading=!0;var t=this;t.$api.get("/main_store/store",{page:1,pageSize:1e4},function(a){if(a.status>=200&&a.status<300){var s=a.data;0==s.code?(t.stores=s.data.stores.content,t.stores.length>0&&(e.pages.store_id=t.stores[0].id)):e.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"});e.loading=!1})},handleSizeChange:function(e){console.log("每页 "+e+" 条")},handleCurrentChange:function(e){this.pages.page=e,this.pages.offset=(e-1)*this.pages.pageSize,this.initData()},handleInfo:function(e){this.$router.push({path:"/mainStore/orderDetail",query:{order_id:e.id}})},handlePrinterChange:function(){this.choosePrinterDataModels=null},exportExcel:function(){if(""!=this.pages.created_start_time&&""!=this.pages.created_end_time){var e=window.localStorage.access_token;location.href=E+"/main_store/orders/excel?access_token="+e+"&keyword="+this.pages.keyword+"&created_start_time="+this.pages.created_start_time+"&created_end_time="+this.pages.created_end_time+"&store_id="+this.pages.store_id}else this.$message({message:"导出订单请先选择时间区间",type:"warning"})},realPriceFormat:function(e,t){return e.realPrice-e.refundPrice==e.totalPrice?e.realPrice/100+"元":0==e.refundPrice?"实收:"+e.realPrice/100+"元/总价:"+e.totalPrice/100+"元":"实收:"+e.realPrice/100+"元/退款"+e.refundPrice/100+"元/总价:"+e.totalPrice/100+"元"},handleDeleteAlert:function(e){var t=this;this.$confirm("此操作将删除该订单吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.handleDelete(e)}).catch(function(){})}}},$e={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fillcontain"},[a("div",{staticClass:"table_container"},[a("el-row",[a("el-col",{attrs:{span:4}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"全部分店"},model:{value:e.pages.store_id,callback:function(t){e.$set(e.pages,"store_id",t)},expression:"pages.store_id"}},e._l(e.stores,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入订单号"},model:{value:e.pages.keyword,callback:function(t){e.$set(e.pages,"keyword",t)},expression:"pages.keyword"}})],1),e._v(" "),a("el-col",{attrs:{span:10}},[a("el-date-picker",{attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"开始时间"},model:{value:e.pages.created_start_time,callback:function(t){e.$set(e.pages,"created_start_time",t)},expression:"pages.created_start_time"}}),e._v(" "),a("el-date-picker",{attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"结束时间"},model:{value:e.pages.created_end_time,callback:function(t){e.$set(e.pages,"created_end_time",t)},expression:"pages.created_end_time"}})],1),e._v(" "),a("el-col",{attrs:{span:2}},[a("el-button",{on:{click:e.initData}},[e._v("搜索")])],1)],1),e._v(" "),a("br"),e._v(" "),a("el-row",[a("el-col",{attrs:{span:3}},[a("el-button",{attrs:{type:"primary"},on:{click:e.exportExcel}},[e._v("导出订单")])],1)],1),e._v(" "),a("br"),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.orderData}},[a("el-table-column",{attrs:{label:"分店",prop:"store.name"}}),e._v(" "),a("el-table-column",{attrs:{label:"订单号",prop:"orderNo"}}),e._v(" "),a("el-table-column",{attrs:{label:"餐桌编号",prop:"tableNumber"}}),e._v(" "),a("el-table-column",{attrs:{label:"三方订单号",prop:"outOrderNo"}}),e._v(" "),a("el-table-column",{attrs:{label:"支付方式",prop:"payTypeStr"}}),e._v(" "),a("el-table-column",{attrs:{label:"金额(￥)",formatter:e.realPriceFormat}}),e._v(" "),a("el-table-column",{attrs:{label:"创建者",prop:"createdUser.account"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleInfo(t.row)}}},[e._v("\n                详情\n              ")])]}}])})],1),e._v(" "),a("div",{staticClass:"Pagination"},[a("el-pagination",{attrs:{"current-page":e.pages.page,"page-size":e.pages.pageSize,layout:"total, prev, pager, next",total:e.pages.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)])},staticRenderFns:[]};var ke=a("VU/8")(we,$e,!1,function(e){a("Vz5t")},null,null).exports,xe={data:function(){return{baseUrl:E,baseImgPath:B,uploadUrl:E+"/common/imageUpload",loading:!1,order_id:0,order:{id:0,number:"",createTimeStr:"",payTime:"",payTimeStr:""},goodsData:[],totalPrice:0,keyword:"",chooseOrderGoods:{},noteDialogTableVisible:!1}},created:function(){this.order_id=this.$route.query.order_id,this.initData()},methods:{initData:function(){var e=this;this.loading=!0;var t=this;t.$api.get("/main_store/orders",{order_id:this.order_id},function(a){if(a.status>=200&&a.status<300){var s=a.data;0==s.code?(t.order=s.data.orders.content[0],t.order.createTimeStr=e.dateTimeFormat(t.order.createTime),null!=t.order.payTime&&""!=t.order.payTime&&(t.order.payTimeStr=e.dateTimeFormat(t.order.payTime)),t.initGoodsData()):e.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"});e.loading=!1})},initGoodsData:function(){var e=this;this.loading=!0;var t=this;t.$api.get("/main_store/orders/orderGoods",{order_id:t.order.id},function(a){if(a.status>=200&&a.status<300){var s=a.data;0==s.code?(t.goodsData=s.data.orderGoods,t.totalPrice=0,t.goodsData.forEach(function(e,a){t.totalPrice+=e.goods.sell_price*e.count})):e.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"});e.loading=!1})},statusFormat:function(e,t){return 2==e.payStatus?"已退款":"正常"},markerPriceFormat:function(e,t){return e.goods.marker_price/100},sellPriceFormat:function(e,t){return e.goods.sell_price/100},totalPriceFormat:function(e,t){return e.goods.sell_price/100},dateTimeFormat:function(e){var t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-"+(t.getDate()<10?"0"+t.getDate():t.getDate())+" "+(t.getHours()<10?"0"+t.getHours():t.getHours())+":"+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+":"+(t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds())},in_array:function(e,t){for(var a in t)if(t[a]==e)return!0;return!1}}},Se={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fillcontain"},[a("div",{staticClass:"table_container"},[a("el-divider",{attrs:{"content-position":"left"}},[e._v("订单信息")]),e._v(" "),a("el-row",[a("el-col",{attrs:{span:2}},[e._v("订单号")]),a("el-col",{attrs:{span:4}},[e._v(e._s(e.order.orderNo))]),e._v(" "),a("el-col",{attrs:{span:2}},[e._v("创建时间")]),a("el-col",{attrs:{span:4}},[e._v(e._s(e.order.createTimeStr))]),e._v(" "),a("el-col",{attrs:{span:2}},[e._v("创建者帐号")]),a("el-col",{attrs:{span:4}},[e._v(e._s(e.order.createdUser.account))])],1),e._v(" "),a("br"),e._v(" "),a("el-row",[a("el-col",{attrs:{span:2}},[e._v("确认状态")]),a("el-col",{attrs:{span:4}},[e._v(e._s(e.order.applyStatusStr))]),e._v(" "),a("el-col",{attrs:{span:2}},[e._v("就餐人数")]),a("el-col",{attrs:{span:4}},[e._v(e._s(e.order.peopleNum))])],1),e._v(" "),a("br"),e._v(" "),a("el-row",[a("el-col",[e._v("备注: "+e._s(e.order.note))])],1),e._v(" "),a("el-divider",{attrs:{"content-position":"left"}},[e._v("支付信息")]),e._v(" "),a("el-row",[a("el-col",{attrs:{span:3}},[e._v("总金额（￥）")]),a("el-col",{attrs:{span:4}},[e._v(" "+e._s(e.order.totalPrice/100)+"元")]),e._v(" "),a("el-col",{attrs:{span:3}},[e._v("实付金额（￥）")]),a("el-col",{attrs:{span:4}},[e._v(e._s(e.order.realPrice/100)+"元")])],1),e._v(" "),a("br"),e._v(" "),a("el-row",[a("el-col",{attrs:{span:2}},[e._v("支付状态")]),a("el-col",{attrs:{span:4}},[e._v(" "+e._s(e.order.payStatusStr))]),e._v(" "),e.order.payStatus>1?a("el-col",{attrs:{span:2}},[e._v("支付时间")]):e._e(),e.order.payStatus>1?a("el-col",{attrs:{span:4}},[e._v(" "+e._s(e.order.payTimeStr))]):e._e(),e._v(" "),e.order.payStatus>1?a("el-col",{attrs:{span:2}},[e._v("支付方式")]):e._e(),e.order.payStatus>1?a("el-col",{attrs:{span:4}},[e._v(e._s(e.order.payTypeStr))]):e._e(),e._v(" "),e.order.payStatus>1?a("el-col",{attrs:{span:2}},[e._v("支付者帐号")]):e._e(),e.order.payStatus>1?a("el-col",{attrs:{span:4}},[e._v(e._s(e.order.payUser.account))]):e._e()],1),e._v(" "),a("br"),e._v(" "),a("br"),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.goodsData}},[a("el-table-column",{attrs:{label:"菜名",prop:"goodsName"}}),e._v(" "),a("el-table-column",{attrs:{label:"编号",prop:"goods.number"}}),e._v(" "),a("el-table-column",{attrs:{label:"市场价",formatter:e.markerPriceFormat}}),e._v(" "),a("el-table-column",{attrs:{label:"销售价",formatter:e.sellPriceFormat}}),e._v(" "),a("el-table-column",{attrs:{label:"数量",prop:"count"}}),e._v(" "),a("el-table-column",{attrs:{label:"备注",prop:"note","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{label:"状态",formatter:e.statusFormat}})],1)],1)])},staticRenderFns:[]};var De=a("VU/8")(xe,Se,!1,function(e){a("8uaj")},null,null).exports,Ce={data:function(){return{baseUrl:E,baseImgPath:B,loading:!1,tableData:[],chooseId:""}},created:function(){this.initData()},methods:{initData:function(){var e=this;this.loading=!0;var t=this;t.$api.get("/main_store/consumer_view_config",null,function(a){if(a.status>=200&&a.status<300){var s=a.data;0==s.code?(t.tableData=s.data.consumerViews,t.chooseId=s.data.usedPageViewId,e.tableData.forEach(function(e,a){e.picPath=t.baseImgPath+"/"+e.picPath})):e.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"});e.loading=!1})},choosePage:function(e){var t=this;this.loading=!0;var a=this;a.$api.put("/main_store/consumer_view_config/"+e.id,null,function(e){if(e.status>=200&&e.status<300){var s=e.data;0==s.code?a.initData():t.$message({message:s.msg,type:"warning"})}else t.$message({message:"服务器维护中",type:"error"});t.loading=!1})},goBuy:function(e){this.$router.push({path:"/mainStore/pluginsStore",query:{uuid:e.uuid}})},statusFormat:function(e,t){return 2==e.status?"使用中":"未使用"}}},Fe={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fillcontain"},[a("div",{staticClass:"table_container"},[a("el-alert",{attrs:{title:"当分店统一使用配置时，此配置会在分店的客户点餐时生效",type:"success"}}),e._v(" "),a("br"),e._v(" "),a("el-row",e._l(e.tableData,function(t,s){return a("el-col",{key:s,attrs:{span:6}},[a("el-card",{staticStyle:{margin:"5px",height:"350px"}},[a("img",{staticClass:"image",attrs:{src:t.picPath}}),e._v(" "),a("div",{staticStyle:{padding:"14px"}},[a("span",[e._v(e._s(t.name))]),e._v(" "),a("div",{staticClass:"bottom clearfix"},[a("time",{staticClass:"time"},[e._v("免费\n                    (\n                    "),4==t.status?a("span",{staticStyle:{color:"green"}},[e._v("\n                    "+e._s(t.statusStr)+"\n                    ")]):2==t.status?a("span",{staticStyle:{color:"blueviolet"}},[e._v("\n                    "+e._s(t.statusStr)+"\n                    ")]):a("span",{staticStyle:{color:"red"}},[e._v("\n                    "+e._s(t.statusStr)+"\n                    ")]),e._v("\n                    )\n                  ")]),e._v(" "),4==t.status?a("el-button",{staticClass:"button",attrs:{type:"text"}},[a("el-radio",{attrs:{label:t.id},on:{change:function(a){return e.choosePage(t)}},model:{value:e.chooseId,callback:function(t){e.chooseId=t},expression:"chooseId"}},[t.id==e.chooseId?a("span",[e._v("使用中")]):a("span",[e._v("未使用")])])],1):e._e(),e._v(" "),1==t.status||3==t.status?a("el-button",{staticClass:"button",attrs:{type:"danger"},on:{click:function(a){return e.goBuy(t)}}},[e._v("\n                    购买\n                  ")]):e._e()],1)])])],1)}),1)],1)])},staticRenderFns:[]};var Te=a("VU/8")(Ce,Fe,!1,function(e){a("6CuI"),a("n1kp")},null,null).exports,Pe={data:function(){return{baseUrl:E,baseImgPath:B,uploadUrl:E+"/common/imageUpload",loading:!1,qrcodeurl:"",plugin:{uuid:0,name:"",day:0,vip0Price:0,vip1Price:0,count:1},dialog:{dialogFormVisible:!1,title:"购买插件",close:!1},pluginsTypes:[],plugins:[]}},created:function(){var e=window.localStorage;this.token=e.access_token,this.initData()},methods:{initData:function(){var e=this;this.loading=!0;var t=this;t.$api.get("/main_store/plugins",t.pages,function(a){if(a.status>=200&&a.status<300){var s=a.data;0==s.code?(t.pluginsTypes=s.data.pluginsTypes,t.plugins=s.data.plugins):e.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"});e.loading=!1})},dayFormat:function(e,t){return 0==e.day?"永久":e.day+"天"},vip0PriceFormat:function(e,t){return e.vip0Price/100},vip1PriceFormat:function(e,t){return e.vip1Price/100},vip2PriceFormat:function(e,t){return e.vip2Price/100},buy:function(e,t,a){this.plugin.uuid=t.uuid,this.plugin.name=t.name,this.plugin.day=t.day,this.plugin.price=t.price/100,this.plugin.vip0Price=t.vip0Price/100,this.plugin.vip1Price=t.vip1Price/100,this.plugin.vip2Price=t.vip2Price/100,this.plugin.count=1,this.dialog.dialogFormVisible=!0}}},Ve={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fillcontain"},[a("div",{staticClass:"table_container"},[a("br"),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.pluginsTypes}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.plugins[t.row.type]}},[a("el-table-column",{attrs:{label:"插件名",prop:"name"}}),e._v(" "),a("el-table-column",{attrs:{label:"价格",formatter:e.vip0PriceFormat}}),e._v(" "),a("el-table-column",{attrs:{label:"年费会员价",formatter:e.vip1PriceFormat}}),e._v(" "),a("el-table-column",{attrs:{label:"有效期",formatter:e.dayFormat}}),e._v(" "),a("el-table-column",{attrs:{label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.status?a("span",{staticStyle:{color:"red"}},[e._v("未购买")]):2==t.row.status?a("span",{staticStyle:{color:"green"}},[e._v("\n                    已购买(生效时间:"+e._s(t.row.startTime)+")\n                  ")]):3==t.row.status?a("span",{staticStyle:{color:"red"}},[e._v("已过期:"+e._s(t.row.endTime))]):4==t.row.status?a("span",{staticStyle:{color:"green"}},[t.row.test?a("span",{staticStyle:{color:"red"}},[e._v("试用中")]):a("span",{staticStyle:{color:"green"}},[e._v("已生效")]),t.row.day>0?a("span",[e._v("("+e._s(t.row.endTime)+")")]):e._e()]):e._e()]}}],null,!0)}),e._v(" "),a("el-table-column",{attrs:{label:"备注","show-overflow-tooltip":!0,prop:"note"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[1==t.row.status||3==t.row.status?a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.buy(t.$index,t.row,"edit")}}},[e._v("\n                      购买\n                    ")]):(2==t.row.status||4==t.row.status)&&t.row.day>0?a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.buy(t.$index,t.row,"edit")}}},[e._v("\n                      延期\n                    ")]):e._e()],1)]}}],null,!0)})],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"插件"}})],1),e._v(" "),a("el-dialog",{attrs:{title:e.dialog.title,visible:e.dialog.dialogFormVisible,"close-on-click-modal":e.dialog.close},on:{"update:visible":function(t){return e.$set(e.dialog,"dialogFormVisible",t)}}},[a("el-form",{attrs:{model:e.plugin}},[a("el-form-item",{attrs:{label:"插件名","label-width":"80px"}},[e._v("\n                    "+e._s(e.plugin.name)+"\n                ")]),e._v(" "),a("el-form-item",{attrs:{label:"价格","label-width":"80px"}},[e._v("\n                "+e._s(e.plugin.price)+"元\n              ")]),e._v(" "),a("el-form-item",{attrs:{label:"有效期","label-width":"80px"}},[0==e.plugin.day?a("span",[e._v("永久")]):a("span",[e._v(e._s(e.plugin.day*e.plugin.count)+"天")])]),e._v(" "),e.plugin.day>0?a("el-form-item",{attrs:{label:"数量","label-width":"80px"}},[a("el-input-number",{attrs:{min:1,max:1e4},model:{value:e.plugin.count,callback:function(t){e.$set(e.plugin,"count",t)},expression:"plugin.count"}}),e._v(" "),a("el-alert",{attrs:{title:"多份数量时，有效期会自动叠加",type:"success"}})],1):e._e()],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialog.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),a("a",{attrs:{href:e.baseUrl+"/payment/plugins/"+e.plugin.uuid+"?token="+e.token+"&count="+e.plugin.count,target:"_blank"}},[a("el-button",{attrs:{type:"primary"}},[e._v("确定购买")])],1)],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"绑定微信","close-on-click-modal":e.dialog.close},model:{value:e.wxDialogVisible,callback:function(t){e.wxDialogVisible=t},expression:"wxDialogVisible"}},[a("div",{staticStyle:{width:"100%","text-align":"center"}},[a("img",{attrs:{src:e.qrcodeurl}})]),e._v(" "),a("div",{staticStyle:{width:"100%","text-align":"center"}},[a("span",[e._v("用该员工的微信扫一扫二维码进行微信登录授权绑定")])]),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.wxDialogVisible=!1}}},[e._v("关闭")])],1)])],1)])},staticRenderFns:[]};var ze=a("VU/8")(Pe,Ve,!1,function(e){a("SeMU")},null,null).exports,Ue={data:function(){return{baseUrl:E,baseImgPath:B,loading:!1,showAddBtn:!0,charge_item:{id:0,chargePrice:"",totalPrice:"",tag:"",status:"1"},dialog:{dialogFormVisible:!1,title:"新增充值项",close:!1},pages:{offset:0,pageSize:10,page:1,total:0},tableData:[],plugin_msg:null}},created:function(){this.initData()},methods:{initData:function(){var e=this;this.loading=!0;var t=this;t.$api.get("/main_store/charge_item",t.pages,function(a){if(a.status>=200&&a.status<300){var s=a.data;0==s.code?(t.tableData=s.data.charge_items.content,t.plugin_msg=s.data.plugin_msg,t.pages.total=s.data.charge_items.totalElements):(e.showAddBtn=!1,e.$message({message:s.msg,type:"warning"}))}else e.showAddBtn=!1,e.$message({message:"服务器维护中",type:"error"});e.loading=!1})},handleSizeChange:function(e){console.log("每页 "+e+" 条")},handleCurrentChange:function(e){this.pages.page=e,this.pages.offset=(e-1)*this.pages.pageSize,this.initData()},statusFormat:function(e,t){return 2==e.status?"上架":"下架"},handleEdit:function(e,t,a){"edit"==a?(this.dialog.title="修改充值项",this.charge_item.id=t.id,this.charge_item.chargePrice=t.chargePrice,this.charge_item.totalPrice=t.totalPrice,this.charge_item.tag=t.tag,this.charge_item.status=""+t.status,this.dialog.dialogFormVisible=!0):"add"==a&&(this.dialog.title="增加充值项",this.charge_item.id=0,this.charge_item.chargePrice="",this.charge_item.totalPrice="",this.charge_item.tag="",this.charge_item.status="1",this.dialog.dialogFormVisible=!0)},handleSave:function(){var e=this;this.loading=!0;var t=this;t.$api.post("/main_store/charge_item",t.charge_item,function(a){if(a.status>=200&&a.status<300){console.log(a.data);var s=a.data;0==s.code?(e.$message({message:t.dialog.title+"成功",type:"success"}),e.dialog.dialogFormVisible=!1,e.initData()):e.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"})}),this.loading=!1},handleDeleteAlert:function(e){var t=this;this.$confirm("此操作将删除该菜品标签, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.handleDelete(e)}).catch(function(){})},handleDelete:function(e){var t=this;this.loading=!0;this.$api.delete("/main_store/charge_item/"+e.id,null,function(e){if(e.status>=200&&e.status<300){console.log(e.data);var a=e.data;0==a.code?(t.$message({message:"删除成功",type:"success"}),t.loading=!1,t.initData()):t.$message({message:a.msg,type:"warning"})}else t.$message({message:"服务器维护中",type:"error"})})}}},Ee={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fillcontain"},[a("div",{staticClass:"table_container"},[null!=e.plugin_msg?a("el-row",[a("el-alert",{attrs:{title:e.plugin_msg,type:"error"}})],1):e._e(),e._v(" "),a("br"),e._v(" "),a("el-row",[a("el-alert",{attrs:{title:"客人可在移动端直接进行充值获得赠送金额",type:"success"}})],1),e._v(" "),a("br"),e._v(" "),e.showAddBtn?a("el-row",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleEdit(0,"","add")}}},[e._v("新增充值项")])],1):e._e(),e._v(" "),a("br"),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData}},[a("el-table-column",{attrs:{label:"充值金额",prop:"chargePrice"}}),e._v(" "),a("el-table-column",{attrs:{label:"得到金额",prop:"totalPrice"}}),e._v(" "),a("el-table-column",{attrs:{label:"标签",prop:"tag"}}),e._v(" "),a("el-table-column",{attrs:{label:"状态",formatter:e.statusFormat}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleEdit(t.$index,t.row,"edit")}}},[e._v("\n                    编辑\n                ")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.handleDeleteAlert(t.row)}}},[e._v("\n                  删除\n                ")])]}}])})],1),e._v(" "),a("div",{staticClass:"Pagination"},[a("el-pagination",{attrs:{"current-page":e.pages.page,"page-size":e.pages.pageSize,layout:"total, prev, pager, next",total:e.pages.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:e.dialog.title,visible:e.dialog.dialogFormVisible,"close-on-click-modal":e.dialog.close},on:{"update:visible":function(t){return e.$set(e.dialog,"dialogFormVisible",t)}}},[a("el-form",{attrs:{model:e.charge_item}},[a("el-form-item",{attrs:{label:"充值金额","label-width":"100px"}},[a("el-input-number",{attrs:{"auto-complete":"off",min:1},model:{value:e.charge_item.chargePrice,callback:function(t){e.$set(e.charge_item,"chargePrice",t)},expression:"charge_item.chargePrice"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"得到金额","label-width":"100px"}},[a("el-input-number",{attrs:{"auto-complete":"off",min:1},model:{value:e.charge_item.totalPrice,callback:function(t){e.$set(e.charge_item,"totalPrice",t)},expression:"charge_item.totalPrice"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"标签","label-width":"100px"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:"如:开业"},model:{value:e.charge_item.tag,callback:function(t){e.$set(e.charge_item,"tag",t)},expression:"charge_item.tag"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"状态","label-width":"80px"}},[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-text":"上线","inactive-text":"下线","active-value":"2","inactive-value":"1"},model:{value:e.charge_item.status,callback:function(t){e.$set(e.charge_item,"status",t)},expression:"charge_item.status"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialog.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleSave}},[e._v("确 定")])],1)],1)],1)])},staticRenderFns:[]};var Be=a("VU/8")(Ue,Ee,!1,function(e){a("0YKu")},null,null).exports,Ne={name:"Header",data:function(){return{menuBtn:"el-icon-newfont-caidan",username:"",nickname:"",storeName:"",user:{oldpwd:"",newpwd:"",newpwdagain:""},dialog:{dialogFormVisible:!1,title:"修改密码",close:!1}}},computed:{isActive:function(){return!this.$store.getters.sidebar.opened}},created:function(){var e=window.localStorage,t=JSON.parse(e.user);this.username=t.user.account,this.nickname=t.name,this.storeName=t.name},methods:n()({},Object(l.c)({bindLogout:"BIND_LOGOUT"}),{handleMenu:function(){this.$store.dispatch("ToggleSideBar")},logout:function(){var e=this;this.$confirm("是否退出账户?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t=e;t.$api.post("/store/logout",t.user,function(a){if(a.status>=200&&a.status<300){console.log(a.data);var s=a.data;0==s.code?(t.$message({message:"退出登录成功",type:"success"}),t.dialog.dialogFormVisible=!1,t.$router.push("/store/login")):t.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"})})}).catch(function(){})},handleEdit:function(){this.user.oldpwd="",this.user.newpwd="",this.user.newpwdagain="",this.dialog.dialogFormVisible=!0},handleSave:function(){var e=this;if(this.user.newpwd==this.user.newpwdagain){var t=this;t.$api.put("/store/setpassword",t.user,function(a){if(a.status>=200&&a.status<300){console.log(a.data);var s=a.data;0==s.code?(e.$message({message:"修改成功,请使用新密码登录",type:"success"}),t.dialog.dialogFormVisible=!1,t.$router.push("/store/login")):t.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"})})}else this.$message({type:"error",message:"两次输入的新密码不一致"})}})},Me={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"header"},[a("div",{staticClass:"logo",class:{"is-active":e.isActive}},[e._v("\n    "+e._s(e.storeName)+"-后台\n  ")]),e._v(" "),a("div",{staticClass:"navbar"},[a("div",{staticClass:"btn",class:{"is-active":e.isActive},on:{click:e.handleMenu}},[a("span",{class:e.menuBtn})]),e._v(" "),a("el-dropdown",{attrs:{trigger:"click"}},[a("span",{staticClass:"el-dropdown-link"},[e._v("\n        "+e._s(e.nickname)),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{nativeOn:{click:function(t){return e.handleEdit(t)}}},[e._v("修改密码")]),e._v(" "),a("el-dropdown-item",{nativeOn:{click:function(t){return e.logout(t)}}},[e._v("退出 ")])],1)],1)],1),e._v(" "),a("el-dialog",{attrs:{title:e.dialog.title,visible:e.dialog.dialogFormVisible,"close-on-click-modal":e.dialog.close},on:{"update:visible":function(t){return e.$set(e.dialog,"dialogFormVisible",t)}}},[a("el-form",{attrs:{model:e.user}},[a("el-form-item",{attrs:{label:"原密码","label-width":"100px"}},[a("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:e.user.oldpwd,callback:function(t){e.$set(e.user,"oldpwd",t)},expression:"user.oldpwd"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"新密码","label-width":"100px"}},[a("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:e.user.newpwd,callback:function(t){e.$set(e.user,"newpwd",t)},expression:"user.newpwd"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"重输新密码","label-width":"100px"}},[a("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:e.user.newpwdagain,callback:function(t){e.$set(e.user,"newpwdagain",t)},expression:"user.newpwdagain"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialog.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleSave}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var Oe=a("VU/8")(Ne,Me,!1,function(e){a("c3yv")},"data-v-1fc505cd",null).exports,Re={name:"Sidebar",data:function(){return{configType:1}},computed:n()({},Object(l.b)(["sidebar"]),{isCollapse:function(){return!this.sidebar.opened},activeIndex:function(){var e=this.$route.path;return"details"===this.$route.name?"/tables/details":e}}),created:function(){var e=window.localStorage,t=JSON.parse(e.user);this.configType=t.configType},methods:{}},Ie={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"sidebar"},[a("el-menu",{staticClass:"el-menu-vertical-demo",attrs:{"default-active":e.activeIndex,router:"",collapse:e.isCollapse,"background-color":"#545c64","text-color":"#fff","active-text-color":"#ffd04b"}},[a("el-menu-item",{attrs:{index:"/store/storeUser"}},[a("i",{staticClass:"el-icon-user-solid"}),e._v(" "),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("店员管理")])]),e._v(" "),a("el-menu-item",{attrs:{index:"/store/consumer"}},[a("i",{staticClass:"el-icon-s-custom"}),e._v(" "),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("会员管理")])]),e._v(" "),a("el-menu-item",{attrs:{index:"/store/orders"}},[a("i",{staticClass:"el-icon-s-order"}),e._v(" "),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("订单管理")])]),e._v(" "),a("el-submenu",{attrs:{index:"/goods"}},[a("template",{slot:"title"},[a("i",{staticClass:"el-icon-s-shop"}),e._v(" "),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("店内管理")])]),e._v(" "),a("el-menu-item",{attrs:{index:"/store/goods"}},[e._v("菜品")]),e._v(" "),a("el-menu-item",{attrs:{index:"/store/goodsTag"}},[e._v("菜品标签")]),e._v(" "),a("el-menu-item",{attrs:{index:"/store/tables"}},[e._v("餐桌管理")])],2),e._v(" "),2==e.configType?a("el-submenu",{attrs:{index:"/oauth_pay"}},[a("template",{slot:"title"},[a("i",{staticClass:"el-icon-chat-line-round"}),e._v(" "),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("点餐配置")])]),e._v(" "),a("el-menu-item",{attrs:{index:"/store/payment"}},[e._v("支付配置")]),e._v(" "),a("el-menu-item",{attrs:{index:"/store/oauth"}},[e._v("授权配置")]),e._v(" "),a("el-menu-item",{attrs:{index:"/store/pageView"}},[e._v("主题配置")])],2):e._e(),e._v(" "),a("el-submenu",{attrs:{index:"/call"}},[a("template",{slot:"title"},[a("i",{staticClass:"el-icon-message-solid"}),e._v(" "),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("客人端功能")])]),e._v(" "),a("el-menu-item",{attrs:{index:"/store/orderFoodPluginsConfig"}},[e._v("功能配置")]),e._v(" "),a("el-menu-item",{attrs:{index:"/store/callTag"}},[e._v("呼叫配置")]),e._v(" "),a("el-menu-item",{attrs:{index:"/store/callLog"}},[e._v("呼叫记录")]),e._v(" "),a("el-menu-item",{attrs:{index:"/store/chargeItem"}},[e._v("充值配置")])],2),e._v(" "),a("el-submenu",{attrs:{index:"/printer"}},[a("template",{slot:"title"},[a("i",{staticClass:"el-icon-printer"}),e._v(" "),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("打印管理")])]),e._v(" "),a("el-menu-item",{attrs:{index:"/store/printerDataModel"}},[e._v("打印模板配置")]),e._v(" "),a("el-menu-item",{attrs:{index:"/store/printer"}},[e._v("打印机管理")])],2),e._v(" "),a("el-menu-item",{attrs:{index:"/store/pluginsStore"}},[a("i",{staticClass:"el-icon-goods"}),e._v(" "),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("插件市场")])]),e._v(" "),a("el-menu-item",{attrs:{index:"/store/setting"}},[a("i",{staticClass:"el-icon-setting"}),e._v(" "),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("系统设置")])])],1)],1)},staticRenderFns:[]};var Ae={name:"Full",components:{Header:Oe,Breadcrumb:p,Footer:h,Siderbar:a("VU/8")(Re,Ie,!1,function(e){a("rIQ4")},"data-v-6a49dce2",null).exports,Scrolltotop:w},mixins:[F],computed:{},data:function(){return{websocketUrl:N,baseUrl:E,baseImgPath:B,socket:null,newOrderplayUrl:"/admin/static/order_tip.mp3",newMsgplayUrl:"/admin/static/new_msg.mp3",audio:null,currentSong:null}},created:function(){},mounted:function(){this.initWebsocket()},methods:{initWebsocket:function(){if("undefined"==typeof WebSocket)alert("您的浏览器不支持订单提醒推送");else{var e=window.localStorage,t=JSON.parse(e.user),a="ws:"+N+"/websocket/"+t.user.id;this.socket=new WebSocket(a),this.socket.onopen=this.open,this.socket.onerror=this.error,this.socket.onmessage=this.getMessage,console.log(a)}},open:function(){console.log("socket连接成功")},error:function(){console.log("连接错误")},getMessage:function(e){var t=e.data;2==(t=JSON.parse(t)).type?(this.$notify({title:t.des,dangerouslyUseHTMLString:!0,message:"订单号:"+t.params.order_no+"<br/>桌号:"+t.params.table_number,duration:5e3,position:"bottom-right",type:"success"}),this.audio=window.document.getElementById("audio"),null==this.currentSong||this.currentSong!=this.newOrderplayUrl?this.currentSong=this.newOrderplayUrl:this.audio.play()):3==t.type?this.$notify({title:t.des,dangerouslyUseHTMLString:!0,message:"订单号:"+t.params.order_no+"<br/>桌号:"+t.params.table_number,duration:5e3,position:"bottom-right",type:"success"}):4==t.type&&(this.$notify({title:t.des,dangerouslyUseHTMLString:!0,message:t.params.table_number+"号桌客人呼叫:"+t.params.call_content,duration:5e3,position:"bottom-right",type:"success"}),this.audio=window.document.getElementById("audio"),null==this.currentSong||this.currentSong!=this.newMsgplayUrl?(this.currentSong=this.newMsgplayUrl,console.log("eeeee")):this.audio.play()),console.log(t)},send:function(){this.socket.send(params)},close:function(){console.log("socket已经关闭")}},destroyed:function(){null!=this.socket&&(this.socket.onclose=this.close(),this.socket.close(),this.socket=null)}},Ge={render:function(){var e=this.$createElement,t=this._self._c||e;return t("el-container",[t("el-header",[t("Header")],1),this._v(" "),t("el-container",[t("Siderbar"),this._v(" "),t("el-container",[t("el-main",[t("Breadcrumb"),this._v(" "),t("transition",{attrs:{name:"fade-transform",mode:"out-in"}},[t("router-view")],1)],1),this._v(" "),t("el-footer",[t("Footer")],1)],1)],1),this._v(" "),t("Scrolltotop"),this._v(" "),t("audio",{staticStyle:{display:"none"},attrs:{autoplay:"autoplay",src:this.currentSong,id:"audio"}})],1)},staticRenderFns:[]};var He=a("VU/8")(Ae,Ge,!1,function(e){a("rj0c")},"data-v-49c520b0",null).exports,Le={name:"Login",components:{},data:function(){return{baseUrl:E,user:{account:"",password:""},rules:{account:[{validator:function(e,t,a){""===t?a(new Error("请输入用户名")):a()},trigger:"change"}],password:[{validator:function(e,t,a){""===t?a(new Error("请输入密码")):a()},trigger:"change"}]}}},mounted:function(){},methods:{login:function(e){var t=this;this.$refs[e].validate(function(e){if(e){var a=t;a.$api.post("/store/login",a.user,function(e){if(e.status>=200&&e.status<300){console.log(e.data);var a=e.data;if(0==a.code){t.$message({message:"登录成功",type:"success"}),console.log(a.data);var s=window.localStorage;s.access_token=a.data.user.user.accessToken,s.user=U()(a.data.user),t.$router.push("/store/index")}else t.$message({message:a.msg,type:"warning"})}else t.$message({message:"服务器维护中",type:"error"})})}})},gotoRegist:function(){this.$router.push({path:"/register"})}}},qe={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"login-wrapper"},[a("div",{staticClass:"login"},[a("p",{staticClass:"title"},[e._v("点餐管理系统(分店)")]),e._v(" "),a("el-form",{ref:"user",staticClass:"demo-ruleForm",attrs:{model:e.user,"status-icon":"",rules:e.rules,"label-width":"0"}},[a("el-form-item",{attrs:{prop:"account"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入用户名"},model:{value:e.user.account,callback:function(t){e.$set(e.user,"account",t)},expression:"user.account"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"password"}},[a("el-input",{attrs:{type:"password","auto-complete":"off",placeholder:"输入密码"},model:{value:e.user.password,callback:function(t){e.$set(e.user,"password",t)},expression:"user.password"}})],1),e._v(" "),a("el-form-item",[a("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:function(t){return e.login("user")}}},[e._v("登录")])],1)],1)],1)])])},staticRenderFns:[]};var je=a("VU/8")(Le,qe,!1,function(e){a("H1RU")},"data-v-1be15f1c",null).exports,We={data:function(){return{baseUrl:E,baseImgPath:B,loading:!1,goods_tag:{id:0,name:""},dialog:{dialogFormVisible:!1,title:"新增菜品标签",close:!1},tag_dialog:{dialogFormVisible:!1,title:"总部菜品标签",close:!1},pages:{offset:0,pageSize:10,page:1,total:0},tableData:[],tagChecks:[]}},created:function(){this.initData()},methods:{initData:function(){var e=this;this.loading=!0;var t=this;t.$api.get("/store/goods_tag",t.pages,function(a){if(a.status>=200&&a.status<300){var s=a.data;0==s.code?(t.tableData=s.data.goods_tags.content,t.pages.total=s.data.goods_tags.totalElements):e.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"});e.loading=!1})},getMainStoreTags:function(){var e=this;this.tagChecks=[],this.loading=!0;this.$api.get("/store/goods_tag/main_goods_tags",{page:1,pageSize:1e4},function(t){if(t.status>=200&&t.status<300){var a=t.data;if(0==a.code){var s=a.data.goods_tags.content,i=s.length;if(i>0)for(var o=0;o<i;o++){var n=s[o];e.tagChecks.push({check:!1,name:n.name,id:n.id})}e.tag_dialog.dialogFormVisible=!0}else e.$message({message:a.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"});e.loading=!1})},handleSizeChange:function(e){console.log("每页 "+e+" 条")},handleCurrentChange:function(e){this.pages.page=e,this.pages.offset=(e-1)*this.pages.pageSize,this.initData()},handleEdit:function(e,t,a){"edit"==a?(this.dialog.title="修改菜品标签",this.goods_tag.id=t.id,this.goods_tag.name=t.name,this.dialog.dialogFormVisible=!0):"add"==a&&(this.dialog.title="修改菜品标签",this.goods_tag.id=0,this.goods_tag.name="",this.dialog.dialogFormVisible=!0)},handleCopy:function(){var e=this;this.loading=!0;var t="";if(this.tagChecks.forEach(function(e,a){1==e.check&&(t+=e.id+"#")}),""==t)return this.loading=!1,void this.$message({message:"请选择要复制的标签",type:"warning"});this.$api.post("/store/goods_tag/copy",{tag_ids:t},function(t){if(t.status>=200&&t.status<300){console.log(t.data);var a=t.data;0==a.code?(e.$message({message:"复制成功",type:"success"}),e.tag_dialog.dialogFormVisible=!1,e.initData()):e.$message({message:a.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"})}),this.loading=!1},handleSave:function(){var e=this;this.loading=!0;var t=this;t.$api.post("/store/goods_tag",t.goods_tag,function(a){if(a.status>=200&&a.status<300){console.log(a.data);var s=a.data;0==s.code?(e.$message({message:t.dialog.title+"成功",type:"success"}),e.dialog.dialogFormVisible=!1,e.initData()):e.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"})}),this.loading=!1},handleDeleteAlert:function(e){var t=this;this.$confirm("此操作将删除该菜品标签, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.handleDelete(e)}).catch(function(){})},handleDelete:function(e){var t=this;this.loading=!0;this.$api.delete("/store/goods_tag/"+e.id,null,function(e){if(e.status>=200&&e.status<300){console.log(e.data);var a=e.data;0==a.code?(t.$message({message:"删除成功",type:"success"}),t.initData()):(t.$message({message:a.msg,type:"warning"}),t.loading=!1)}else t.$message({message:"服务器维护中",type:"error"}),t.loading=!1})}}},Qe={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fillcontain"},[a("div",{staticClass:"table_container"},[a("el-row",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleEdit(0,"","add")}}},[e._v("新增标签")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.getMainStoreTags()}}},[e._v("从总部复制标签")])],1),e._v(" "),a("br"),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData}},[a("el-table-column",{attrs:{label:"标签名",prop:"name"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleEdit(t.$index,t.row,"edit")}}},[e._v("\n                    编辑\n                ")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.handleDeleteAlert(t.row)}}},[e._v("\n                  删除\n                ")])]}}])})],1),e._v(" "),a("div",{staticClass:"Pagination"},[a("el-pagination",{attrs:{"current-page":e.pages.page,"page-size":e.pages.pageSize,layout:"total, prev, pager, next",total:e.pages.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:e.dialog.title,visible:e.dialog.dialogFormVisible,"close-on-click-modal":e.dialog.close},on:{"update:visible":function(t){return e.$set(e.dialog,"dialogFormVisible",t)}}},[a("el-form",{attrs:{model:e.goods_tag}},[a("el-form-item",{attrs:{label:"标签名","label-width":"100px"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.goods_tag.name,callback:function(t){e.$set(e.goods_tag,"name",t)},expression:"goods_tag.name"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialog.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleSave}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:e.tag_dialog.title,visible:e.tag_dialog.dialogFormVisible,"close-on-click-modal":e.tag_dialog.close},on:{"update:visible":function(t){return e.$set(e.tag_dialog,"dialogFormVisible",t)}}},[a("el-form",{attrs:{model:e.goods_tag}},[a("el-form-item",{attrs:{label:"总部标签","label-width":"100px"}},e._l(e.tagChecks,function(t,s){return a("el-checkbox",{key:s,attrs:{border:"",label:t.name,border:""},model:{value:t.check,callback:function(a){e.$set(t,"check",a)},expression:"item.check"}})}),1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.tag_dialog.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleCopy()}}},[e._v("确定复制")])],1)],1)],1)])},staticRenderFns:[]};var Je=a("VU/8")(We,Qe,!1,function(e){a("lCZh")},null,null).exports,Ye={data:function(){return{baseUrl:E,baseImgPath:B,uploadUrl:E+"/common/imageUpload",loading:!1,printer_loading:!1,tag_loading:!1,goods:{id:0,name:"",number:"",marker_price:"",sell_price:"",note:"",status:"1",pic_ids:"",tag_ids:"",printer_ids:"",kitchenPrinter:"1",outsideStatus:""},dialog:{dialogFormVisible:!1,title:"新增分店",close:!1},main_goods_dialog:{dialogFormVisible:!1,title:"总部菜品标签",close:!1},pages:{offset:0,pageSize:10,page:1,total:0,keyword:""},tableData:[],picFiles:[],picVisible:!1,picUrl:"",tagChecks:[],printerChecks:[],mainStoreTags:[]}},created:function(){this.initData()},methods:{initData:function(){var e=this;this.loading=!0;var t=this;t.$api.get("/store/goods",t.pages,function(a){if(a.status>=200&&a.status<300){var s=a.data;0==s.code?(t.tableData=s.data.goods.content,t.pages.total=s.data.goods.totalElements):e.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"});e.loading=!1})},getMainStoreGoods:function(){var e=this;this.mainStoreTags=[],this.loading=!0;this.$api.get("/store/goods/main_goods",{page:1,pageSize:1e4},function(t){if(t.status>=200&&t.status<300){var a=t.data;if(0==a.code){var s=a.data.goods.content,i=s.length;if(i>0)for(var o=0;o<i;o++){var n=s[o];e.mainStoreTags.push({check:!1,name:n.name,id:n.id})}e.main_goods_dialog.dialogFormVisible=!0}else e.$message({message:a.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"});e.loading=!1})},handleSizeChange:function(e){console.log("每页 "+e+" 条")},handleCurrentChange:function(e){this.pages.page=e,this.pages.offset=(e-1)*this.pages.pageSize,this.initData()},statusFormat:function(e,t){return 2==e.status?"上架":"下架"},markerPriceFormat:function(e,t){return e.marker_price/100},sellPriceFormat:function(e,t){return e.sell_price/100},handleBeforeRemove:function(e,t){var a=this;return this.$confirm("此操作将删除该图片, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.handleRemove(e,t)}).catch(function(){}),!1},handleRemove:function(e,t){console.log(e);var a=this.picFiles.indexOf(e);console.log(a),a>-1&&this.picFiles.splice(a,1),console.log(this.picFiles)},handleSuccess:function(e,t,a){t.id=e.ids[0],console.log(e),t.url=this.baseUrl+e.thumbnails[0],t.downloadUrl=this.baseUrl+e.data[0],t.ext=e.exts[0],this.picFiles.push(t)},handlPicPreview:function(e){console.log(e),".jpg"==e.ext.toLowerCase()||".bmp"==e.ext.toLowerCase()||".jpeg"==e.ext.toLowerCase()||".png"==e.ext.toLowerCase()?(this.picUrl==e.downloadUrl?this.picVisible=!this.picVisible:this.picVisible=!0,this.picUrl=e.downloadUrl):(this.picVisible=!1,location.href=e.downloadUrl)},in_array:function(e,t){for(var a in t)if(t[a]==e)return!0;return!1},handleEdit:function(e,t,a){if(this.getPrinters(a,t),this.getGoodTags(a,t),this.picFiles=new Array,"edit"==a){if(this.dialog.title="修改菜品",this.goods.id=t.id,this.goods.number=t.number,this.goods.name=t.name,this.goods.marker_price=t.marker_price/100,this.goods.sell_price=t.sell_price/100,this.goods.note=t.note,this.goods.status=""+t.status,this.goods.outsideStatus=""+t.outsideStatus,this.goods.kitchenPrinter=""+t.kitchenPrinter,null!=t.pics&&t.pics.length>0){var s=t.pics.length;if(s>0)for(var i=0;i<s;i++){var o=t.pics[i],n={name:o.name,url:this.baseUrl+o.thumbnail,id:o.id,downloadUrl:this.baseUrl+o.url,ext:o.ext};this.picFiles.push(n)}}this.dialog.dialogFormVisible=!0}else"add"==a&&(this.dialog.title="新增菜品",this.goods.id=0,this.goods.number="",this.goods.name="",this.goods.marker_price="",this.goods.sell_price="",this.goods.note="",this.goods.status="",this.goods.outsideStatus="",this.goods.kitchenPrinter="0",this.dialog.dialogFormVisible=!0)},getPrinters:function(e,t){var a=this;this.printer_loading=!0;this.printerChecks=[],this.$api.get("/store/printer",{order_and_maked:1},function(s){if(s.status>=200&&s.status<300){var i=s.data;if(0==i.code){var o=i.data.printers,n=o.length;if(n>0){for(var l=0;l<n;l++){var r=o[l];a.printerChecks.push({check:!1,name:r.name,id:r.id})}if("edit"==e&&t.printers.length>0&&a.printerChecks.length>0){var c=new Array;for(l=0;l<t.printers.length;l++){r=t.printers[l];c.push(r.id)}for(l=0;l<a.printerChecks.length;l++){r=a.printerChecks[l];a.in_array(r.id,c)&&(a.printerChecks[l].check=!0)}}}}else a.$message({message:i.msg,type:"warning"})}else a.$message({message:"服务器维护中",type:"error"});a.printer_loading=!1})},getGoodTags:function(e,t){var a=this;this.tag_loading=!0;this.tagChecks=[],this.$api.get("/store/goods_tag",{page:1,pageSize:1e4},function(s){if(s.status>=200&&s.status<300){var i=s.data;if(0==i.code){var o=i.data.goods_tags.content,n=o.length;if(n>0){for(var l=0;l<n;l++){var r=o[l];a.tagChecks.push({check:!1,name:r.name,id:r.id})}if("edit"==e&&t.goodsTags.length>0&&a.tagChecks.length>0){var c=new Array;for(l=0;l<t.goodsTags.length;l++){r=t.goodsTags[l];c.push(r.id)}for(l=0;l<a.tagChecks.length;l++){r=a.tagChecks[l];a.in_array(r.id,c)&&(a.tagChecks[l].check=!0)}}}}else a.$message({message:i.msg,type:"warning"})}else a.$message({message:"服务器维护中",type:"error"});a.tag_loading=!1})},handleCopy:function(){var e=this;this.loading=!0;var t="";if(this.mainStoreTags.forEach(function(e,a){1==e.check&&(t+=e.id+"#")}),""==t)return this.loading=!1,void this.$message({message:"请选择要复制的菜品",type:"warning"});this.$api.post("/store/goods/copy",{ids:t},function(t){if(t.status>=200&&t.status<300){console.log(t.data);var a=t.data;0==a.code?(e.$message({message:"复制成功",type:"success"}),e.main_goods_dialog.dialogFormVisible=!1,e.initData()):e.$message({message:a.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"})}),this.loading=!1},handleSave:function(){var e=this;this.loading=!0;var t=this;t.goods.pic_ids="";for(var a=0,s=this.picFiles.length;a<s;a++)t.goods.pic_ids+=this.picFiles[a].id+"#";t.goods.tag_ids="",this.tagChecks.forEach(function(e,a){1==e.check&&(t.goods.tag_ids+=e.id+"#")}),t.goods.printer_ids="",this.printerChecks.forEach(function(e,a){1==e.check&&(t.goods.printer_ids+=e.id+"#")}),t.goods.sell_price=100*t.goods.sell_price,t.goods.marker_price=100*t.goods.marker_price,t.$api.post("/store/goods",t.goods,function(a){if(a.status>=200&&a.status<300){console.log(a.data);var s=a.data;0==s.code?(e.$message({message:t.dialog.title+"成功",type:"success"}),e.dialog.dialogFormVisible=!1,e.initData()):e.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"})}),this.loading=!1},handleDeleteAlert:function(e){var t=this;this.$confirm("此操作将删除该菜品, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.handleDelete(e)}).catch(function(){})},handleDelete:function(e){var t=this;this.loading=!0;this.$api.delete("/store/goods/"+e.id,null,function(e){if(e.status>=200&&e.status<300){console.log(e.data);var a=e.data;0==a.code?(t.$message({message:"删除成功",type:"success"}),t.loading=!1,t.initData()):t.$message({message:a.msg,type:"warning"})}else t.$message({message:"服务器维护中",type:"error"})})}}},Ke={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fillcontain"},[a("div",{staticClass:"table_container"},[a("el-row",[a("el-col",{attrs:{span:8}},[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入菜品名字或编号查询"},model:{value:e.pages.keyword,callback:function(t){e.$set(e.pages,"keyword",t)},expression:"pages.keyword"}})],1),e._v(" "),a("el-col",{attrs:{span:3}},[a("el-button",{on:{click:e.initData}},[e._v("搜索")])],1),e._v(" "),a("el-col",{attrs:{span:3}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleEdit(0,"","add")}}},[e._v("新增菜品")])],1),e._v(" "),a("el-col",{attrs:{span:3}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.getMainStoreGoods()}}},[e._v("从总部复制菜品")])],1)],1),e._v(" "),a("br"),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData}},[a("el-table-column",{attrs:{label:"主图"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.pics.length>0?a("img",{attrs:{src:e.baseImgPath+"/api"+t.row.pics[0].url,width:"50",height:"50"}}):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"菜名",prop:"name"}}),e._v(" "),a("el-table-column",{attrs:{label:"编号",prop:"number"}}),e._v(" "),a("el-table-column",{attrs:{label:"市场价",formatter:e.markerPriceFormat}}),e._v(" "),a("el-table-column",{attrs:{label:"销售价",formatter:e.sellPriceFormat}}),e._v(" "),a("el-table-column",{attrs:{label:"备注",prop:"note","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{label:"状态",formatter:e.statusFormat}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleEdit(t.$index,t.row,"edit")}}},[e._v("\n                    编辑\n                ")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.handleDeleteAlert(t.row)}}},[e._v("\n                  删除\n                ")])]}}])})],1),e._v(" "),a("div",{staticClass:"Pagination"},[a("el-pagination",{attrs:{"current-page":e.pages.page,"page-size":e.pages.pageSize,layout:"total, prev, pager, next",total:e.pages.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:e.dialog.title,visible:e.dialog.dialogFormVisible,"close-on-click-modal":e.dialog.close},on:{"update:visible":function(t){return e.$set(e.dialog,"dialogFormVisible",t)}}},[a("el-form",{attrs:{model:e.goods}},[a("el-form-item",{attrs:{label:"菜名","label-width":"80px"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.goods.name,callback:function(t){e.$set(e.goods,"name",t)},expression:"goods.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"编号","label-width":"80px"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.goods.number,callback:function(t){e.$set(e.goods,"number",t)},expression:"goods.number"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"市场价","label-width":"80px"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.goods.marker_price,callback:function(t){e.$set(e.goods,"marker_price",t)},expression:"goods.marker_price"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"销售价","label-width":"80px"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.goods.sell_price,callback:function(t){e.$set(e.goods,"sell_price",t)},expression:"goods.sell_price"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"备注","label-width":"80px"}},[a("el-input",{attrs:{type:"textarea",rows:"4"},model:{value:e.goods.note,callback:function(t){e.$set(e.goods,"note",t)},expression:"goods.note"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"状态","label-width":"80px"}},[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-text":"上架","inactive-text":"下架","active-value":"2","inactive-value":"1"},model:{value:e.goods.status,callback:function(t){e.$set(e.goods,"status",t)},expression:"goods.status"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"只限内部员工查看","label-width":"150px"}},[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-text":"不限制","inactive-text":"限制","active-value":"1","inactive-value":"2"},model:{value:e.goods.outsideStatus,callback:function(t){e.$set(e.goods,"outsideStatus",t)},expression:"goods.outsideStatus"}}),e._v(" "),2==e.goods.outsideStatus?a("el-alert",{attrs:{title:"开启只限内部员工查看时,本菜品将不在客人的电子菜单上显示，但不影响店内员工的点餐端显示，适合碗筷等产品录入",type:"warning"}}):e._e()],1),e._v(" "),a("el-form-item",{directives:[{name:"loading",rawName:"v-loading",value:e.tag_loading,expression:"tag_loading"}],attrs:{label:"菜品标签","label-width":"120px"}},[null==e.tagChecks||0==e.tagChecks.length?a("span",{staticStyle:{color:"red"}},[e._v("暂无菜品标签,您可以到菜品标签页面进行创建标签")]):e._l(e.tagChecks,function(t,s){return a("el-checkbox",{key:s,attrs:{border:"",label:t.name,border:""},model:{value:t.check,callback:function(a){e.$set(t,"check",a)},expression:"item.check"}})})],2),e._v(" "),a("el-form-item",{attrs:{label:"厨房打印开关","label-width":"150px"}},[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-text":"指定打印","inactive-text":"不打印","active-value":"1","inactive-value":"0"},model:{value:e.goods.kitchenPrinter,callback:function(t){e.$set(e.goods,"kitchenPrinter",t)},expression:"goods.kitchenPrinter"}}),e._v(" "),0==e.goods.kitchenPrinter?a("el-alert",{attrs:{title:"【不打印】是指本产品将不在厨房相关的打印机上进行打印,适合如碗筷等不需要在后厨打印出来的产品",type:"warning"}}):e._e()],1),e._v(" "),1==e.goods.kitchenPrinter?a("el-form-item",{directives:[{name:"loading",rawName:"v-loading",value:e.printer_loading,expression:"printer_loading"}],attrs:{label:"指定厨房打印机","label-width":"120px"}},[0==e.printerChecks.length?a("div",[a("span",{staticStyle:{color:"red"}},[e._v("暂无后厨相关打印机,您可以到打印机配置页面进行配置打印机（如不配置，默认所有的后厨打印机都会进行打印）")]),e._v(" "),e._l(e.printerChecks,function(t,s){return a("el-checkbox",{key:s,attrs:{border:"",label:t.name,border:""},model:{value:t.check,callback:function(a){e.$set(t,"check",a)},expression:"item.check"}})})],2):a("div",e._l(e.printerChecks,function(t,s){return a("el-checkbox",{key:s,attrs:{border:"",label:t.name,border:""},model:{value:t.check,callback:function(a){e.$set(t,"check",a)},expression:"item.check"}})}),1)]):e._e(),e._v(" "),a("el-form-item",{attrs:{label:"图片","label-width":"80px"}},[a("div",{staticStyle:{"text-align":"left",margin:"5px"}},[a("el-upload",{attrs:{action:e.uploadUrl,"list-type":"picture-card","on-preview":e.handlPicPreview,"before-remove":e.handleBeforeRemove,"on-success":e.handleSuccess,"file-list":e.picFiles}},[a("i",{staticClass:"el-icon-plus"})]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.picVisible,expression:"picVisible"}],attrs:{size:"tiny"}},[a("img",{attrs:{width:"100%",src:e.picUrl,alt:""}})])],1)])],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialog.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleSave}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:e.main_goods_dialog.title,visible:e.main_goods_dialog.dialogFormVisible,"close-on-click-modal":e.main_goods_dialog.close},on:{"update:visible":function(t){return e.$set(e.main_goods_dialog,"dialogFormVisible",t)}}},[a("el-form",[a("el-form-item",{attrs:{label:"总部标签","label-width":"100px"}},e._l(e.mainStoreTags,function(t,s){return a("el-checkbox",{key:s,attrs:{border:"",label:t.name,border:""},model:{value:t.check,callback:function(a){e.$set(t,"check",a)},expression:"item.check"}})}),1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.main_goods_dialog.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleCopy()}}},[e._v("确定复制")])],1)],1)],1)])},staticRenderFns:[]};var Xe=a("VU/8")(Ye,Ke,!1,function(e){a("zWrd")},null,null).exports,Ze={data:function(){return{baseUrl:E,baseImgPath:B,uploadUrl:E+"/common/imageUpload",keyUploadUrl:"",loading:!1,payment:{id:0,params:"",status:1},dialog:{dialogFormVisible:!1,title:"新增支付",close:!1},tableData:[],params:[],jsapi_url:""}},created:function(){this.initData()},methods:{initData:function(){var e=this;this.loading=!0;var t=this;t.$api.get("/store/payment_config",t.pages,function(a){if(a.status>=200&&a.status<300){var s=a.data;0==s.code?(t.tableData=s.data.paymentsConfigs,t.jsapi_url=s.data.jsapi_url):e.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"});e.loading=!1})},handleRemove:function(e,t){console.log(e,t)},handlePreview:function(e){console.log(e)},handleExceed:function(e,t){},beforeRemove:function(e,t){return this.$confirm("确定移除 "+e.name+"？")},statusFormat:function(e,t){return 2==e.status?"使用中":"未使用"},handleSuccess:function(e,t,a){console.log(t),this.params[e.key].value=e.paths[0]},goBuy:function(e){this.$router.push({path:"/store/pluginsStore",query:{uuid:e.uuid}})},handleEdit:function(e,t,a){this.dialog.title="配置:"+t.name,this.payment.id=t.id,this.payment.status=""+t.status,this.payment.name=t.name,this.params=t.paramsMap,this.dialog.dialogFormVisible=!0},handleSave:function(){var e=this;console.log("+++++++++++"),console.log(this.params),this.loading=!0;var t=this;t.payment.params=U()(this.params),t.$api.put("/store/payment_config/"+t.payment.id,t.payment,function(a){if(a.status>=200&&a.status<300){console.log(a.data);var s=a.data;0==s.code?(e.$message({message:t.dialog.title+"成功",type:"success"}),e.dialog.dialogFormVisible=!1,e.initData()):e.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"})}),this.loading=!1}}},et={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fillcontain"},[a("div",{staticClass:"table_container"},[a("el-alert",{attrs:{title:"支付jsapi地址:"+e.jsapi_url,type:"success"}}),e._v(" "),a("br"),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData}},[a("el-table-column",{attrs:{label:"支付方式",prop:"name"}}),e._v(" "),a("el-table-column",{attrs:{label:"使用状态",formatter:e.statusFormat}}),e._v(" "),a("el-table-column",{attrs:{label:"插件状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[4==t.row.plugins.status?a("span",{staticStyle:{color:"green"}},[e._v(e._s(t.row.plugins.statusStr))]):1==t.row.plugins.status?a("span",{staticStyle:{color:"red"}},[e._v(e._s(t.row.plugins.statusStr))]):2==t.row.plugins.status?a("span",{staticStyle:{color:"saddlebrown"}},[e._v(e._s(t.row.plugins.statusStr))]):3==t.row.plugins.status?a("span",{staticStyle:{color:"red"}},[e._v(e._s(t.row.plugins.statusStr))]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[4==t.row.plugins.status?a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleEdit(t.$index,t.row,"edit")}}},[e._v("\n            配置\n          ")]):e._e(),e._v(" "),1==t.row.plugins.status||3==t.row.plugins.status?a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.goBuy(e.row.plugins)}}},[e._v("\n            购买\n          ")]):e._e()]}}])})],1),e._v(" "),a("el-dialog",{attrs:{title:e.dialog.title,visible:e.dialog.dialogFormVisible,"close-on-click-modal":e.dialog.close},on:{"update:visible":function(t){return e.$set(e.dialog,"dialogFormVisible",t)}}},[a("el-form",{attrs:{model:e.payment}},[e._l(e.params,function(t,s){return a("el-form-item",{key:s,attrs:{label:s,"label-width":"100px"}},["text"==t.ele_type?a("el-input",{attrs:{"auto-complete":"off",placeholder:t.placeholder},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}}):e._e(),e._v(" "),"file"==t.ele_type?a("div",[""==t.value?a("el-upload",{attrs:{action:e.uploadUrl+"?key="+s,"on-success":e.handleSuccess,limit:1}},[a("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")]),e._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(e._s(t.placeholder))])],1):a("div",[e._v("\n              已上传"+e._s(s)+"文件  "),a("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(e){t.value=""}}},[e._v("删除")])],1)],1):e._e()],1)}),e._v(" "),a("el-form-item",{attrs:{label:"状态","label-width":"80px"}},[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-text":"使用","inactive-text":"不使用","active-value":"2","inactive-value":"1"},model:{value:e.payment.status,callback:function(t){e.$set(e.payment,"status",t)},expression:"payment.status"}})],1)],2),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialog.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleSave}},[e._v("确 定")])],1)],1)],1)])},staticRenderFns:[]};var tt=a("VU/8")(Ze,et,!1,function(e){a("XbXr")},null,null).exports,at={data:function(){return{baseUrl:E,baseImgPath:B,loading:!1,oauth:{id:0,params:"",status:1},dialog:{dialogFormVisible:!1,title:"新增授权",close:!1},tableData:[],params:[],oauth_callback_url:""}},created:function(){this.initData()},methods:{initData:function(){var e=this;this.loading=!0;var t=this;t.$api.get("/store/oauth_config",t.pages,function(a){if(a.status>=200&&a.status<300){var s=a.data;0==s.code?(t.tableData=s.data.oauthConfigs,t.oauth_callback_url=s.data.oauth_callback_url):e.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"});e.loading=!1})},handleSizeChange:function(e){console.log("每页 "+e+" 条")},handleCurrentChange:function(e){this.pages.page=e,this.pages.offset=(e-1)*this.pages.pageSize,this.initData()},statusFormat:function(e,t){return 2==e.status?"使用中":"未使用"},goBuy:function(e){this.$router.push({path:"/store/pluginsStore",query:{uuid:e.uuid}})},handleEdit:function(e,t,a){this.dialog.title="配置:"+t.name,this.oauth.id=t.id,this.oauth.name=t.name,this.oauth.status=""+t.plugins.status,this.params=t.paramsMap,this.dialog.dialogFormVisible=!0},handleSave:function(){var e=this;this.loading=!0;var t=this;t.oauth.params=U()(this.params),t.$api.put("/store/oauth_config/"+t.oauth.id,t.oauth,function(a){if(a.status>=200&&a.status<300){console.log(a.data);var s=a.data;0==s.code?(e.$message({message:t.dialog.title+"成功",type:"success"}),e.dialog.dialogFormVisible=!1,e.initData()):e.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"})}),this.loading=!1}}},st={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fillcontain"},[a("div",{staticClass:"table_container"},[a("el-alert",{attrs:{title:"授权回调地址:"+e.oauth_callback_url,type:"success"}}),e._v(" "),a("br"),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData}},[a("el-table-column",{attrs:{label:"授权方式",prop:"name"}}),e._v(" "),a("el-table-column",{attrs:{label:"使用状态",formatter:e.statusFormat}}),e._v(" "),a("el-table-column",{attrs:{label:"插件状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[4==t.row.plugins.status?a("span",{staticStyle:{color:"green"}},[e._v(e._s(t.row.plugins.statusStr))]):1==t.row.plugins.status?a("span",{staticStyle:{color:"red"}},[e._v(e._s(t.row.plugins.statusStr))]):2==t.row.plugins.status?a("span",{staticStyle:{color:"saddlebrown"}},[e._v(e._s(t.row.plugins.statusStr))]):3==t.row.plugins.status?a("span",{staticStyle:{color:"red"}},[e._v(e._s(t.row.plugins.statusStr))]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[4==t.row.plugins.status?a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleEdit(t.$index,t.row,"edit")}}},[e._v("\n                  配置\n                ")]):e._e(),e._v(" "),1==t.row.plugins.status||3==t.row.plugins.status?a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.goBuy(t.row.plugins)}}},[e._v("\n                  购买\n                ")]):e._e()]}}])})],1),e._v(" "),a("el-dialog",{attrs:{title:e.dialog.title,visible:e.dialog.dialogFormVisible,"close-on-click-modal":e.dialog.close},on:{"update:visible":function(t){return e.$set(e.dialog,"dialogFormVisible",t)}}},[a("el-form",{attrs:{model:e.oauth}},[e._l(e.params,function(t,s){return a("el-form-item",{key:s,attrs:{label:s,"label-width":"100px"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:t.placeholder},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}})],1)}),e._v(" "),a("el-form-item",{attrs:{label:"状态","label-width":"80px"}},[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-text":"使用","inactive-text":"不使用","active-value":"2","inactive-value":"1"},model:{value:e.oauth.status,callback:function(t){e.$set(e.oauth,"status",t)},expression:"oauth.status"}})],1)],2),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialog.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleSave}},[e._v("确 定")])],1)],1)],1)])},staticRenderFns:[]};var it=a("VU/8")(at,st,!1,function(e){a("ncbP")},null,null).exports,ot={data:function(){return{baseUrl:E,baseImgPath:B,loading:!1,printerDataModel:{id:0,status:1,printData:""},dialog:{dialogFormVisible:!1,title:"新增支付",close:!1},tableData:[],params:[]}},created:function(){this.initData()},methods:{initData:function(){var e=this;this.loading=!0;var t=this;t.$api.get("/store/printer_data_model",t.pages,function(a){if(a.status>=200&&a.status<300){var s=a.data;0==s.code?t.tableData=s.data.printerDataModels:e.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"});e.loading=!1})},handleSizeChange:function(e){console.log("每页 "+e+" 条")},handleCurrentChange:function(e){this.pages.page=e,this.pages.offset=(e-1)*this.pages.pageSize,this.initData()},statusFormat:function(e,t){return null==e.printData||""==e.printData?"未配置":"已配置"},handleEdit:function(e,t,a){this.dialog.title="配置:"+t.name,this.printerDataModel.id=t.id,this.printerDataModel.name=t.name,this.printerDataModel.printData=t.printData,this.dialog.dialogFormVisible=!0},handleSave:function(){var e=this;this.loading=!0;var t=this;t.$api.put("/store/printer_data_model/"+t.printerDataModel.id,t.printerDataModel,function(a){if(a.status>=200&&a.status<300){console.log(a.data);var s=a.data;0==s.code?(e.$message({message:t.dialog.title+"成功",type:"success"}),e.dialog.dialogFormVisible=!1,e.initData()):e.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"})}),this.loading=!1}}},nt={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fillcontain"},[a("div",{staticClass:"table_container"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData}},[a("el-table-column",{attrs:{label:"打印点",prop:"name"}}),e._v(" "),a("el-table-column",{attrs:{label:"状态",formatter:e.statusFormat}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleEdit(t.$index,t.row,"edit")}}},[e._v("\n                        配置\n                    ")])]}}])})],1),e._v(" "),a("el-dialog",{attrs:{title:e.dialog.title,visible:e.dialog.dialogFormVisible,"close-on-click-modal":e.dialog.close},on:{"update:visible":function(t){return e.$set(e.dialog,"dialogFormVisible",t)}}},[a("el-form",{attrs:{model:e.printerDataModel}},[a("el-form-item",{attrs:{label:"模板","label-width":"80px"}},[a("el-row",[a("el-col",{attrs:{span:14}},[a("el-input",{attrs:{type:"textarea",rows:"50",placeholder:"订单号: ###b### ###order_no###  ###/b###\n###br###\n桌号: ###table_number###\n###br###\n\n菜品            单价            数量             总计\n###br###\n###start_goods_content###\n###goods_name###            ###goods_sell_price###            ###goods_count###            ###goods_total_price###\n###br###\n###end_goods_content###\n\n###br###\n总金额：###total_price###\n###br###\n###cut###"},model:{value:e.printerDataModel.printData,callback:function(t){e.$set(e.printerDataModel,"printData",t)},expression:"printerDataModel.printData"}})],1),e._v(" "),a("el-col",{staticStyle:{"margin-left":"15px"},attrs:{span:8}},[a("p",[e._v("替换内容")]),e._v(" "),a("p",[e._v("###order_no### : 订单号")]),e._v(" "),a("p",[e._v("###out_no### : 订单序号")]),e._v(" "),a("p",[e._v("###total_price### : 订单总价")]),e._v(" "),a("p",[e._v("###real_price### : 订单支付价格")]),e._v(" "),a("p",[e._v("###table_number### : 餐桌编号")]),e._v(" "),a("p",[e._v("###note### : 订单备注")]),e._v(" "),a("p",[e._v("###goods_name### : 菜品名字")]),e._v(" "),a("p",[e._v("###goods_sell_price### : 菜品单价")]),e._v(" "),a("p",[e._v("###goods_count### : 菜品数量")]),e._v(" "),a("p",[e._v("###goods_count### : 菜品总价")]),e._v(" "),a("p",[e._v("###goods_count### : 菜品数量")]),e._v(" "),a("p",[e._v("###start_goods_content### : 菜品内容开始符")]),e._v(" "),a("p",[e._v("###end_goods_content### : 菜品内容结束符")]),e._v(" "),a("p",[e._v("###br### : 换行")]),e._v(" "),a("p",[e._v("###cut### : 切刀指令(主动切纸,仅限切刀打印机使用才有效果)")]),e._v(" "),a("p",[e._v("###cb###  ###/cb###: 居中放大")]),e._v(" "),a("p",[e._v("###b###  ###/b###: 放大一倍")]),e._v(" "),a("p",[e._v("###c###  ###/c###: 居中")]),e._v(" "),a("p",[e._v("###l###  ###/l###: 字体变高一倍")]),e._v(" "),a("p",[e._v("###w###  ###/w###: 字体变宽一倍")]),e._v(" "),a("p",[e._v("###right###  ###/right###: 右对齐")]),e._v(" "),a("p",[e._v("###bold###  ###/bold###: 加粗")])])],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialog.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleSave}},[e._v("确 定")])],1)],1)],1)])},staticRenderFns:[]};var lt=a("VU/8")(ot,nt,!1,function(e){a("xAP0")},null,null).exports,rt={data:function(){return{baseUrl:E,baseImgPath:B,loading:!1,printer:{id:0,name:"",params:"",status:1,pluginUUID:"",chooseuuid:"",data_model_ids:""},dialog:{dialogFormVisible:!1,title:"新增打印机",close:!1},tableData:[],params:[],brands:[],modelChecks:[]}},created:function(){this.initData()},methods:{initData:function(){var e=this;this.loading=!0;var t=this;t.$api.get("/store/printer",t.pages,function(a){if(a.status>=200&&a.status<300){var s=a.data;0==s.code?t.tableData=s.data.printers:e.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"});e.loading=!1})},handleSizeChange:function(e){console.log("每页 "+e+" 条")},handleCurrentChange:function(e){this.pages.page=e,this.pages.offset=(e-1)*this.pages.pageSize,this.initData()},statusFormat:function(e,t){return 2==e.status?"启用中":"未启用"},handleEdit:function(e,t,a){var s=this;this.modelChecks=[],this.loading=!0;var i=this;i.$api.get("/store/printer/brand_and_model",i.pages,function(e){if(e.status>=200&&e.status<300){var o=e.data;if(0==o.code){for(var n=o.data.printers_data_model,l=n.length,r=0;r<l;r++){var c=n[r];s.modelChecks.push({check:!1,name:c.name,id:c.id})}if(i.brands=o.data.printers_brand,"edit"==a){if(s.dialog.title="配置:"+t.name,s.printer.id=t.id,s.printer.name=t.name,s.printer.status=""+t.status,s.printer.pluginUUID=t.pluginUUID,s.printer.chooseuuid=t.pluginUUID,s.params=t.paramsMap,t.printerDataModels.length>0&&s.modelChecks.length>0){var d=new Array;for(r=0;r<t.printerDataModels.length;r++){c=t.printerDataModels[r];d.push(c.id)}for(r=0;r<s.modelChecks.length;r++){c=s.modelChecks[r];s.in_array(c.id,d)&&(s.modelChecks[r].check=!0)}}}else s.dialog.title="新增打印机",s.printer.id=0,s.printer.chooseuuid=s.printer.pluginUUID=i.brands[0].pluginUUID,s.printer.name=i.brands[0].name+"打印机",s.printer.status="1",s.params=i.brands[0].paramsMap;s.dialog.dialogFormVisible=!0}else s.$message({message:o.msg,type:"warning"})}else s.$message({message:"服务器维护中",type:"error"});s.loading=!1})},handleDeleteAlert:function(e){var t=this;this.$confirm("此操作将删除该打印机吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.handleDelete(e)}).catch(function(){})},handleDelete:function(e){var t=this;this.loading=!0;this.$api.delete("/store/printer/"+e.id,null,function(e){if(e.status>=200&&e.status<300){console.log(e.data);var a=e.data;0==a.code?(t.$message({message:"删除成功",type:"success"}),t.initData()):(t.$message({message:a.msg,type:"warning"}),t.loading=!1)}else t.$message({message:"服务器维护中",type:"error"}),t.loading=!1})},in_array:function(e,t){for(var a in t)if(t[a]==e)return!0;return!1},brandChange:function(){var e=this;this.printer.id>0&&this.printer.pluginUUID==this.printer.chooseuuid?this.tableData.forEach(function(t,a){t.pluginUUID==e.printer.chooseuuid&&(e.params=t.paramsMap)}):this.brands.forEach(function(t,a){t.pluginUUID==e.printer.chooseuuid&&(e.params=t.paramsMap)})},handleSave:function(){var e=this;this.loading=!0;var t=this;t.printer.params=U()(this.params),t.printer.data_model_ids="",this.modelChecks.forEach(function(e,a){1==e.check&&(t.printer.data_model_ids+=e.id+"#")}),t.printer.pluginUUID=t.printer.chooseuuid,t.$api.post("/store/printer",t.printer,function(a){if(a.status>=200&&a.status<300){console.log(a.data);var s=a.data;0==s.code?(e.$message({message:t.dialog.title+"成功",type:"success"}),e.dialog.dialogFormVisible=!1,e.initData()):e.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"});e.loading=!1})}}},ct={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fillcontain"},[a("div",{staticClass:"table_container"},[a("el-row",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleEdit(0,"","add")}}},[e._v("新增打印机")])],1),e._v(" "),a("br"),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData}},[a("el-table-column",{attrs:{label:"打印机名字",prop:"name"}}),e._v(" "),a("el-table-column",{attrs:{label:"状态",formatter:e.statusFormat}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleEdit(t.$index,t.row,"edit")}}},[e._v("\n                    配置\n                ")]),e._v(" "),1==t.row.status?a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.handleDeleteAlert(t.row)}}},[e._v("\n                  删除\n                ")]):e._e()]}}])})],1),e._v(" "),a("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{title:e.dialog.title,visible:e.dialog.dialogFormVisible,"close-on-click-modal":e.dialog.close},on:{"update:visible":function(t){return e.$set(e.dialog,"dialogFormVisible",t)}}},[a("el-form",{attrs:{model:e.printer}},[a("el-form-item",{attrs:{label:"名称","label-width":"100px"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.printer.name,callback:function(t){e.$set(e.printer,"name",t)},expression:"printer.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"绑定打印数据模板","label-width":"80px"}},e._l(e.modelChecks,function(t,s){return a("el-checkbox",{key:s,attrs:{border:"",label:t.name,border:""},model:{value:t.check,callback:function(a){e.$set(t,"check",a)},expression:"item.check"}})}),1),e._v(" "),a("el-form-item",{attrs:{label:"状态","label-width":"100px"}},[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-text":"启用","inactive-text":"不启用","active-value":"2","inactive-value":"1"},model:{value:e.printer.status,callback:function(t){e.$set(e.printer,"status",t)},expression:"printer.status"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"打印机品牌","label-width":"100px"}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:e.brandChange},model:{value:e.printer.chooseuuid,callback:function(t){e.$set(e.printer,"chooseuuid",t)},expression:"printer.chooseuuid"}},e._l(e.brands,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.pluginUUID}})}),1)],1),e._v(" "),e._l(e.params,function(t,s){return a("el-form-item",{key:s,attrs:{label:s,"label-width":"100px"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:t.placeholder},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}})],1)})],2),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialog.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleSave}},[e._v("确 定")])],1)],1)],1)])},staticRenderFns:[]};var dt=a("VU/8")(rt,ct,!1,function(e){a("5rvl")},null,null).exports,ut={data:function(){return{baseUrl:E,baseImgPath:B,loading:!1,admin:{id:0,account:"",name:"",number:"",sex:"1",birthday:"",telephones:"",note:"",isFreeze:"0"},dialog:{dialogFormVisible:!1,title:"新增店员",close:!1},pages:{offset:0,pageSize:10,page:1,total:0},userTableData:[],storePrefix:"",login_url:"",wxDialogVisible:!1,qrcodeurl:"",wx_login_url:null}},created:function(){var e=window.localStorage,t=JSON.parse(e.user);this.storePrefix=t.mainStore.storePrefix,this.initData()},methods:{initData:function(){var e=this;this.loading=!0;var t=this;t.$api.get("/store/store_user",t.pages,function(a){if(a.status>=200&&a.status<300){var s=a.data;0==s.code?(t.userTableData=s.data.store_users.content,t.login_url=s.data.login_url,t.wx_login_url=e.baseUrl+"/common/qrCode?content="+encodeURIComponent(s.data.wx_login_url),t.pages.total=s.data.store_users.totalElements):e.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"});e.loading=!1})},handleSizeChange:function(e){console.log("每页 "+e+" 条")},handleCurrentChange:function(e){this.pages.page=e,this.pages.offset=(e-1)*this.pages.pageSize,this.initData()},rreezeFormat:function(e,t){return""+e.user.isFreeze=="1"?"冻结":"正常"},openBind:function(e){var t=this;this.loading=!0;this.$api.get("/store/store_user/bind_oauth/"+e.id+"/url",null,function(e){if(e.status>=200&&e.status<300){var a=e.data;0==a.code?(t.qrcodeurl=t.baseUrl+"/common/qrCode?content="+encodeURIComponent(a.data.wx_bind_url),t.wxDialogVisible=!0):t.$message({message:a.msg,type:"warning"})}else t.$message({message:"服务器维护中",type:"error"});t.loading=!1})},handleDeleteWxBind:function(e){var t=this;this.$confirm("清除该店员的微信绑定","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.loading=!0,t.$api.delete("/store/store_user/bind_oauth/"+e.id+"/url",null,function(e){if(e.status>=200&&e.status<300){var a=e.data;0==a.code?t.initData():t.$message({message:a.msg,type:"warning"})}else t.$message({message:"服务器维护中",type:"error"});t.loading=!1})}).catch(function(){})},handleEdit:function(e,t,a){"edit"==a?(this.dialog.title="修改店员:"+this.admin.name,this.admin.id=t.id,this.admin.account=t.user.account,this.admin.name=t.name,this.admin.number=t.number,this.admin.sex=""+t.sex,this.admin.birthday=new Date(t.birthday),this.admin.telephones=t.telephones,this.admin.note=t.note,this.admin.isFreeze=""+t.user.isFreeze,this.dialog.dialogFormVisible=!0):"add"==a&&(this.dialog.title="新增店员",this.admin.id=0,this.admin.account="",this.admin.name="",this.admin.number="",this.admin.sex="1",this.admin.birthday=new Date,this.admin.telephones="",this.admin.note="",this.admin.isFreeze="1",this.dialog.dialogFormVisible=!0)},handleSave:function(){var e=this;this.loading=!0;var t=this;t.$api.post("/store/store_user",t.admin,function(a){if(a.status>=200&&a.status<300){console.log(a.data);var s=a.data;0==s.code?(e.$message({message:t.dialog.title+"成功",type:"success"}),e.dialog.dialogFormVisible=!1,e.initData()):e.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"})}),this.loading=!1},handleResetPwdAlert:function(e){var t=this;this.$confirm("此操作将重置该店员的密码为:888888, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.handleResetPwd(e)}).catch(function(){})},handleResetPwd:function(e){var t=this;this.loading=!0;this.$api.put("/store/store_user/reset_password/"+e.id,null,function(e){if(e.status>=200&&e.status<300){console.log(e.data);var a=e.data;0==a.code?t.$message({message:"重置成功,请立即使用默认密码:888888 登录修改密码",type:"success"}):t.$message({message:a.msg,type:"warning"})}else t.$message({message:"服务器维护中",type:"error"});t.loading=!1})},handleDeleteAlert:function(e){var t=this;this.$confirm("此操作将删除该店员, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.handleDelete(e)}).catch(function(){})},handleDelete:function(e){var t=this;this.loading=!0;this.$api.delete("/store/store_user/"+e.id,null,function(e){if(e.status>=200&&e.status<300){console.log(e.data);var a=e.data;0==a.code?(t.$message({message:"删除成功",type:"success"}),t.loading=!1,t.initData()):t.$message({message:a.msg,type:"warning"})}else t.$message({message:"服务器维护中",type:"error"})})}}},gt={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fillcontain"},[a("div",{staticClass:"table_container"},[a("el-row",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleEdit(0,"","add")}}},[e._v("新增店员")]),e._v(" "),a("el-button",{attrs:{type:"warning"},on:{click:function(t){e.qrcodeurl=e.wx_login_url,e.wxDialogVisible=!0}}},[e._v("二维码登录")])],1),e._v(" "),a("br"),e._v(" "),a("el-row",[a("el-alert",{attrs:{title:"店员登录地址："+e.login_url,type:"success",closable:!1}})],1),e._v(" "),a("br"),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.userTableData}},[a("el-table-column",{attrs:{label:"姓名",prop:"name"}}),e._v(" "),a("el-table-column",{attrs:{label:"账号",prop:"user.account"}}),e._v(" "),a("el-table-column",{attrs:{label:"编号",prop:"number"}}),e._v(" "),a("el-table-column",{attrs:{label:"电话",prop:"telephones"}}),e._v(" "),a("el-table-column",{attrs:{label:"备注",prop:"note","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{label:"状态",formatter:e.rreezeFormat}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"250"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleEdit(t.$index,t.row,"edit")}}},[e._v("\n                    编辑\n                ")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"warning"},on:{click:function(a){return e.handleResetPwdAlert(t.row)}}},[e._v("\n                  重置密码\n                ")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.handleDeleteAlert(t.row)}}},[e._v("\n                  删除\n                ")]),e._v(" "),t.row.bindOauth?e._e():a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.openBind(t.row)}}},[e._v("\n                  绑定微信\n                ")]),e._v(" "),t.row.bindOauth?a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleDeleteWxBind(t.row)}}},[e._v("\n                  解除微信绑定\n                ")]):e._e()]}}])})],1),e._v(" "),a("div",{staticClass:"Pagination"},[a("el-pagination",{attrs:{"current-page":e.pages.page,"page-size":e.pages.pageSize,layout:"total, prev, pager, next",total:e.pages.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:"微信扫一扫",visible:e.wxDialogVisible},on:{"update:visible":function(t){e.wxDialogVisible=t}}},[a("div",{staticStyle:{width:"100%","text-align":"center"}},[a("img",{attrs:{src:e.qrcodeurl}})]),e._v(" "),a("div",{staticStyle:{width:"100%","text-align":"center"}},[a("span",[e._v("用该店员的微信扫一扫二维码进行微信登录授权/绑定")])]),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.wxDialogVisible=!1}}},[e._v("关闭")])],1)]),e._v(" "),a("el-dialog",{attrs:{title:e.dialog.title,visible:e.dialog.dialogFormVisible,"close-on-click-modal":e.dialog.close},on:{"update:visible":function(t){return e.$set(e.dialog,"dialogFormVisible",t)}}},[a("el-form",{attrs:{model:e.admin}},[0==e.admin.id?a("el-form-item",{attrs:{label:"账号","label-width":"100px"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.admin.account,callback:function(t){e.$set(e.admin,"account",t)},expression:"admin.account"}},[a("template",{slot:"prepend"},[e._v(e._s(e.storePrefix))])],2),e._v(" "),a("br"),e._v(" "),""!=e.admin.account?a("el-alert",{attrs:{title:"帐号为："+e.storePrefix+e.admin.account,type:"success",closable:!1}}):e._e()],1):a("el-form-item",{attrs:{label:"账号","label-width":"100px"}},[e._v("\n                "+e._s(e.admin.account)+"\n              ")]),e._v(" "),0==e.admin.id?a("el-form-item",{attrs:{label:"密码","label-width":"100px"}},[a("span",[e._v("初始密码为：888888")])]):e._e(),e._v(" "),a("el-form-item",{attrs:{label:"姓名","label-width":"100px"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.admin.name,callback:function(t){e.$set(e.admin,"name",t)},expression:"admin.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"编号","label-width":"100px"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.admin.number,callback:function(t){e.$set(e.admin,"number",t)},expression:"admin.number"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"电话","label-width":"100px"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.admin.telephones,callback:function(t){e.$set(e.admin,"telephones",t)},expression:"admin.telephones"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"性别","label-width":"100px"}},[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-text":"男","inactive-text":"女","active-value":"1","inactive-value":"2"},model:{value:e.admin.sex,callback:function(t){e.$set(e.admin,"sex",t)},expression:"admin.sex"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"生日","label-width":"100px"}},[a("el-date-picker",{attrs:{type:"date",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",placeholder:"选择生日"},model:{value:e.admin.birthday,callback:function(t){e.$set(e.admin,"birthday",t)},expression:"admin.birthday"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"状态","label-width":"100px"}},[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-text":"正常","inactive-text":"冻结","active-value":"0","inactive-value":"1"},model:{value:e.admin.isFreeze,callback:function(t){e.$set(e.admin,"isFreeze",t)},expression:"admin.isFreeze"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"备注","label-width":"100px"}},[a("el-input",{attrs:{type:"textarea",rows:"4"},model:{value:e.admin.note,callback:function(t){e.$set(e.admin,"note",t)},expression:"admin.note"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialog.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleSave}},[e._v("确 定")])],1)],1)],1)])},staticRenderFns:[]};var pt=a("VU/8")(ut,gt,!1,function(e){a("eCHU")},null,null).exports,mt={data:function(){return{baseUrl:E,baseImgPath:B,loading:!1,showQr:!1,table:{id:0,name:"",number:"",minPeopleCount:1,maxPeopleCount:1,note:"",storeUserNumber:""},dialog:{dialogFormVisible:!1,title:"新增餐桌",close:!1},pages:{offset:0,pageSize:10,page:1,total:0},tableData:[]}},created:function(){this.initData()},methods:{initData:function(){var e=this;this.loading=!0;var t=this;t.$api.get("/store/tables",t.pages,function(a){if(a.status>=200&&a.status<300){var s=a.data;0==s.code?(t.tableData=s.data.tables.content,e.tableData.forEach(function(e,a){e.qrPic=t.baseUrl+"/common/qrCode?content="+e.qrPic}),t.pages.total=s.data.tables.totalElements):e.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"});e.loading=!1})},handleMinPeopleCountChange:function(e){e>this.table.maxPeopleCount&&(this.table.maxPeopleCount=e)},handleSizeChange:function(e){console.log("每页 "+e+" 条")},handleCurrentChange:function(e){this.pages.page=e,this.pages.offset=(e-1)*this.pages.pageSize,this.initData()},handleEdit:function(e,t,a){"edit"==a?(this.dialog.title="修改餐桌",this.table.id=t.id,this.table.name=t.name,this.table.number=t.number,this.table.note=t.note,this.table.minPeopleCount=t.minPeopleCount,this.table.maxPeopleCount=t.maxPeopleCount,this.table.storeUserNumber=null==t.storeUser?"":t.storeUser.number,this.dialog.dialogFormVisible=!0):"add"==a&&(this.dialog.title="修改餐桌",this.table.id=0,this.table.name="",this.table.number="",this.table.note="",this.table.storeUserNumber="",this.dialog.dialogFormVisible=!0,this.table.minPeopleCount=1,this.table.maxPeopleCount=1)},downloadQrCode:function(){location.href=""},handleSave:function(){var e=this;this.loading=!0;var t=this;t.$api.post("/store/tables",t.table,function(a){if(a.status>=200&&a.status<300){console.log(a.data);var s=a.data;0==s.code?(e.$message({message:t.dialog.title+"成功",type:"success"}),e.dialog.dialogFormVisible=!1,e.initData()):e.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"})}),this.loading=!1},handleDeleteAlert:function(e){var t=this;this.$confirm("此操作将删除该餐桌, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.handleDelete(e)}).catch(function(){})},handleDelete:function(e){var t=this;this.loading=!0;this.$api.delete("/store/tables/"+e.id,null,function(e){if(e.status>=200&&e.status<300){console.log(e.data);var a=e.data;0==a.code?(t.$message({message:"删除成功",type:"success"}),t.loading=!1,t.initData()):t.$message({message:a.msg,type:"warning"})}else t.$message({message:"服务器维护中",type:"error"})})}}},ht={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fillcontain"},[a("div",{staticClass:"table_container"},[a("el-row",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleEdit(0,"","add")}}},[e._v("新增餐桌")]),e._v(" "),a("el-button",{attrs:{type:"warning"},on:{click:function(t){e.showQr=!e.showQr}}},[0==e.showQr?a("span",[e._v("二维码展示")]):a("span",[e._v("列表展示")])])],1),e._v(" "),a("br"),e._v(" "),1==e.showQr?a("el-row",[a("el-alert",{attrs:{title:"可通过浏览器打印当前页面的二维码",type:"success"}})],1):e._e(),e._v(" "),1==e.showQr?a("el-row",e._l(e.tableData,function(t,s){return a("el-col",{key:s,attrs:{span:6}},[a("el-card",{staticStyle:{margin:"5px",height:"320px"}},[a("div",{staticStyle:{"text-align":"center"}},[a("span",[e._v(e._s(t.name))])]),e._v(" "),a("img",{staticClass:"image",attrs:{src:t.qrPic}}),e._v(" "),a("div",{staticStyle:{"text-align":"center"}},[a("span",[e._v(e._s(t.number))])])])],1)}),1):e._e(),e._v(" "),0==e.showQr?a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData}},[a("el-table-column",{attrs:{label:"餐桌名",prop:"name"}}),e._v(" "),a("el-table-column",{attrs:{label:"餐桌编号",prop:"number"}}),e._v(" "),a("el-table-column",{attrs:{label:"uuid",prop:"uuid"}}),e._v(" "),a("el-table-column",{attrs:{label:"备注",prop:"note","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{label:"负责人",prop:"storeUser.name"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleEdit(t.$index,t.row,"edit")}}},[e._v("\n                    编辑\n                ")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.handleDeleteAlert(t.row)}}},[e._v("\n                  删除\n                ")])]}}],null,!1,1015915631)})],1):e._e(),e._v(" "),a("div",{staticClass:"Pagination"},[a("el-pagination",{attrs:{"current-page":e.pages.page,"page-size":e.pages.pageSize,layout:"total, prev, pager, next",total:e.pages.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:e.dialog.title,visible:e.dialog.dialogFormVisible,"close-on-click-modal":e.dialog.close},on:{"update:visible":function(t){return e.$set(e.dialog,"dialogFormVisible",t)}}},[a("el-form",{attrs:{model:e.table}},[a("el-form-item",{attrs:{label:"餐桌名","label-width":"120px"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.table.name,callback:function(t){e.$set(e.table,"name",t)},expression:"table.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"餐桌编号","label-width":"120px"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.table.number,callback:function(t){e.$set(e.table,"number",t)},expression:"table.number"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"最少可坐人数","label-width":"120px"}},[a("el-input-number",{attrs:{min:1,max:1e4},on:{change:e.handleMinPeopleCountChange},model:{value:e.table.minPeopleCount,callback:function(t){e.$set(e.table,"minPeopleCount",t)},expression:"table.minPeopleCount"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"最多可坐人数","label-width":"120px"}},[a("el-input-number",{attrs:{min:e.table.minPeopleCount,max:1e4},model:{value:e.table.maxPeopleCount,callback:function(t){e.$set(e.table,"maxPeopleCount",t)},expression:"table.maxPeopleCount"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"备注","label-width":"100px"}},[a("el-input",{attrs:{type:"textarea",rows:"4"},model:{value:e.table.note,callback:function(t){e.$set(e.table,"note",t)},expression:"table.note"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"负责人","label-width":"120px"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:"输入负责该桌的店员编号"},model:{value:e.table.storeUserNumber,callback:function(t){e.$set(e.table,"storeUserNumber",t)},expression:"table.storeUserNumber"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialog.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleSave}},[e._v("确 定")])],1)],1)],1)])},staticRenderFns:[]};var vt=a("VU/8")(mt,ht,!1,function(e){a("sCHi"),a("7/v3")},null,null).exports,ft={data:function(){return{baseUrl:E,baseImgPath:B,loading:!1,order:{},dialog:{dialogFormVisible:!1,title:"新增餐桌",close:!1},pages:{offset:0,pageSize:10,page:1,total:0,payStatus:0,keyword:"",created_start_time:"",created_end_time:""},orderData:[],status:[{id:0,name:"全部状态"},{id:1,name:"待支付"},{id:2,name:"已支付"},{id:3,name:"已退款"}],choosePrinter:{},choosePrinterDataModels:null,printers:[],printerDialogTableVisible:!1,sureOrder:{order_id:0,status:"2"},sureOrderDialogVisible:!1,sureOrderStatus:[{value:"2",label:"确定为有效订单"},{value:"3",label:"拒绝接受该订单"}]}},created:function(){this.initData()},methods:{initData:function(){var e=this;this.loading=!0;var t=this;t.$api.get("/store/orders",t.pages,function(a){if(a.status>=200&&a.status<300){var s=a.data;0==s.code?(t.orderData=s.data.orders.content,t.pages.total=s.data.orders.totalElements):e.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"});e.loading=!1})},handleSizeChange:function(e){console.log("每页 "+e+" 条")},handleCurrentChange:function(e){this.pages.page=e,this.pages.offset=(e-1)*this.pages.pageSize,this.initData()},handleInfo:function(e){this.$router.push({path:"/store/orderDetail",query:{order_id:e.id}})},handleEditRealPrice:function(e){var t=this,a=this;this.$prompt("请输入实收金额","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(s){var i=s.value;a.$api.put("/store/orders/"+e.id,{real_price:100*i},function(e){if(e.status>=200&&e.status<300){var s=e.data;0==s.code?(t.$message({message:"改价成功",type:"success"}),a.initData()):t.$message({message:s.msg,type:"warning"})}else t.$message({message:"服务器维护中",type:"error"}),t.initData();t.loading=!1})}).catch(function(){})},openChoosePrinter:function(e){var t=this;this.order=e;var a=this;a.$api.get("/store/printer",null,function(e){if(e.status>=200&&e.status<300){var s=e.data;0==s.code?(a.printers=s.data.printers,t.printerDialogTableVisible=!0,t.choosePrinter=null,t.choosePrinterDataModels=null):t.$message({message:s.msg,type:"warning"})}else t.$message({message:"服务器维护中",type:"error"});t.loading=!1})},handlePrinterChange:function(){this.choosePrinterDataModels=null},printOrder:function(){var e=this,t=this;t.$api.put("/store/printer/"+t.choosePrinter.id+"/order/"+this.order.id+"/type/"+this.choosePrinterDataModels.type,null,function(a){if(a.status>=200&&a.status<300){var s=a.data;0==s.code?(e.$message({message:"已加入到打印队列了",type:"success"}),t.printerDialogTableVisible=!1):e.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"});e.loading=!1})},exportExcel:function(){if(""!=this.pages.created_start_time&&""!=this.pages.created_end_time){var e=window.localStorage.access_token;location.href=E+"/store/orders/excel?access_token="+e+"&keyword="+this.pages.keyword+"&status="+this.pages.payStatus+"&created_start_time="+this.pages.created_start_time+"&created_end_time="+this.pages.created_end_time}else this.$message({message:"导出订单请先选择时间区间",type:"warning"})},realPriceFormat:function(e,t){return e.realPrice-e.refundPrice==e.totalPrice?e.realPrice/100+"元":0==e.refundPrice?"实收:"+e.realPrice/100+"元/总价:"+e.totalPrice/100+"元":"实收:"+e.realPrice/100+"元/退款"+e.refundPrice/100+"元/总价:"+e.totalPrice/100+"元"},applyStatusFormat:function(e,t){return 1==e.applyStatus?"待确认":2==e.applyStatus?"已确认":"已拒绝"},handleDeleteAlert:function(e){var t=this;this.$confirm("此操作将删除该订单吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.handleDelete(e)}).catch(function(){})},blacklist:function(e){var t=this;this.loading=!0;var a=this;a.$api.get("/store/blacklist",{user_id:e.createdUser.id},function(s){s.status>=200&&s.status<300?(console.log(s.data),0==s.data.code?t.$confirm("要将该用户移出黑名单吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.$api.delete("/store/blacklist",{user_id:e.createdUser.id},function(e){if(e.status>=200&&e.status<300){console.log(e.data);var a=e.data;0==a.code?t.$message({message:"移出成功,该用户可正常在本店下单",type:"success"}):t.$message({message:a.msg,type:"error"}),t.loading=!1}else t.$message({message:"服务器维护中",type:"error"}),t.loading=!1})}).catch(function(){}):(t.$confirm("要将该用户加入黑名单吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.$api.post("/store/blacklist",{user_id:e.createdUser.id},function(e){if(e.status>=200&&e.status<300){console.log(e.data);var a=e.data;0==a.code?t.$message({message:"加入成功,该用户将无法在本店下单",type:"success"}):t.$message({message:a.msg,type:"error"}),t.loading=!1}else t.$message({message:"服务器维护中",type:"error"}),t.loading=!1})}).catch(function(){}),t.loading=!1)):(t.$message({message:"服务器维护中",type:"error"}),t.loading=!1)})},sureOrderHandlerAlert:function(e){this.sureOrder.id=e.id;1==e.applyStatus||e.applyStatus;this.sureOrder.status=""+e.applyStatus,this.sureOrderDialogVisible=!0},sureOrderHandler:function(){var e=this;this.$api.put("/store/orders/"+this.sureOrder.id+"/status",{applyStatus:this.sureOrder.status},function(t){if(t.status>=200&&t.status<300){var a=t.data;0==a.code?(e.$message({message:"已更新当前订单状态",type:"success"}),e.sureOrderDialogVisible=!1,e.initData()):e.$message({message:a.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"});e.loading=!1})},handleDelete:function(e){var t=this;this.loading=!0;this.$api.delete("/store/orders/"+e.id,null,function(e){if(e.status>=200&&e.status<300){console.log(e.data);var a=e.data;0==a.code?(t.$message({message:"删除成功",type:"success"}),t.initData()):(t.$message({message:a.msg,type:"warning"}),t.loading=!1)}else t.$message({message:"服务器维护中",type:"error"}),t.loading=!1})}}},_t={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fillcontain"},[a("div",{staticClass:"table_container"},[a("el-row",[a("el-col",{attrs:{span:4}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"全部状态"},model:{value:e.pages.payStatus,callback:function(t){e.$set(e.pages,"payStatus",t)},expression:"pages.payStatus"}},e._l(e.status,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入订单号/餐桌号查询"},model:{value:e.pages.keyword,callback:function(t){e.$set(e.pages,"keyword",t)},expression:"pages.keyword"}})],1),e._v(" "),a("el-col",{attrs:{span:10}},[a("el-date-picker",{attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"开始时间"},model:{value:e.pages.created_start_time,callback:function(t){e.$set(e.pages,"created_start_time",t)},expression:"pages.created_start_time"}}),e._v(" "),a("el-date-picker",{attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"结束时间"},model:{value:e.pages.created_end_time,callback:function(t){e.$set(e.pages,"created_end_time",t)},expression:"pages.created_end_time"}})],1),e._v(" "),a("el-col",{attrs:{span:2}},[a("el-button",{on:{click:e.initData}},[e._v("搜索")])],1)],1),e._v(" "),a("br"),e._v(" "),a("el-row",[a("el-col",{attrs:{span:3}},[a("el-button",{attrs:{type:"primary"},on:{click:e.exportExcel}},[e._v("导出订单")])],1)],1),e._v(" "),a("br"),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.orderData}},[a("el-table-column",{attrs:{label:"订单号",prop:"orderNo"}}),e._v(" "),a("el-table-column",{attrs:{label:"类型"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.type?a("span",[e._v("\n                点餐,餐桌号:"+e._s(t.row.tableNumber)+"\n              ")]):a("span",[e._v("\n                余额充值\n              ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"三方订单号",prop:"outOrderNo"}}),e._v(" "),a("el-table-column",{attrs:{label:"支付状态",prop:"payStatusStr"}}),e._v(" "),a("el-table-column",{attrs:{label:"确单状态",formatter:e.applyStatusFormat}}),e._v(" "),a("el-table-column",{attrs:{label:"金额(￥)",formatter:e.realPriceFormat}}),e._v(" "),a("el-table-column",{attrs:{label:"创建者","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.blacklist(t.row)}}},[e._v("\n                "+e._s(t.row.createdUser.account)+"\n              ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"220"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleInfo(t.row)}}},[e._v("\n                  详情\n                ")]),e._v(" "),1==t.row.payStatus?a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.sureOrderHandlerAlert(t.row)}}},[e._v("\n                  确单\n                ")]):e._e(),e._v(" "),1==t.row.payStatus&&3!=t.row.applyStatus?a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleEditRealPrice(t.row)}}},[e._v("\n                  改价\n                ")]):e._e(),e._v(" "),3!=t.row.applyStatus?a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.openChoosePrinter(t.row)}}},[e._v("\n                    打印\n                ")]):e._e(),e._v(" "),2!=t.row.payStatus?a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.handleDeleteAlert(t.row)}}},[e._v("\n                  删除\n                ")]):e._e()]}}])})],1),e._v(" "),a("div",{staticClass:"Pagination"},[a("el-pagination",{attrs:{"current-page":e.pages.page,"page-size":e.pages.pageSize,layout:"total, prev, pager, next",total:e.pages.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:"打印",visible:e.printerDialogTableVisible},on:{"update:visible":function(t){e.printerDialogTableVisible=t}}},[a("el-divider",{attrs:{"content-position":"left"}},[e._v("打印机")]),e._v(" "),e.printers.length>0?a("div",e._l(e.printers,function(t,s){return a("el-radio",{key:s,attrs:{label:t,border:""},on:{change:e.handlePrinterChange},model:{value:e.choosePrinter,callback:function(t){e.choosePrinter=t},expression:"choosePrinter"}},[e._v(e._s(t.name))])}),1):a("div",[e._v("\n          暂无打印机\n        ")]),e._v(" "),a("el-divider",{attrs:{"content-position":"left"}},[e._v("打印模板")]),e._v(" "),null!=e.choosePrinter&&null!=e.choosePrinter.printerDataModels?a("div",e._l(e.choosePrinter.printerDataModels,function(t,s){return a("el-radio",{key:s,attrs:{label:t,border:""},model:{value:e.choosePrinterDataModels,callback:function(t){e.choosePrinterDataModels=t},expression:"choosePrinterDataModels"}},[e._v(e._s(t.name))])}),1):a("div",[e._v("\n          暂无打印模板\n        ")]),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.printerDialogTableVisible=!1}}},[e._v("取 消")]),e._v(" "),null!=e.choosePrinter&&null!=e.choosePrinterDataModels?a("el-button",{attrs:{type:"primary"},on:{click:e.printOrder}},[e._v("确 定")]):e._e()],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"确认订单",visible:e.sureOrderDialogVisible,width:"30%"},on:{"update:visible":function(t){e.sureOrderDialogVisible=t}}},[a("span",[e._v("为防止恶意刷单，请确认当前订单是否有效,如发现有人恶意刷单，可点击列表中的【创建者】的帐号将其加入黑名单")]),e._v(" "),a("br"),e._v(" "),a("br"),e._v(" "),a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.sureOrder.status,callback:function(t){e.$set(e.sureOrder,"status",t)},expression:"sureOrder.status"}},e._l(e.sureOrderStatus,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.sureOrderDialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.sureOrderHandler}},[e._v("确 定")])],1)],1)],1)])},staticRenderFns:[]};var bt=a("VU/8")(ft,_t,!1,function(e){a("LQZ3")},null,null).exports,yt={data:function(){return{baseUrl:E,baseImgPath:B,loading:!1,settings:[]}},created:function(){this.initData()},methods:{initData:function(){var e=this;this.loading=!0;var t=this;t.$api.get("/store/setting",null,function(a){if(a.status>=200&&a.status<300){var s=a.data;0==s.code?t.settings=s.data.settings:e.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"});e.loading=!1})},save:function(e,t){var a=this;this.loading=!0;this.$api.put("/store/setting/"+e,{value:t},function(e){if(e.status>=200&&e.status<300){console.log(e.data);var t=e.data;0==t.code?a.$message({message:"修改成功",type:"success"}):a.$message({message:t.msg,type:"warning"})}else a.$message({message:"服务器维护中",type:"error"})}),this.loading=!1}}},wt={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fillcontain"},[a("div",{staticClass:"table_container"},e._l(e.settings,function(t,s){return a("el-row",{key:s},[a("el-col",[a("span",[e._v(e._s(t.name))]),e._v(" "),1==t.type?a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-text":t.settingParams[0].name,"inactive-text":t.settingParams[1].name,"active-value":t.settingParams[0].value,"inactive-value":t.settingParams[1].value},on:{change:function(a){return e.save(t.valueKey,t.valueStr)}},model:{value:t.valueStr,callback:function(a){e.$set(t,"valueStr",a)},expression:"item.valueStr"}}):e._e(),e._v(" "),a("el-alert",{attrs:{title:t.note,type:"success"}}),e._v(" "),a("br")],1)],1)}),1)])},staticRenderFns:[]};var $t=a("VU/8")(yt,wt,!1,function(e){a("HagG")},null,null).exports,kt={data:function(){return{baseUrl:E,baseImgPath:B,uploadUrl:E+"/common/imageUpload",loading:!1,order_id:0,order:{id:0,number:"",createTimeStr:"",payTime:"",payTimeStr:""},goodsData:[],totalPrice:0,keyword:"",chooseOrderGoods:{},noteDialogTableVisible:!1,paymentConfigs:[],payTypeDialog:!1,token:null}},created:function(){var e=window.localStorage;this.token=e.access_token,this.order_id=this.$route.query.order_id,this.initData()},methods:{initData:function(){var e=this;this.loading=!0;var t=this;t.$api.get("/store/orders",{order_id:this.order_id},function(a){if(a.status>=200&&a.status<300){var s=a.data;0==s.code?(t.order=s.data.orders.content[0],t.order.createTimeStr=e.dateTimeFormat(t.order.createTime),null!=t.order.payTime&&""!=t.order.payTime&&(t.order.payTimeStr=e.dateTimeFormat(t.order.payTime)),t.initGoodsData()):e.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"});e.loading=!1})},initGoodsData:function(){var e=this;this.loading=!0;var t=this;t.$api.get("/store/orders/orderGoods",{order_id:t.order.id},function(a){if(a.status>=200&&a.status<300){var s=a.data;0==s.code?(t.goodsData=s.data.orderGoods,t.totalPrice=0,t.goodsData.forEach(function(e,a){t.totalPrice+=e.goods.sell_price*e.count})):e.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"});e.loading=!1})},handleRefundAlert:function(e){var t=this,a=this;this.$prompt("注意：本操作将退款该菜品(payjs支付不支持单个商品的退款，会将该订单所有商品都退款)请谨慎操作","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputPlaceholder:"请输入退款原因"}).then(function(s){var i=s.value;""==i.trim()?a.$message({message:"退款失败,退款原因不能为空",type:"error"}):t.handleRefund(e,i)}).catch(function(){})},handleRefund:function(e,t){var a=this;this.loading=!0;this.$api.put("/store/orders/order_goods/"+e.id+"/refund",{note:t},function(e){if(e.status>=200&&e.status<300){console.log(e.data);var t=e.data;0==t.code?(a.$message({message:"退款成功",type:"success"}),a.initData()):a.$message({message:t.msg,type:"warning"}),a.loading=!1}else a.$message({message:"服务器维护中",type:"error"}),a.loading=!1})},handleRefundOrderAlert:function(e){var t=this,a=this;this.$prompt("本操作将退款该订单,请谨慎操作","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputPlaceholder:"请输入退款原因"}).then(function(s){var i=s.value;""==i.trim()?a.$message({message:"退款失败,退款原因不能为空",type:"error"}):t.handleRefundOrder(e,i)}).catch(function(){})},handleRefundOrder:function(e,t){var a=this;this.loading=!0;this.$api.put("/store/orders/"+e.id+"/refund",{note:t},function(e){if(e.status>=200&&e.status<300){console.log(e.data);var t=e.data;0==t.code?(a.$message({message:"退款成功",type:"success"}),a.initData()):a.$message({message:t.msg,type:"warning"}),a.loading=!1}else a.$message({message:"服务器维护中",type:"error"}),a.loading=!1})},statusFormat:function(e,t){return 2==e.payStatus?"已退款":"正常"},markerPriceFormat:function(e,t){return e.goods.marker_price/100},sellPriceFormat:function(e,t){return e.goods.sell_price/100},totalPriceFormat:function(e,t){return e.goods.sell_price/100},handlePayAlert:function(e){var t=this;this.$confirm("确定是要手动支付吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.loading=!0,t.$api.put("/store/orders/"+e.id+"/pay",null,function(e){if(e.status>=200&&e.status<300){var a=e.data;0==a.code?(t.$message({message:"支付成功",type:"success"}),t.initData()):(t.$message({message:a.msg,type:"warning"}),t.loading=!1)}else t.$message({message:"服务器维护中",type:"error"}),t.loading=!1})}).catch(function(){})},handleOnlinePayAlert:function(e){var t=this;this.order=e,this.loading=!0;var a=this;a.$api.get("/store/payment_config/can_used",null,function(e){if(e.status>=200&&e.status<300){var s=e.data;0==s.code&&(a.payTypeDialog=!0,a.paymentConfigs=s.data.paymentsConfigs,console.log(e))}t.loading=!1})},closePayPop:function(){this.payTypeDialog=!1,this.initData()},dateTimeFormat:function(e){var t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-"+(t.getDate()<10?"0"+t.getDate():t.getDate())+" "+(t.getHours()<10?"0"+t.getHours():t.getHours())+":"+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+":"+(t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds())},in_array:function(e,t){for(var a in t)if(t[a]==e)return!0;return!1}}},xt={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fillcontain"},[a("div",{staticClass:"table_container"},[a("el-divider",{attrs:{"content-position":"left"}},[e._v("订单信息")]),e._v(" "),a("el-row",[a("el-col",{attrs:{span:2}},[e._v("订单号")]),a("el-col",{attrs:{span:4}},[e._v(e._s(e.order.orderNo))]),e._v(" "),a("el-col",{attrs:{span:2}},[e._v("创建时间")]),a("el-col",{attrs:{span:4}},[e._v(e._s(e.order.createTimeStr))]),e._v(" "),a("el-col",{attrs:{span:2}},[e._v("创建者帐号")]),a("el-col",{attrs:{span:4}},[e._v(e._s(e.order.createdUser.account))])],1),e._v(" "),a("br"),e._v(" "),a("el-row",[a("el-col",{attrs:{span:2}},[e._v("类型")]),a("el-col",{attrs:{span:4}},[1==e.order.type?a("span",[e._v("\n            点餐,餐桌号:"+e._s(e.order.tableNumber)+"\n          ")]):a("span",[e._v("\n            余额充值\n          ")])]),e._v(" "),a("el-col",{attrs:{span:2}},[e._v("确认状态")]),a("el-col",{attrs:{span:4}},[e._v(e._s(e.order.applyStatusStr))]),e._v(" "),a("el-col",{attrs:{span:2}},[e._v("就餐人数")]),a("el-col",{attrs:{span:4}},[e._v(e._s(e.order.peopleNum))])],1),e._v(" "),a("br"),e._v(" "),a("el-row",[a("el-col",[e._v("备注: "+e._s(e.order.note))])],1),e._v(" "),a("el-divider",{attrs:{"content-position":"left"}},[e._v("支付信息")]),e._v(" "),a("el-row",[a("el-col",{attrs:{span:3}},[e._v("总金额（￥）")]),a("el-col",{attrs:{span:4}},[e._v(" "+e._s(e.order.totalPrice/100)+"元")]),e._v(" "),a("el-col",{attrs:{span:3}},[e._v("实付金额（￥）")]),a("el-col",{attrs:{span:4}},[e._v(e._s(e.order.realPrice/100)+"元")])],1),e._v(" "),a("br"),e._v(" "),a("el-row",[a("el-col",{attrs:{span:2}},[e._v("\n            支付状态")]),a("el-col",{attrs:{span:4}},[e._v(" "+e._s(e.order.payStatusStr)),3==e.order.applyStatus?a("span",[e._v("(确单状态为拒绝，无法支付)")]):e._e(),e._v(" "),3==e.order.payStatus||4==e.order.payStatus?a("span",[e._v("退款原因:"+e._s(e.order.refundNote))]):e._e()]),e._v(" "),1==e.order.payStatus&&3!=e.order.applyStatus?a("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.handlePayAlert(e.order)}}},[e._v("\n            手动支付\n          ")]):e._e(),e._v(" "),1==e.order.payStatus&&3!=e.order.applyStatus?a("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.handleOnlinePayAlert(e.order)}}},[e._v("\n            在线支付\n          ")]):e._e(),e._v(" "),e.order.payStatus>1?a("el-col",{attrs:{span:2}},[e._v("支付时间")]):e._e(),e.order.payStatus>1?a("el-col",{attrs:{span:4}},[e._v(" "+e._s(e.order.payTimeStr))]):e._e(),e._v(" "),e.order.payStatus>1?a("el-col",{attrs:{span:2}},[e._v("支付方式")]):e._e(),e.order.payStatus>1?a("el-col",{attrs:{span:4}},[e._v(e._s(e.order.payTypeStr)),2==e.order.payStatus?a("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.handleRefundOrderAlert(e.order)}}},[e._v("全订单退款")]):e._e()],1):e._e(),e._v(" "),e.order.payStatus>1?a("el-col",{attrs:{span:2}},[e._v("支付者帐号")]):e._e(),e.order.payStatus>1?a("el-col",{attrs:{span:4}},[e._v(e._s(e.order.payUser.account))]):e._e()],1),e._v(" "),a("br"),e._v(" "),a("br"),e._v(" "),1==e.order.type?a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.goodsData}},[a("el-table-column",{attrs:{label:"菜名",prop:"goodsName"}}),e._v(" "),a("el-table-column",{attrs:{label:"编号",prop:"goods.number"}}),e._v(" "),a("el-table-column",{attrs:{label:"市场价",formatter:e.markerPriceFormat}}),e._v(" "),a("el-table-column",{attrs:{label:"销售价",formatter:e.sellPriceFormat}}),e._v(" "),a("el-table-column",{attrs:{label:"数量",prop:"count"}}),e._v(" "),a("el-table-column",{attrs:{label:"备注",prop:"note","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{label:"状态",formatter:e.statusFormat}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[2!=e.order.payStatus&&3!=e.order.payStatus||1!=t.row.payStatus?e._e():a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleRefundAlert(t.row)}}},[e._v("\n              退款\n            ")])]}}],null,!1,3546810484)})],1):e._e(),e._v(" "),a("el-dialog",{attrs:{title:"订单支付",visible:e.payTypeDialog,width:"90%","show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.payTypeDialog=t}}},[0==e.paymentConfigs.length?a("p",{staticStyle:{"font-size":"30px"}},[a("span",[e._v("没有可用的在线支付方式,请使用手动支付")])]):a("p",e._l(e.paymentConfigs,function(t,s){return a("a",{key:s,attrs:{href:e.baseUrl+"/payment/pay/"+t.id+"?order_id="+e.order.id+"&token="+e.token,target:"_blank"}},[a("el-button",{attrs:{type:"success"}},[e._v(e._s(t.name))])],1)}),0),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.closePayPop()}}},[e._v("关  闭")])],1)])],1)])},staticRenderFns:[]};var St=a("VU/8")(kt,xt,!1,function(e){a("PYJd")},null,null).exports,Dt={data:function(){return{baseUrl:E,baseImgPath:B,loading:!1,tableData:[],chooseId:""}},created:function(){this.initData()},methods:{initData:function(){var e=this;this.loading=!0;var t=this;t.$api.get("/store/consumer_view_config",null,function(a){if(a.status>=200&&a.status<300){var s=a.data;0==s.code?(t.tableData=s.data.consumerViews,t.chooseId=s.data.usedPageViewId,e.tableData.forEach(function(e,a){e.picPath=t.baseImgPath+"/"+e.picPath})):e.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"});e.loading=!1})},choosePage:function(e){var t=this;this.loading=!0;var a=this;a.$api.put("/store/consumer_view_config/"+e.id,null,function(e){if(e.status>=200&&e.status<300){var s=e.data;0==s.code?a.initData():t.$message({message:s.msg,type:"warning"})}else t.$message({message:"服务器维护中",type:"error"});t.loading=!1})},goBuy:function(e){this.$router.push({path:"/store/pluginsStore",query:{uuid:e.uuid}})},statusFormat:function(e,t){return 2==e.status?"使用中":"未使用"}}},Ct={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fillcontain"},[a("div",{staticClass:"table_container"},[a("el-row",e._l(e.tableData,function(t,s){return a("el-col",{key:s,attrs:{span:6}},[a("el-card",{staticStyle:{margin:"5px",height:"350px"}},[a("img",{staticClass:"image",attrs:{src:"https://shadow.elemecdn.com/app/element/hamburger.9cf7b091-55e9-11e9-a976-7f4d0b07eef6.png"}}),e._v(" "),a("div",{staticStyle:{padding:"14px"}},[a("span",[e._v(e._s(t.name))]),e._v(" "),a("div",{staticClass:"bottom clearfix"},[a("time",{staticClass:"time"},[e._v("免费\n                    (\n                    "),4==t.status?a("span",{staticStyle:{color:"green"}},[e._v("\n                    "+e._s(t.statusStr)+"\n                    ")]):2==t.status?a("span",{staticStyle:{color:"blueviolet"}},[e._v("\n                    "+e._s(t.statusStr)+"\n                    ")]):a("span",{staticStyle:{color:"red"}},[e._v("\n                    "+e._s(t.statusStr)+"\n                    ")]),e._v("\n                    )\n                  ")]),e._v(" "),4==t.status?a("el-button",{staticClass:"button",attrs:{type:"text"}},[a("el-radio",{attrs:{label:t.id},on:{change:function(a){return e.choosePage(t)}},model:{value:e.chooseId,callback:function(t){e.chooseId=t},expression:"chooseId"}},[t.id==e.chooseId?a("span",[e._v("使用中")]):a("span",[e._v("未使用")])])],1):e._e(),e._v(" "),1==t.status?a("el-button",{staticClass:"button",attrs:{type:"danger"},on:{click:function(a){return e.goBuy(t)}}},[e._v("\n                    购买\n                  ")]):e._e(),e._v(" "),3==t.status?a("el-button",{staticClass:"button",attrs:{type:"danger"},on:{click:function(a){return e.goBuy(t)}}},[e._v("\n                    购买\n                  ")]):e._e()],1)])])],1)}),1)],1)])},staticRenderFns:[]};var Ft=a("VU/8")(Dt,Ct,!1,function(e){a("HLrs"),a("qywH")},null,null).exports,Tt={data:function(){return{baseUrl:E,baseImgPath:B,uploadUrl:E+"/common/imageUpload",loading:!1,plugin:{uuid:0,name:"",day:0,vip0Price:0,vip1Price:0,count:1},dialog:{dialogFormVisible:!1,title:"购买插件",close:!1},pluginsTypes:[],plugins:[]}},created:function(){var e=window.localStorage;this.token=e.access_token,this.initData()},methods:{initData:function(){var e=this;this.loading=!0;var t=this;t.$api.get("/store/plugins",t.pages,function(a){if(a.status>=200&&a.status<300){var s=a.data;0==s.code?(t.pluginsTypes=s.data.pluginsTypes,t.plugins=s.data.plugins):e.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"});e.loading=!1})},dayFormat:function(e,t){return 0==e.day?"永久":e.day+"天"},vip0PriceFormat:function(e,t){return e.vip0Price/100},vip1PriceFormat:function(e,t){return e.vip1Price/100},vip2PriceFormat:function(e,t){return e.vip2Price/100},buy:function(e,t,a){this.plugin.uuid=t.uuid,this.plugin.name=t.name,this.plugin.day=t.day,this.plugin.price=t.price/100,this.plugin.vip0Price=t.vip0Price/100,this.plugin.vip1Price=t.vip1Price/100,this.plugin.vip2Price=t.vip2Price/100,this.plugin.count=1,this.dialog.dialogFormVisible=!0}}},Pt={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fillcontain"},[a("div",{staticClass:"table_container"},[a("br"),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.pluginsTypes}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.plugins[t.row.type]}},[a("el-table-column",{attrs:{label:"插件名",prop:"name"}}),e._v(" "),a("el-table-column",{attrs:{label:"价格",formatter:e.vip0PriceFormat}}),e._v(" "),a("el-table-column",{attrs:{label:"年费会员价",formatter:e.vip1PriceFormat}}),e._v(" "),a("el-table-column",{attrs:{label:"有效期",formatter:e.dayFormat}}),e._v(" "),a("el-table-column",{attrs:{label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.status?a("span",{staticStyle:{color:"red"}},[e._v("未购买")]):2==t.row.status?a("span",{staticStyle:{color:"green"}},[e._v("\n                    已购买(生效时间:"+e._s(t.row.startTime)+")\n                  ")]):3==t.row.status?a("span",{staticStyle:{color:"red"}},[e._v("已过期:"+e._s(t.row.endTime))]):4==t.row.status?a("span",{staticStyle:{color:"green"}},[t.row.test?a("span",{staticStyle:{color:"red"}},[e._v("试用中")]):a("span",{staticStyle:{color:"green"}},[e._v("已生效")]),t.row.day>0?a("span",[e._v("("+e._s(t.row.endTime)+")")]):e._e()]):e._e()]}}],null,!0)}),e._v(" "),a("el-table-column",{attrs:{label:"备注","show-overflow-tooltip":!0,prop:"note"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[1==t.row.status||3==t.row.status?a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.buy(t.$index,t.row,"edit")}}},[e._v("\n                      购买\n                    ")]):(2==t.row.status||4==t.row.status)&&t.row.day>0?a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.buy(t.$index,t.row,"edit")}}},[e._v("\n                      延期\n                    ")]):e._e()],1)]}}],null,!0)})],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"插件"}})],1),e._v(" "),a("el-dialog",{attrs:{title:e.dialog.title,visible:e.dialog.dialogFormVisible,"close-on-click-modal":e.dialog.close},on:{"update:visible":function(t){return e.$set(e.dialog,"dialogFormVisible",t)}}},[a("el-form",{attrs:{model:e.plugin}},[a("el-form-item",{attrs:{label:"插件名","label-width":"80px"}},[e._v("\n                    "+e._s(e.plugin.name)+"\n                ")]),e._v(" "),a("el-form-item",{attrs:{label:"价格","label-width":"80px"}},[e._v("\n                "+e._s(e.plugin.price)+"元\n              ")]),e._v(" "),a("el-form-item",{attrs:{label:"有效期","label-width":"80px"}},[0==e.plugin.day?a("span",[e._v("永久")]):a("span",[e._v(e._s(e.plugin.day*e.plugin.count)+"天")])]),e._v(" "),e.plugin.day>0?a("el-form-item",{attrs:{label:"数量","label-width":"80px"}},[a("el-input-number",{attrs:{min:1,max:1e4},model:{value:e.plugin.count,callback:function(t){e.$set(e.plugin,"count",t)},expression:"plugin.count"}})],1):e._e()],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialog.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),a("a",{attrs:{href:e.baseUrl+"/payment/plugins/"+e.plugin.uuid+"?token="+e.token+"&count="+e.plugin.count,target:"_blank"}},[a("el-button",{attrs:{type:"primary"}},[e._v("确定购买")])],1)],1)],1)],1)])},staticRenderFns:[]};var Vt=a("VU/8")(Tt,Pt,!1,function(e){a("T2+6")},null,null).exports,zt={data:function(){return{baseUrl:E,baseImgPath:B,loading:!1,call_tag:{id:0,content:"",status:"1"},dialog:{dialogFormVisible:!1,title:"新增呼叫标签",close:!1},pages:{offset:0,pageSize:10,page:1,total:0},tableData:[]}},created:function(){this.initData()},methods:{initData:function(){var e=this;this.loading=!0;var t=this;t.$api.get("/store/call_tag",t.pages,function(a){if(a.status>=200&&a.status<300){var s=a.data;0==s.code?(t.tableData=s.data.call_tags.content,t.pages.total=s.data.call_tags.totalElements):e.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"});e.loading=!1})},handleSizeChange:function(e){console.log("每页 "+e+" 条")},handleCurrentChange:function(e){this.pages.page=e,this.pages.offset=(e-1)*this.pages.pageSize,this.initData()},statusFormat:function(e,t){return 2==e.status?"上架":"下架"},handleEdit:function(e,t,a){"edit"==a?(this.dialog.title="修改标签",this.call_tag.id=t.id,this.call_tag.content=t.content,this.call_tag.status=""+t.status,this.dialog.dialogFormVisible=!0):"add"==a&&(this.dialog.title="增加标签",this.call_tag.id=0,this.call_tag.content="",this.call_tag.status="1",this.dialog.dialogFormVisible=!0)},handleSave:function(){var e=this;this.loading=!0;var t=this;t.$api.post("/store/call_tag",t.call_tag,function(a){if(a.status>=200&&a.status<300){console.log(a.data);var s=a.data;0==s.code?(e.$message({message:t.dialog.title+"成功",type:"success"}),e.dialog.dialogFormVisible=!1,e.initData()):e.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"})}),this.loading=!1},handleDeleteAlert:function(e){var t=this;this.$confirm("此操作将删除该菜品标签, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.handleDelete(e)}).catch(function(){})},handleDelete:function(e){var t=this;this.loading=!0;this.$api.delete("/store/call_tag/"+e.id,null,function(e){if(e.status>=200&&e.status<300){console.log(e.data);var a=e.data;0==a.code?(t.$message({message:"删除成功",type:"success"}),t.loading=!1,t.initData()):t.$message({message:a.msg,type:"warning"})}else t.$message({message:"服务器维护中",type:"error"})})}}},Ut={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fillcontain"},[a("div",{staticClass:"table_container"},[a("el-row",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleEdit(0,"","add")}}},[e._v("新增标签")])],1),e._v(" "),a("br"),e._v(" "),a("el-alert",{attrs:{title:"客人可通过标签快速呼叫服务员",type:"success"}}),e._v(" "),a("br"),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData}},[a("el-table-column",{attrs:{label:"标签内容",prop:"content"}}),e._v(" "),a("el-table-column",{attrs:{label:"状态",formatter:e.statusFormat}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleEdit(t.$index,t.row,"edit")}}},[e._v("\n                    编辑\n                ")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.handleDeleteAlert(t.row)}}},[e._v("\n                  删除\n                ")])]}}])})],1),e._v(" "),a("div",{staticClass:"Pagination"},[a("el-pagination",{attrs:{"current-page":e.pages.page,"page-size":e.pages.pageSize,layout:"total, prev, pager, next",total:e.pages.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:e.dialog.title,visible:e.dialog.dialogFormVisible,"close-on-click-modal":e.dialog.close},on:{"update:visible":function(t){return e.$set(e.dialog,"dialogFormVisible",t)}}},[a("el-form",{attrs:{model:e.call_tag}},[a("el-form-item",{attrs:{label:"标签内容","label-width":"100px"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.call_tag.content,callback:function(t){e.$set(e.call_tag,"content",t)},expression:"call_tag.content"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"状态","label-width":"80px"}},[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-text":"上线","inactive-text":"下线","active-value":"2","inactive-value":"1"},model:{value:e.call_tag.status,callback:function(t){e.$set(e.call_tag,"status",t)},expression:"call_tag.status"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialog.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleSave}},[e._v("确 定")])],1)],1)],1)])},staticRenderFns:[]};var Et=a("VU/8")(zt,Ut,!1,function(e){a("plYR")},null,null).exports,Bt={data:function(){return{baseUrl:E,baseImgPath:B,loading:!1,call_tag:{id:0,content:"",status:"1"},dialog:{dialogFormVisible:!1,title:"新增呼叫标签",close:!1},pages:{offset:0,pageSize:10,page:1,total:0},tableData:[],plugin_msg:null}},created:function(){this.initData()},methods:{initData:function(){var e=this;this.loading=!0;var t=this;t.$api.get("/store/call_log",t.pages,function(a){if(a.status>=200&&a.status<300){var s=a.data;0==s.code?(t.tableData=s.data.callLogs.content,t.plugin_msg=s.data.plugin_msg,t.pages.total=s.data.callLogs.totalElements):e.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"});e.loading=!1})},handleSizeChange:function(e){console.log("每页 "+e+" 条")},handleCurrentChange:function(e){this.pages.page=e,this.pages.offset=(e-1)*this.pages.pageSize,this.initData()},statusFormat:function(e,t){return 2==e.status?"已处理":"未处理"},push:function(e){var t=this;this.loading=!0;this.$api.put("/store/call_log/"+e.id+"/push",null,function(e){if(e.status>=200&&e.status<300){console.log(e.data);var a=e.data;0==a.code?t.$message({message:"重推成功",type:"success"}):t.$message({message:a.msg,type:"warning"})}else t.$message({message:"服务器维护中",type:"error"})}),this.loading=!1},handleStatusAlert:function(e){var t=this;this.$confirm("此操作将该呼叫记录修改为已处理, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.handleStatus(e)}).catch(function(){})},handleStatus:function(e){var t=this;this.loading=!0;this.$api.put("/store/call_log/"+e.id,{status:2},function(e){if(e.status>=200&&e.status<300){console.log(e.data);var a=e.data;0==a.code?(t.$message({message:"处理成功",type:"success"}),t.loading=!1,t.initData()):t.$message({message:a.msg,type:"warning"})}else t.$message({message:"服务器维护中",type:"error"})})}}},Nt={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fillcontain"},[a("div",{staticClass:"table_container"},[null!=e.plugin_msg?a("el-row",[a("el-alert",{attrs:{title:e.plugin_msg,type:"error"}})],1):e._e(),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData}},[a("el-table-column",{attrs:{label:"桌号",prop:"tables.number"}}),e._v(" "),a("el-table-column",{attrs:{label:"呼叫内容",prop:"content"}}),e._v(" "),a("el-table-column",{attrs:{label:"状态",formatter:e.statusFormat}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.status?a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.push(t.row)}}},[e._v("\n                  重推给负责人\n              ")]):e._e(),e._v(" "),1==t.row.status?a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleStatusAlert(t.row)}}},[e._v("\n                处理\n              ")]):e._e()]}}])})],1),e._v(" "),a("div",{staticClass:"Pagination"},[a("el-pagination",{attrs:{"current-page":e.pages.page,"page-size":e.pages.pageSize,layout:"total, prev, pager, next",total:e.pages.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)])},staticRenderFns:[]};var Mt=a("VU/8")(Bt,Nt,!1,function(e){a("oTwl")},null,null).exports,Ot={data:function(){return{baseUrl:E,baseImgPath:B,loading:!1,showAddBtn:!0,charge_item:{id:0,chargePrice:"",totalPrice:"",tag:"",status:"1"},dialog:{dialogFormVisible:!1,title:"新增充值项",close:!1},pages:{offset:0,pageSize:10,page:1,total:0},tableData:[],plugin_msg:null}},created:function(){this.initData()},methods:{initData:function(){var e=this;this.loading=!0;var t=this;t.$api.get("/store/charge_item",t.pages,function(a){if(a.status>=200&&a.status<300){var s=a.data;0==s.code?(t.tableData=s.data.charge_items.content,t.plugin_msg=s.data.plugin_msg,t.pages.total=s.data.charge_items.totalElements):(e.showAddBtn=!1,e.$message({message:s.msg,type:"warning"}))}else e.showAddBtn=!1,e.$message({message:"服务器维护中",type:"error"});e.loading=!1})},handleSizeChange:function(e){console.log("每页 "+e+" 条")},handleCurrentChange:function(e){this.pages.page=e,this.pages.offset=(e-1)*this.pages.pageSize,this.initData()},statusFormat:function(e,t){return 2==e.status?"上架":"下架"},handleEdit:function(e,t,a){"edit"==a?(this.dialog.title="修改充值项",this.charge_item.id=t.id,this.charge_item.chargePrice=t.chargePrice,this.charge_item.totalPrice=t.totalPrice,this.charge_item.tag=t.tag,this.charge_item.status=""+t.status,this.dialog.dialogFormVisible=!0):"add"==a&&(this.dialog.title="增加充值项",this.charge_item.id=0,this.charge_item.chargePrice="",this.charge_item.totalPrice="",this.charge_item.tag="",this.charge_item.status="1",this.dialog.dialogFormVisible=!0)},handleSave:function(){var e=this;this.loading=!0;var t=this;t.$api.post("/store/charge_item",t.charge_item,function(a){if(a.status>=200&&a.status<300){console.log(a.data);var s=a.data;0==s.code?(e.$message({message:t.dialog.title+"成功",type:"success"}),e.dialog.dialogFormVisible=!1,e.initData()):e.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"})}),this.loading=!1},handleDeleteAlert:function(e){var t=this;this.$confirm("此操作将删除该菜品标签, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.handleDelete(e)}).catch(function(){})},handleDelete:function(e){var t=this;this.loading=!0;this.$api.delete("/store/charge_item/"+e.id,null,function(e){if(e.status>=200&&e.status<300){console.log(e.data);var a=e.data;0==a.code?(t.$message({message:"删除成功",type:"success"}),t.loading=!1,t.initData()):t.$message({message:a.msg,type:"warning"})}else t.$message({message:"服务器维护中",type:"error"})})}}},Rt={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fillcontain"},[a("div",{staticClass:"table_container"},[null!=e.plugin_msg?a("el-row",[a("el-alert",{attrs:{title:e.plugin_msg,type:"error"}})],1):e._e(),e._v(" "),a("br"),e._v(" "),a("el-row",[a("el-alert",{attrs:{title:"客人可在移动端直接进行充值获得赠送金额",type:"success"}})],1),e._v(" "),a("br"),e._v(" "),e.showAddBtn?a("el-row",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleEdit(0,"","add")}}},[e._v("新增充值项")])],1):e._e(),e._v(" "),a("br"),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData}},[a("el-table-column",{attrs:{label:"充值金额",prop:"chargePrice"}}),e._v(" "),a("el-table-column",{attrs:{label:"得到金额",prop:"totalPrice"}}),e._v(" "),a("el-table-column",{attrs:{label:"标签",prop:"tag"}}),e._v(" "),a("el-table-column",{attrs:{label:"状态",formatter:e.statusFormat}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleEdit(t.$index,t.row,"edit")}}},[e._v("\n            编辑\n          ")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.handleDeleteAlert(t.row)}}},[e._v("\n            删除\n          ")])]}}])})],1),e._v(" "),a("div",{staticClass:"Pagination"},[a("el-pagination",{attrs:{"current-page":e.pages.page,"page-size":e.pages.pageSize,layout:"total, prev, pager, next",total:e.pages.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:e.dialog.title,visible:e.dialog.dialogFormVisible,"close-on-click-modal":e.dialog.close},on:{"update:visible":function(t){return e.$set(e.dialog,"dialogFormVisible",t)}}},[a("el-form",{attrs:{model:e.charge_item}},[a("el-form-item",{attrs:{label:"充值金额","label-width":"100px"}},[a("el-input-number",{attrs:{"auto-complete":"off",min:1},model:{value:e.charge_item.chargePrice,callback:function(t){e.$set(e.charge_item,"chargePrice",t)},expression:"charge_item.chargePrice"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"得到金额","label-width":"100px"}},[a("el-input-number",{attrs:{"auto-complete":"off",min:1},model:{value:e.charge_item.totalPrice,callback:function(t){e.$set(e.charge_item,"totalPrice",t)},expression:"charge_item.totalPrice"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"标签","label-width":"100px"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:"如:开业"},model:{value:e.charge_item.tag,callback:function(t){e.$set(e.charge_item,"tag",t)},expression:"charge_item.tag"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"状态","label-width":"80px"}},[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-text":"上线","inactive-text":"下线","active-value":"2","inactive-value":"1"},model:{value:e.charge_item.status,callback:function(t){e.$set(e.charge_item,"status",t)},expression:"charge_item.status"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialog.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleSave}},[e._v("确 定")])],1)],1)],1)])},staticRenderFns:[]};var It=a("VU/8")(Ot,Rt,!1,function(e){a("BT/E")},null,null).exports,At={data:function(){return{baseUrl:E,baseImgPath:B,loading:!1,call_tag:{id:0,content:"",status:"1"},dialog:{dialogFormVisible:!1,title:"新增呼叫标签",close:!1},pages:{offset:0,pageSize:10,page:1,total:0},tableData:[]}},created:function(){this.initData()},methods:{initData:function(){var e=this;this.loading=!0;var t=this;t.$api.get("/store/consumers",t.pages,function(a){if(a.status>=200&&a.status<300){var s=a.data;0==s.code?(t.tableData=s.data.consumers.content,t.pages.total=s.data.consumers.totalElements):e.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"});e.loading=!1})},handleSizeChange:function(e){console.log("每页 "+e+" 条")},handleCurrentChange:function(e){this.pages.page=e,this.pages.offset=(e-1)*this.pages.pageSize,this.initData()},statusFormat:function(e,t){return 0==e.user.isFreeze&&0==e.black?"正常":"封号"},blacklist:function(e){var t=this,a=this;a.$api.get("/store/blacklist",{user_id:e.user.id},function(s){if(s.status>=200&&s.status<300){console.log(s.data);var i=s.data;0==i.code&&(i.data.blacklists.content.length>0?t.$confirm("要将该用户移出黑名单吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.loading=!0,a.$api.delete("/store/blacklist",{user_id:e.user.id},function(e){if(e.status>=200&&e.status<300){console.log(e.data);var a=e.data;0==a.code?(t.$message({message:"移出成功,该用户可正常在本店下单",type:"success"}),t.initData()):t.$message({message:a.msg,type:"error"}),t.loading=!1}else t.$message({message:"服务器维护中",type:"error"}),t.loading=!1})}).catch(function(){}):(t.$confirm("要将该用户加入黑名单吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.loading=!0,a.$api.post("/store/blacklist",{user_id:e.user.id},function(e){if(e.status>=200&&e.status<300){console.log(e.data);var a=e.data;0==a.code?(t.$message({message:"加入成功,该用户将无法在本店下单",type:"success"}),t.initData()):t.$message({message:a.msg,type:"error"}),t.loading=!1}else t.$message({message:"服务器维护中",type:"error"}),t.loading=!1})}).catch(function(){}),t.loading=!1))}else t.$message({message:"服务器维护中",type:"error"}),t.loading=!1})},handleEditRealPrice:function(e){var t=this,a=this;this.$prompt("请输入充值金额","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(s){var i=s.value;a.$api.post("/store/consumers/"+e.id,{chargePrice:100*i},function(e){if(e.status>=200&&e.status<300){var s=e.data;0==s.code?(a.initData(),t.$message({message:"充值成功",type:"success"})):t.$message({message:s.msg,type:"warning"})}else t.$message({message:"服务器维护中",type:"error"}),t.initData();t.loading=!1})}).catch(function(){})}}},Gt={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fillcontain"},[a("div",{staticClass:"table_container"},[a("el-row",[a("el-col",{attrs:{span:6}},[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入 名称/昵称/帐号"},model:{value:e.pages.keyword,callback:function(t){e.$set(e.pages,"keyword",t)},expression:"pages.keyword"}})],1),e._v(" "),a("el-col",{attrs:{span:2}},[a("el-button",{on:{click:e.initData}},[e._v("搜索")])],1)],1),e._v(" "),a("br"),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData}},[a("el-table-column",{attrs:{label:"名称",prop:"name","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{label:"昵称",prop:"nickName"}}),e._v(" "),a("el-table-column",{attrs:{label:"帐号",prop:"user.account","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{label:"余额(元)"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              ￥"+e._s(t.row.user.balance/100)+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"状态",formatter:e.statusFormat}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleEditRealPrice(t.row)}}},[e._v("\n                充值\n              ")]),e._v(" "),t.row.black?a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.blacklist(t.row)}}},[e._v("\n                移出黑名单\n              ")]):e._e(),e._v(" "),t.row.black?e._e():a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.blacklist(t.row)}}},[e._v("\n                加入黑名单\n              ")])]}}])})],1),e._v(" "),a("div",{staticClass:"Pagination"},[a("el-pagination",{attrs:{"current-page":e.pages.page,"page-size":e.pages.pageSize,layout:"total, prev, pager, next",total:e.pages.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)])},staticRenderFns:[]};var Ht=a("VU/8")(At,Gt,!1,function(e){a("TpYb")},null,null).exports,Lt={data:function(){return{baseUrl:E,baseImgPath:B,loading:!1,plugin:{id:0,params:"",status:!1},dialog:{dialogFormVisible:!1,title:"配置",close:!1},tableData:[],params:[]}},created:function(){this.initData()},methods:{initData:function(){var e=this;this.loading=!0;var t=this;t.$api.get("/store/order_food_plugin_config",t.pages,function(a){if(a.status>=200&&a.status<300){var s=a.data;0==s.code?t.tableData=s.data.plugins:e.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"});e.loading=!1})},handleSizeChange:function(e){console.log("每页 "+e+" 条")},handleCurrentChange:function(e){this.pages.page=e,this.pages.offset=(e-1)*this.pages.pageSize,this.initData()},statusFormat:function(e,t){return 1==e.used?"使用中":"未使用"},goBuy:function(e){this.$router.push({path:"/store/pluginsStore",query:{uuid:e.uuid}})},handleEdit:function(e,t,a){this.dialog.title="配置:"+t.name,this.plugin.id=t.id,this.plugin.name=t.name,this.plugin.status=""+t.used,this.params=t.paramsMap,this.dialog.dialogFormVisible=!0},handleSave:function(){var e=this;this.loading=!0;var t=this;t.plugin.params=U()(this.params),t.$api.put("/store/order_food_plugin_config/"+t.plugin.id,t.plugin,function(a){if(a.status>=200&&a.status<300){console.log(a.data);var s=a.data;0==s.code?(e.$message({message:t.dialog.title+"成功",type:"success"}),e.dialog.dialogFormVisible=!1,e.initData()):e.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"})}),this.loading=!1}}},qt={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fillcontain"},[a("div",{staticClass:"table_container"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData}},[a("el-table-column",{attrs:{label:"名称",prop:"name"}}),e._v(" "),a("el-table-column",{attrs:{label:"使用状态",formatter:e.statusFormat}}),e._v(" "),a("el-table-column",{attrs:{label:"插件状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[4==t.row.status?a("span",{staticStyle:{color:"green"}},[e._v(e._s(t.row.statusStr))]):1==t.row.status?a("span",{staticStyle:{color:"red"}},[e._v(e._s(t.row.statusStr))]):2==t.row.status?a("span",{staticStyle:{color:"saddlebrown"}},[e._v(e._s(t.row.statusStr))]):3==t.row.status?a("span",{staticStyle:{color:"red"}},[e._v(e._s(t.row.statusStr))]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[4==t.row.status?a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleEdit(t.$index,t.row,"edit")}}},[e._v("\n            配置\n          ")]):e._e(),e._v(" "),1==t.row.status||3==t.row.status?a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.goBuy(t.row)}}},[e._v("\n            购买\n          ")]):e._e()]}}])})],1),e._v(" "),a("el-dialog",{attrs:{title:e.dialog.title,visible:e.dialog.dialogFormVisible,"close-on-click-modal":e.dialog.close},on:{"update:visible":function(t){return e.$set(e.dialog,"dialogFormVisible",t)}}},[a("el-form",{attrs:{model:e.plugin}},[e._l(e.params,function(t,s){return a("el-form-item",{key:s,attrs:{label:s,"label-width":"100px"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:t.placeholder},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}})],1)}),e._v(" "),a("el-form-item",{attrs:{label:"状态","label-width":"80px"}},[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-text":"使用","inactive-text":"不使用","active-value":"true","inactive-value":"false"},model:{value:e.plugin.status,callback:function(t){e.$set(e.plugin,"status",t)},expression:"plugin.status"}})],1)],2),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialog.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleSave}},[e._v("确 定")])],1)],1)],1)])},staticRenderFns:[]};var jt=a("VU/8")(Lt,qt,!1,function(e){a("+KE6")},null,null).exports,Wt={name:"Header",data:function(){return{menuBtn:"el-icon-newfont-caidan",username:"",nickname:"",storeName:"",user:{oldpwd:"",newpwd:"",newpwdagain:""},dialog:{dialogFormVisible:!1,title:"修改密码",close:!1}}},computed:{isActive:function(){return!this.$store.getters.sidebar.opened}},created:function(){var e=window.localStorage,t=JSON.parse(e.user);this.username=t.user.account,this.nickname=t.name,this.storeName=t.store.name},methods:n()({},Object(l.c)({bindLogout:"BIND_LOGOUT"}),{handleMenu:function(){this.$store.dispatch("ToggleSideBar")},logout:function(){var e=this;this.$confirm("是否退出账户?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t=e;t.$api.post("/store_user/logout",t.user,function(a){if(a.status>=200&&a.status<300){console.log(a.data);var s=a.data;0==s.code?(t.$message({message:"退出登录成功",type:"success"}),t.dialog.dialogFormVisible=!1,t.$router.push("/storeUser/login")):t.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"})})}).catch(function(){})},handleEdit:function(){this.user.oldpwd="",this.user.newpwd="",this.user.newpwdagain="",this.dialog.dialogFormVisible=!0},handleSave:function(){var e=this;if(this.user.newpwd==this.user.newpwdagain){var t=this;t.$api.put("/store_user/setpassword",t.user,function(a){if(a.status>=200&&a.status<300){console.log(a.data);var s=a.data;0==s.code?(e.$message({message:"修改成功,请使用新密码登录",type:"success"}),t.dialog.dialogFormVisible=!1,t.$router.push("/storeUser/login")):t.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"})})}else this.$message({type:"error",message:"两次输入的新密码不一致"})}})},Qt={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"header"},[a("div",{staticClass:"logo",class:{"is-active":e.isActive}},[e._v("\n    "+e._s(e.storeName)+"-店员后台\n  ")]),e._v(" "),a("div",{staticClass:"navbar"},[a("div",{staticClass:"btn",class:{"is-active":e.isActive},on:{click:e.handleMenu}},[a("span",{class:e.menuBtn})]),e._v(" "),a("el-dropdown",{attrs:{trigger:"click"}},[a("span",{staticClass:"el-dropdown-link"},[e._v("\n        "+e._s(e.nickname)),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{nativeOn:{click:function(t){return e.handleEdit(t)}}},[e._v("修改密码")]),e._v(" "),a("el-dropdown-item",{nativeOn:{click:function(t){return e.logout(t)}}},[e._v("退出 ")])],1)],1)],1),e._v(" "),a("el-dialog",{attrs:{title:e.dialog.title,visible:e.dialog.dialogFormVisible,"close-on-click-modal":e.dialog.close},on:{"update:visible":function(t){return e.$set(e.dialog,"dialogFormVisible",t)}}},[a("el-form",{attrs:{model:e.user}},[a("el-form-item",{attrs:{label:"原密码","label-width":"100px"}},[a("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:e.user.oldpwd,callback:function(t){e.$set(e.user,"oldpwd",t)},expression:"user.oldpwd"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"新密码","label-width":"100px"}},[a("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:e.user.newpwd,callback:function(t){e.$set(e.user,"newpwd",t)},expression:"user.newpwd"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"重输新密码","label-width":"100px"}},[a("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:e.user.newpwdagain,callback:function(t){e.$set(e.user,"newpwdagain",t)},expression:"user.newpwdagain"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialog.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleSave}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var Jt=a("VU/8")(Wt,Qt,!1,function(e){a("lKUa")},"data-v-55b247e2",null).exports,Yt={name:"Sidebar",data:function(){return{orderGoodsType:"1"}},computed:n()({},Object(l.b)(["sidebar"]),{isCollapse:function(){return!this.sidebar.opened},activeIndex:function(){var e=this.$route.path;return"details"===this.$route.name?"/tables/details":e}}),created:function(){this.initData()},methods:{initData:function(){var e=this;this.loading=!0;var t=this;t.$api.get("/store_user/setting",null,function(a){if(a.status>=200&&a.status<300){var s=a.data;0==s.code?t.orderGoodsType=""+s.data.setting.orderGoodsType:e.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"});e.loading=!1})}}},Kt={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"sidebar"},[a("el-menu",{staticClass:"el-menu-vertical-demo",attrs:{"default-active":e.activeIndex,router:"",collapse:e.isCollapse,"background-color":"#545c64","text-color":"#fff","active-text-color":"#ffd04b"}},[a("el-menu-item",{attrs:{index:"/storeUser/cart"}},[a("i",{staticClass:"el-icon-s-order"}),e._v(" "),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("下单管理")])]),e._v(" "),a("el-menu-item",{attrs:{index:"/storeUser/orderGoods"}},[a("i",{staticClass:"el-icon-finished"}),e._v(" "),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("菜品队列")])]),e._v(" "),a("el-menu-item",{attrs:{index:"/storeUser/CallLog"}},[a("i",{staticClass:"el-icon-message-solid"}),e._v(" "),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("呼叫记录")])])],1)],1)},staticRenderFns:[]};var Xt={name:"Full",components:{Header:Jt,Breadcrumb:p,Footer:h,Siderbar:a("VU/8")(Yt,Kt,!1,function(e){a("LlQz")},"data-v-fff85eac",null).exports,Scrolltotop:w},mixins:[F],computed:{},data:function(){return{websocketUrl:N,baseUrl:E,baseImgPath:B,socket:null,playUrl:"/admin/static/new_msg.mp3",audio:null,currentSong:null}},created:function(){this.initWebsocket()},methods:{initWebsocket:function(){if("undefined"==typeof WebSocket)alert("您的浏览器不支持订单提醒推送");else{var e=window.localStorage,t=JSON.parse(e.user),a="ws:"+N+"/websocket/"+t.user.id;this.socket=new WebSocket(a),this.socket.onopen=this.open,this.socket.onerror=this.error,this.socket.onmessage=this.getMessage,console.log(a)}},open:function(){console.log("socket连接成功")},error:function(){console.log("连接错误")},getMessage:function(e){var t=e.data;4==(t=JSON.parse(t)).type&&(this.audio=window.document.getElementById("audio"),this.$notify({title:t.des,dangerouslyUseHTMLString:!0,message:t.params.table_number+"号桌客人呼叫:"+t.params.call_content,duration:5e3,position:"bottom-right",type:"success"}),null==this.currentSong?this.currentSong=this.playUrl:this.audio.play()),console.log(t)},send:function(){this.socket.send(params)},close:function(){console.log("socket已经关闭")}},destroyed:function(){null!=this.socket&&(this.socket.onclose=this.close(),this.socket.close(),this.socket=null)}},Zt={render:function(){var e=this.$createElement,t=this._self._c||e;return t("el-container",[t("el-header",[t("Header")],1),this._v(" "),t("el-container",[t("Siderbar"),this._v(" "),t("el-container",[t("el-main",[t("Breadcrumb"),this._v(" "),t("transition",{attrs:{name:"fade-transform",mode:"out-in"}},[t("router-view")],1)],1),this._v(" "),t("el-footer",[t("Footer")],1)],1)],1),this._v(" "),t("Scrolltotop"),this._v(" "),t("audio",{staticStyle:{display:"none"},attrs:{autoplay:"autoplay",src:this.currentSong,id:"audio"}})],1)},staticRenderFns:[]};var ea=a("VU/8")(Xt,Zt,!1,function(e){a("Xzez")},"data-v-dc366c64",null).exports,ta={name:"Login",components:{},data:function(){return{baseUrl:E,user:{account:"",password:"",token:""},loading:!1,rules:{account:[{validator:function(e,t,a){""===t?a(new Error("请输入用户名")):a()},trigger:"change"}],password:[{validator:function(e,t,a){""===t?a(new Error("请输入密码")):a()},trigger:"change"}]}}},mounted:function(){this.$route.query.hasOwnProperty("token")&&(this.user.token=this.$route.query.token,null!=this.user.token&&""!=this.user.token&&this.loginPost())},methods:{login:function(e){var t=this;this.$refs[e].validate(function(e){e&&t.loginPost()})},loginPost:function(){var e=this;this.loading=!0,this.$api.post("/store_user/login",this.user,function(t){if(t.status>=200&&t.status<300){console.log(t.data);var a=t.data;if(0==a.code){e.$message({message:"登录成功",type:"success"}),console.log(a.data);var s=window.localStorage;s.access_token=a.data.user.user.accessToken,s.user=U()(a.data.user),e.$router.push("/storeUser/index")}else e.$message({message:a.msg,type:"warning"});e.loading=!1}else e.$message({message:"服务器维护中",type:"error"}),e.loading=!1})},gotoRegist:function(){this.$router.push({path:"/register"})}}},aa={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"login-wrapper"},[a("div",{staticClass:"login"},[a("p",{staticClass:"title"},[e._v("点餐系统(店员)")]),e._v(" "),a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"user",staticClass:"demo-ruleForm",attrs:{model:e.user,"status-icon":"",rules:e.rules,"label-width":"0"}},[a("el-form-item",{attrs:{prop:"account"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入用户名"},model:{value:e.user.account,callback:function(t){e.$set(e.user,"account",t)},expression:"user.account"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"password"}},[a("el-input",{attrs:{type:"password","auto-complete":"off",placeholder:"输入密码"},model:{value:e.user.password,callback:function(t){e.$set(e.user,"password",t)},expression:"user.password"}})],1),e._v(" "),a("el-form-item",[a("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:function(t){return e.login("user")}}},[e._v("登录")])],1)],1)],1)])])},staticRenderFns:[]};var sa=a("VU/8")(ta,aa,!1,function(e){a("aDtV")},"data-v-697c6e48",null).exports,ia={data:function(){return{baseUrl:E,baseImgPath:B,loading:!1,chooseTableContainer:!0,chooseGoodsContainer:!1,pages:{offset:0,pageSize:10,page:1,total:0,keyword:""},goodsPages:{offset:0,pageSize:10,page:1,total:0,keyword:""},tableData:[],goodsData:[],cart:{table_id:0,note:"",people_num:""},chooseCartGoods:{},choseTable:{},actionDialogVisible:!1,noteDialogTableVisible:!1,createOrderialogFormVisible:!1,totalPrice:0,action:0}},created:function(){this.initData()},methods:{initData:function(){var e=this;this.loading=!0;var t=this;t.$api.get("/store_user/tables",t.pages,function(a){if(a.status>=200&&a.status<300){var s=a.data;if(0==s.code){var i=s.data.tables.content;t.tableData=[],i.forEach(function(e,a){1==e.status?e.btnType="success":e.btnType="info",t.tableData.push(e)}),t.pages.total=s.data.tables.totalElements}else e.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"});e.loading=!1})},initGoodsData:function(){var e=this;this.actionDialogVisible=!1,this.chooseTableContainer=!1,this.chooseGoodsContainer=!0,this.loading=!0;var t=this;t.$api.get("/store_user/cart",{table_id:this.choseTable.id,keyword:this.goodsPages.keyword},function(a){if(a.status>=200&&a.status<300){var s=a.data;0==s.code?(e.goodsData=s.data.goods,t.totalPrice=0,t.goodsData.forEach(function(e,a){t.totalPrice+=e.sell_price*e.cart_num})):e.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"});e.loading=!1})},goOrderDetail:function(e){this.$router.push({path:"/storeUser/orderDetail",query:{table_id:this.choseTable.id}})},openNoteDialog:function(e){null==e.note&&(e.note=""),this.chooseCartGoods=e,this.noteDialogTableVisible=!0},sureNoteDialog:function(){this.handleChange(this.chooseCartGoods),this.noteDialogTableVisible=!1},addNoteTag:function(e){this.chooseCartGoods.note=this.chooseCartGoods.note+" "+e},handleChange:function(e){var t=this,a=this;a.$api.post("/store_user/cart/table/"+this.cart.table_id+"/goods/"+e.id,{num:e.cart_num,note:e.note},function(e){if(e.status>=200&&e.status<300){var s=e.data;0==s.code?(a.totalPrice=0,a.goodsData.forEach(function(e,t){a.totalPrice+=e.sell_price*e.cart_num})):t.$message({message:s.msg,type:"warning"})}else t.$message({message:"服务器维护中",type:"error"});t.loading=!1})},openCreateOrderDialog:function(){this.cart.note="",this.createOrderialogFormVisible=!0},createOrder:function(){var e=this;this.cart.table_id=this.choseTable.id,this.loading=!0;this.createOrderialogFormVisible=!1,this.$api.post("/store_user/orders/"+this.cart.table_id,this.cart,function(t){if(t.status>=200&&t.status<300){var a=t.data;0==a.code?(e.$message({message:"下单成功",type:"success"}),e.chooseTableContainer=!0,e.chooseGoodsContainer=!1,e.initData()):e.$message({message:a.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"});e.loading=!1})},resetTable:function(e){var t=this,a="翻台",s="翻台将使该桌子重置为空闲";2==e&&(s="占用将使该桌子置为使用中",a="占用"),this.$confirm(s+",是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var s=t;t.loading=!0,s.$api.put("/store_user/tables/"+t.choseTable.id,{status:e},function(e){if(e.status>=200&&e.status<300){var i=e.data;0==i.code?(s.actionDialogVisible=!1,t.$message({message:a+"成功",type:"success"}),s.initData()):t.$message({message:i.msg,type:"warning"})}else t.$message({message:"服务器维护中",type:"error"});t.loading=!1})}).catch(function(){})},changeTable:function(){this.action=1,this.actionDialogVisible=!1,this.$message({message:"请选择要换到的桌子",type:"success"})},assembleTable:function(){this.action=2,this.actionDialogVisible=!1,this.$message({message:"请选择要并的桌子",type:"success"})},chooseTable:function(e){var t=this;if(1==this.action){if(this.choseTable.id==e.id)return this.action=0,this.$message({message:"取消换桌成功",type:"success"}),void(1==this.choseTable.status?this.choseTable.btnType="success":this.choseTable.btnType="info");this.$confirm("确定要让"+this.choseTable.name+"桌换到"+e.name+"吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a=t;t.loading=!0,a.$api.put("/store_user/cart",{from_table_id:t.choseTable.id,to_table_id:e.id},function(s){if(s.status>=200&&s.status<300){var i=s.data;0==i.code?(a.actionDialogVisible=!1,t.$message({message:"换桌成功",type:"success"}),t.action=0,1==t.choseTable.status?t.choseTable.btnType="success":t.choseTable.btnType="info",e.btnType="primary",t.choseTable=e,t.cart.table_id=e.id,t.initData()):t.$message({message:i.msg,type:"warning"})}else t.$message({message:"服务器维护中",type:"error"});t.loading=!1})}).catch(function(){t.action=0})}else if(2==this.action){if(this.choseTable.id==e.id)return this.action=0,this.$message({message:"取消并桌成功",type:"success"}),void(1==this.choseTable.status?this.choseTable.btnType="success":this.choseTable.btnType="info");this.$confirm("确定要让"+this.choseTable.name+"和"+e.name+"并桌吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a=t;t.loading=!0,a.$api.post("/store_user/tables/assemble_table",{from_table_id:t.choseTable.id,to_table_id:e.id},function(e){if(e.status>=200&&e.status<300){var s=e.data;0==s.code?(a.actionDialogVisible=!1,t.$message({message:"并桌成功",type:"success"}),t.action=0,t.initData()):t.$message({message:s.msg,type:"warning"})}else t.$message({message:"服务器维护中",type:"error"});t.loading=!1})}).catch(function(){t.action=0})}else e.btnType="primary",this.choseTable=e,this.cart.table_id=e.id,this.actionDialogVisible=!0},actionDialogHandleClose:function(){1==this.choseTable.status?this.choseTable.btnType="success":this.choseTable.btnType="info",this.actionDialogVisible=!1},handleSizeChange:function(e){console.log("每页 "+e+" 条")},handleCurrentChange:function(e){this.pages.page=e,this.pages.offset=(e-1)*this.pages.pageSize,this.initData()},statusFormat:function(e,t){return 2==e.status?"上架":"下架"},markerPriceFormat:function(e,t){return e.marker_price/100},sellPriceFormat:function(e,t){return e.sell_price/100},in_array:function(e,t){for(var a in t)if(t[a]==e)return!0;return!1},handleSave:function(){var e=this;this.loading=!0;var t=this;t.goods.pic_ids="";for(var a=0,s=this.picFiles.length;a<s;a++)t.goods.pic_ids+=this.picFiles[a].id+"#";t.goods.tag_ids="",this.tagChecks.forEach(function(e,a){1==e.check&&(t.goods.tag_ids+=e.id+"#")}),t.goods.sell_price=100*t.goods.sell_price,t.goods.marker_price=100*t.goods.marker_price,t.$api.post("/store/goods",t.goods,function(a){if(a.status>=200&&a.status<300){console.log(a.data);var s=a.data;0==s.code?(e.$message({message:t.dialog.title+"成功",type:"success"}),e.dialog.dialogFormVisible=!1,e.initData()):e.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"})}),this.loading=!1},handleDeleteAlert:function(e){var t=this;this.$confirm("此操作将删除该菜品, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.handleDelete(e)}).catch(function(){})},handleDelete:function(e){var t=this;this.loading=!0;this.$api.delete("/store/goods/"+e.id,null,function(e){if(e.status>=200&&e.status<300){console.log(e.data);var a=e.data;0==a.code?(t.$message({message:"删除成功",type:"success"}),t.loading=!1,t.initData()):t.$message({message:a.msg,type:"warning"})}else t.$message({message:"服务器维护中",type:"error"})})}}},oa={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fillcontain",staticStyle:{"background-color":"white"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.chooseTableContainer,expression:"chooseTableContainer"}],staticClass:"table_container"},[a("el-row",[a("el-input",{staticClass:"input-with-select",staticStyle:{"font-size":"25px"},attrs:{autosize:"",placeholder:"请输入餐桌编号"},on:{input:e.initData},model:{value:e.pages.keyword,callback:function(t){e.$set(e.pages,"keyword",t)},expression:"pages.keyword"}})],1),e._v(" "),a("br"),e._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},e._l(e.tableData,function(t,s){return a("el-button",{key:s,staticStyle:{height:"100px",width:"100px","font-size":"15px",margin:"3px","text-align":"center"},attrs:{type:t.btnType},on:{click:function(a){return e.chooseTable(t)}}},[e._v("\n              "+e._s(t.name)+"\n              "),a("br"),e._v(" "),a("strong",[e._v("\n              "+e._s(t.number)+"\n              ")])])}),1),e._v(" "),a("br"),e._v(" "),a("br"),e._v(" "),a("br"),e._v(" "),a("div",{staticClass:"Pagination"},[a("el-pagination",{attrs:{"current-page":e.pages.page,"page-size":e.pages.pageSize,layout:"total, prev, pager, next",total:e.pages.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:"操作",visible:e.actionDialogVisible,width:"90%","before-close":e.actionDialogHandleClose},on:{"update:visible":function(t){e.actionDialogVisible=t}}},[a("el-button",{staticStyle:{height:"80px",width:"80px","font-size":"15px"},attrs:{type:"success"},on:{click:e.initGoodsData}},[e._v("点餐")]),e._v(" "),a("el-button",{staticStyle:{height:"80px",width:"80px","font-size":"15px"},attrs:{type:"danger"},on:{click:e.goOrderDetail}},[e._v("看单")]),e._v(" "),a("el-button",{staticStyle:{height:"80px",width:"80px","font-size":"15px"},attrs:{type:"primary"},on:{click:e.changeTable}},[e._v("换桌")]),e._v(" "),a("br"),a("br"),e._v(" "),a("el-button",{staticStyle:{height:"80px",width:"80px","font-size":"15px"},attrs:{type:"info"},on:{click:function(t){return e.resetTable(2)}}},[e._v("占用")]),e._v(" "),a("el-button",{staticStyle:{height:"80px",width:"80px","font-size":"15px"},attrs:{type:"primary"},on:{click:function(t){return e.resetTable(1)}}},[e._v("翻台")]),e._v(" "),a("el-button",{staticStyle:{height:"80px",width:"80px","font-size":"15px"},on:{click:e.actionDialogHandleClose}},[e._v("取消")])],1)],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.chooseGoodsContainer,expression:"chooseGoodsContainer"}],staticClass:"table_container"},[a("el-row",[a("el-input",{staticClass:"input-with-select",staticStyle:{"font-size":"25px"},attrs:{autosize:"",placeholder:"请输入菜品名或编号"},on:{input:e.initGoodsData},model:{value:e.goodsPages.keyword,callback:function(t){e.$set(e.goodsPages,"keyword",t)},expression:"goodsPages.keyword"}})],1),e._v(" "),a("br"),e._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.goodsData}},[a("el-table-column",{staticStyle:{width:"40%"},attrs:{label:"菜品",prop:"name"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{trigger:"hover",placement:"top"}},[a("p",[e._v("销售价: ￥"+e._s(t.row.marker_price/100))]),e._v(" "),a("br"),e._v(" "),a("p",[e._v("市场价: ￥"+e._s(t.row.sell_price/100))]),e._v(" "),a("br"),e._v(" "),a("p",[a("el-button",{attrs:{type:"primary"},on:{click:function(a){return e.openNoteDialog(t.row)}}},[e._v("备注:"+e._s(t.row.note))])],1),e._v(" "),a("br"),e._v(" "),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[t.row.cart_num?a("el-button",{staticStyle:{height:"60px"},attrs:{type:"success"}},[a("span",[e._v(e._s(t.row.name))]),e._v("\n                  (No."+e._s(t.row.number)+")\n                  "),a("br"),e._v(" "),a("span",[e._v("￥"+e._s(t.row.sell_price/100)+",￥"+e._s(t.row.cart_num*t.row.sell_price/100))])]):a("el-button",{staticStyle:{height:"60px"},attrs:{type:"info"}},[a("span",[e._v(e._s(t.row.name))]),e._v("\n                  (No."+e._s(t.row.number)+")\n                  "),a("br"),e._v(" "),a("span",[e._v("￥"+e._s(t.row.sell_price/100)+",￥"+e._s(t.row.cart_num*t.row.sell_price/100))])])],1)])]}}])}),e._v(" "),a("el-table-column",{staticStyle:{width:"60%"},attrs:{label:"数量"},scopedSlots:e._u([{key:"header",fn:function(t){return[a("span",{staticStyle:{"font-size":"15px"}},[e._v("共:￥"+e._s(e.totalPrice/100))]),e._v(" "),a("el-button",{attrs:{type:"danger"},on:{click:e.openCreateOrderDialog}},[e._v("下单")])]}},{key:"default",fn:function(t){return[a("el-input-number",{attrs:{min:0,max:1e3,label:"下单数量"},on:{change:function(a){return e.handleChange(t.row)}},model:{value:t.row.cart_num,callback:function(a){e.$set(t.row,"cart_num",a)},expression:"scope.row.cart_num"}})]}}])})],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"菜品备注",visible:e.noteDialogTableVisible,width:"90%","show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.noteDialogTableVisible=t}}},[a("p",[a("el-input",{attrs:{type:"textarea",rows:"8",placeholder:"请输入对该菜的备注"},model:{value:e.chooseCartGoods.note,callback:function(t){e.$set(e.chooseCartGoods,"note",t)},expression:"chooseCartGoods.note"}})],1),e._v(" "),a("br"),e._v(" "),a("p",[a("el-tag",{attrs:{type:"success"},on:{click:function(t){return e.addNoteTag("大辣")}}},[e._v("大辣")]),e._v(" "),a("el-tag",{attrs:{type:"success"},on:{click:function(t){return e.addNoteTag("中辣")}}},[e._v("中辣")]),e._v(" "),a("el-tag",{attrs:{type:"success"},on:{click:function(t){return e.addNoteTag("小辣")}}},[e._v("小辣")]),e._v(" "),a("el-tag",{attrs:{type:"success"},on:{click:function(t){return e.addNoteTag("少盐")}}},[e._v("少盐")]),e._v(" "),a("el-tag",{attrs:{type:"success"},on:{click:function(t){return e.addNoteTag("多盐")}}},[e._v("多盐")]),e._v(" "),a("el-tag",{attrs:{type:"success"},on:{click:function(t){return e.addNoteTag("少油")}}},[e._v("少油")]),e._v(" "),a("el-tag",{attrs:{type:"success"},on:{click:function(t){return e.addNoteTag("多油")}}},[e._v("多油")]),e._v(" "),a("el-tag",{attrs:{type:"success"},on:{click:function(t){return e.addNoteTag("打包")}}},[e._v("打包")])],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.sureNoteDialog}},[e._v("确 定")])],1)]),e._v(" "),a("el-dialog",{attrs:{title:"下单确认",visible:e.createOrderialogFormVisible,width:"90%"},on:{"update:visible":function(t){e.createOrderialogFormVisible=t}}},[a("el-form",{attrs:{model:e.cart}},[a("el-form-item",{attrs:{label:"就餐人数","label-width":"100px"}},[a("el-input-number",{attrs:{min:1,max:1e4,label:"人数"},model:{value:e.cart.people_num,callback:function(t){e.$set(e.cart,"people_num",t)},expression:"cart.people_num"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"下单备注","label-width":"100px"}},[a("el-input",{attrs:{type:"textarea",rows:"4"},model:{value:e.cart.note,callback:function(t){e.$set(e.cart,"note",t)},expression:"cart.note"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.createOrderialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.createOrder}},[e._v("确 定")])],1)],1)],1)])},staticRenderFns:[]},na=a("VU/8")(ia,oa,!1,null,null,null).exports,la={data:function(){return{baseUrl:E,baseImgPath:B,uploadUrl:E+"/common/imageUpload",loading:!1,table_id:0,order:{id:0,number:"",createTimeStr:"",payTime:"",payTimeStr:""},goodsData:[],totalPrice:0,keyword:"",chooseOrderGoods:{},noteDialogTableVisible:!1,paymentConfigs:[],payTypeDialog:!1,token:null,choosePrinter:{},choosePrinterDataModels:null,printers:[],printerDialogTableVisible:!1}},created:function(){var e=window.localStorage;this.token=e.access_token,this.table_id=this.$route.query.table_id,this.initData()},methods:{initData:function(){var e=this;this.loading=!0;var t=this;t.$api.get("/store_user/orders/table/"+this.table_id,t.pages,function(a){if(a.status>=200&&a.status<300){var s=a.data;0==s.code?(t.order=s.data.order,t.order.createTimeStr=e.dateTimeFormat(t.order.createTime),null!=t.order.payTime&&""!=t.order.payTime&&(t.order.payTimeStr=e.dateTimeFormat(t.order.payTime)),t.initGoodsData()):e.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"});e.loading=!1})},initGoodsData:function(){var e=this;this.loading=!0;var t=this;t.$api.get("/store_user/orders/orderGoods",{order_id:t.order.id,keyword:this.keyword},function(a){if(a.status>=200&&a.status<300){var s=a.data;0==s.code?(t.goodsData=s.data.orderGoods,t.totalPrice=0,t.goodsData.forEach(function(e,a){t.totalPrice+=e.goods.sell_price*e.count})):e.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"});e.loading=!1})},handleSizeChange:function(e){console.log("每页 "+e+" 条")},handleCurrentChange:function(e){this.pages.page=e,this.pages.offset=(e-1)*this.pages.pageSize,this.initData()},statusFormat:function(e,t){return 2==e.status?"上架":"下架"},markerPriceFormat:function(e,t){return e.goods.marker_price/100},sellPriceFormat:function(e,t){return e.goods.sell_price/100},totalPriceFormat:function(e,t){return e.goods.sell_price/100},dateTimeFormat:function(e){var t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-"+(t.getDate()<10?"0"+t.getDate():t.getDate())+" "+(t.getHours()<10?"0"+t.getHours():t.getHours())+":"+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+":"+(t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds())},openNoteDialog:function(e){null==e.note&&(e.note=""),this.chooseOrderGoods=e,this.noteDialogTableVisible=!0},sureNoteDialog:function(){this.handleChange(this.chooseOrderGoods),this.noteDialogTableVisible=!1},addNoteTag:function(e){this.chooseOrderGoods.note=this.chooseOrderGoods.note+" "+e},overGoods:function(e){var t=this;this.$confirm("确定菜品:"+e.goodsName+"已经上完?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$api.put("/store_user/orders/order_goods/"+e.id,null,function(e){if(e.status>=200&&e.status<300){var a=e.data;0==a.code?t.initData():t.$message({message:a.msg,type:"warning"})}else t.$message({message:"服务器维护中",type:"error"});t.loading=!1})}).catch(function(){})},handlePrinterChange:function(){this.choosePrinterDataModels=null},openChoosePrinter:function(e){var t=this;this.order=e;var a=this;a.$api.get("/store_user/printer",null,function(e){if(e.status>=200&&e.status<300){var s=e.data;0==s.code?(a.printers=s.data.printers,t.printerDialogTableVisible=!0,t.choosePrinter=null,t.choosePrinterDataModels=null):t.$message({message:s.msg,type:"warning"})}else t.$message({message:"服务器维护中",type:"error"});t.loading=!1})},printOrder:function(){var e=this,t=this;t.$api.put("/store_user/printer/"+t.choosePrinter.id+"/order/"+this.order.id+"/type/"+this.choosePrinterDataModels.type,null,function(a){if(a.status>=200&&a.status<300){var s=a.data;0==s.code?(e.$message({message:"已加入到打印队列了",type:"success"}),t.printerDialogTableVisible=!1):e.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"});e.loading=!1})},sureOrder:function(){var e=this;this.$confirm("确定当前订单有效吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$api.put("/store_user/orders/"+e.order.id+"/status",null,function(t){if(t.status>=200&&t.status<300){var a=t.data;0==a.code?e.$message({message:"已确认当前订单",type:"success"}):e.$message({message:a.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"});e.loading=!1})}).catch(function(){})},payOrder:function(){var e=this;this.loading=!0;var t=this;t.$api.get("/store_user/payment_config/can_used",null,function(a){if(a.status>=200&&a.status<300){var s=a.data;0==s.code&&(t.payTypeDialog=!0,t.paymentConfigs=s.data.paymentsConfigs,console.log(a))}e.loading=!1})},goPay:function(e){var t=window.localStorage.access_token;location.href=this.baseUrl+"/payment/pay/"+e.id+"?order_id="+this.order.id+"&token="+t+"&t="+(new Date).getTime()},handleChange:function(e){var t=this,a=this;a.$api.post("/store_user/orders/"+this.order.id+"/goods/"+e.goods.id,{num:e.count,note:e.note},function(e){if(e.status>=200&&e.status<300){var s=e.data;0==s.code?(a.totalPrice=0,a.goodsData.forEach(function(e,t){a.totalPrice+=e.goods.sell_price*e.count})):(t.$message({message:s.msg,type:"warning"}),t.initData())}else t.$message({message:"服务器维护中",type:"error"}),t.initData();t.loading=!1})},handleEditTable:function(){var e=this,t=this;this.$prompt("请输入餐桌编号","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(a){var s=a.value;t.$api.put("/store_user/orders/"+e.order.id+"/table",{table_number:s},function(a){if(a.status>=200&&a.status<300){var s=a.data;0==s.code?(e.table_id=s.data.table.id,t.initData()):(e.$message({message:s.msg,type:"warning"}),e.initData())}else e.$message({message:"服务器维护中",type:"error"}),e.initData();e.loading=!1})}).catch(function(){})},closePayPop:function(){this.payTypeDialog=!1,this.initData()},in_array:function(e,t){for(var a in t)if(t[a]==e)return!0;return!1}}},ra={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fillcontain"},[a("div",{staticClass:"table_container"},[a("el-row",[a("el-form",{attrs:{model:e.order}},[a("el-form-item",{attrs:{label:"订单号:","label-width":"100px"}},[e._v("\n              "+e._s(e.order.orderNo)+"\n            ")]),e._v(" "),a("el-form-item",{attrs:{label:"创建时间:","label-width":"100px"}},[e._v("\n              "+e._s(e.order.createTimeStr)+"\n            ")]),e._v(" "),a("el-form-item",{attrs:{label:"状态:","label-width":"100px"}},[e._v("\n              "+e._s(e.order.payStatusStr)+"\n            ")]),e._v(" "),e.order.payStatus>1?a("el-form-item",{attrs:{label:"支付时间:","label-width":"100px"}},[e._v("\n              "+e._s(e.order.payTimeStr)+"\n            ")]):e._e()],1)],1),e._v(" "),a("br"),e._v(" "),a("el-row",[a("el-button",{staticStyle:{height:"80px",width:"80px","font-size":"15px"},attrs:{type:"success"},on:{click:function(t){return e.openChoosePrinter(e.order)}}},[e._v("打单")]),e._v(" "),a("el-button",{staticStyle:{height:"80px",width:"80px","font-size":"15px"},attrs:{type:"danger"},on:{click:function(t){return e.handleEditTable()}}},[e._v("换桌")]),e._v(" "),1==e.order.applyStatus?a("el-button",{staticStyle:{height:"80px",width:"80px","font-size":"15px"},attrs:{type:"info"},on:{click:function(t){return e.sureOrder()}}},[e._v("确单")]):e._e(),e._v(" "),2==e.order.applyStatus&&1==e.order.payStatus?a("el-button",{staticStyle:{height:"80px",width:"80px","font-size":"15px"},attrs:{type:"warning"},on:{click:function(t){return e.payOrder()}}},[e._v("收款")]):e._e()],1),e._v(" "),a("br"),e._v(" "),a("el-row",[a("el-input",{staticClass:"input-with-select",staticStyle:{"font-size":"25px"},attrs:{autosize:"",placeholder:"请输入菜品名或编号"},on:{input:e.initGoodsData},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}})],1),e._v(" "),a("br"),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.goodsData}},[a("el-table-column",{attrs:{label:"菜品",prop:"name"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{trigger:"hover",placement:"top"}},[a("p",[e._v("销售价: ￥"+e._s(t.row.goods.marker_price/100))]),e._v(" "),a("br"),e._v(" "),a("p",[e._v("市场价: ￥"+e._s(t.row.goods.sell_price/100))]),e._v(" "),a("br"),e._v(" "),a("p",[a("el-button",{attrs:{type:"primary"},on:{click:function(a){return e.openNoteDialog(t.row)}}},[e._v("备注:"+e._s(t.row.note))])],1),e._v(" "),a("br"),e._v(" "),a("p",[a("el-button",{attrs:{type:"primary"},on:{click:function(a){return e.overGoods(t.row)}}},[e._v("确定上菜")])],1),e._v(" "),a("br"),e._v(" "),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[t.row.count?a("el-button",{staticStyle:{height:"70px"},attrs:{type:"success"}},[a("span",[e._v(e._s(t.row.goods.name))]),e._v("\n                  (No."+e._s(t.row.goods.number)+")\n                  "),a("br"),e._v(" "),a("span",[e._v("￥"+e._s(t.row.goods.sell_price/100)+",￥"+e._s(t.row.count*t.row.goods.sell_price/100))]),e._v(" "),a("br"),e._v(" "),t.row.count>0&&0==t.row.makingCount?a("span",[e._v("未制作")]):e._e(),e._v(" "),t.row.count>0&&t.row.makingCount>0&&t.row.makingCount>t.row.makedCount?a("span",[e._v("制作中")]):e._e(),e._v(" "),t.row.count>0&&t.row.makingCount==t.row.makedCount&&t.row.makedCount>0&&t.row.overCount<t.row.count?a("span",[e._v("上菜中")]):e._e(),e._v(" "),t.row.count>0&&t.row.overCount>=t.row.count?a("span",[e._v("已上完")]):e._e()]):a("el-button",{staticStyle:{height:"50px"},attrs:{type:"info"}},[a("span",[e._v(e._s(t.row.goods.name))]),e._v("\n                  (No."+e._s(t.row.goods.number)+")\n                  "),a("br"),e._v(" "),a("span",[e._v("￥"+e._s(t.row.goods.sell_price/100)+",￥"+e._s(t.row.count*t.row.goods.sell_price/100))])])],1)])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"数量"},scopedSlots:e._u([{key:"header",fn:function(t){return[a("span",[e._v("总价:￥"+e._s(e.totalPrice/100))])]}},{key:"default",fn:function(t){return[a("el-input-number",{attrs:{min:t.row.makingCount,max:1e3,label:"下单数量"},on:{change:function(a){return e.handleChange(t.row)}},model:{value:t.row.count,callback:function(a){e.$set(t.row,"count",a)},expression:"scope.row.count"}})]}}])})],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"菜品备注",visible:e.noteDialogTableVisible,width:"90%","show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.noteDialogTableVisible=t}}},[a("p",[a("el-input",{attrs:{type:"textarea",rows:"8",placeholder:"请输入对该菜的备注"},model:{value:e.chooseOrderGoods.note,callback:function(t){e.$set(e.chooseOrderGoods,"note",t)},expression:"chooseOrderGoods.note"}})],1),e._v(" "),a("br"),e._v(" "),a("p",[a("el-tag",{attrs:{type:"success"},on:{click:function(t){return e.addNoteTag("大辣")}}},[e._v("大辣")]),e._v(" "),a("el-tag",{attrs:{type:"success"},on:{click:function(t){return e.addNoteTag("中辣")}}},[e._v("中辣")]),e._v(" "),a("el-tag",{attrs:{type:"success"},on:{click:function(t){return e.addNoteTag("小辣")}}},[e._v("小辣")]),e._v(" "),a("el-tag",{attrs:{type:"success"},on:{click:function(t){return e.addNoteTag("少盐")}}},[e._v("少盐")]),e._v(" "),a("el-tag",{attrs:{type:"success"},on:{click:function(t){return e.addNoteTag("多盐")}}},[e._v("多盐")]),e._v(" "),a("el-tag",{attrs:{type:"success"},on:{click:function(t){return e.addNoteTag("少油")}}},[e._v("少油")]),e._v(" "),a("el-tag",{attrs:{type:"success"},on:{click:function(t){return e.addNoteTag("多油")}}},[e._v("多油")]),e._v(" "),a("el-tag",{attrs:{type:"success"},on:{click:function(t){return e.addNoteTag("打包")}}},[e._v("打包")])],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.sureNoteDialog}},[e._v("确 定")])],1)]),e._v(" "),a("el-dialog",{attrs:{title:"订单支付",visible:e.payTypeDialog,width:"90%","show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.payTypeDialog=t}}},[0==e.paymentConfigs.length?a("p",{staticStyle:{"font-size":"30px"}},[a("span",[e._v("请前往收银台付款")])]):a("p",e._l(e.paymentConfigs,function(t,s){return a("a",{key:s,attrs:{href:e.baseUrl+"/payment/pay/"+t.id+"?order_id="+e.order.id+"&token="+e.token,target:"_blank"}},[a("el-button",{attrs:{type:"success"}},[e._v(e._s(t.name))])],1)}),0),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.closePayPop()}}},[e._v("关  闭")])],1)]),e._v(" "),a("el-dialog",{attrs:{title:"打印",visible:e.printerDialogTableVisible},on:{"update:visible":function(t){e.printerDialogTableVisible=t}}},[a("el-divider",{attrs:{"content-position":"left"}},[e._v("打印机")]),e._v(" "),e.printers.length>0?a("div",e._l(e.printers,function(t,s){return a("el-radio",{key:s,attrs:{label:t,border:""},on:{change:e.handlePrinterChange},model:{value:e.choosePrinter,callback:function(t){e.choosePrinter=t},expression:"choosePrinter"}},[e._v(e._s(t.name))])}),1):a("div",[e._v("\n      暂无打印机\n    ")]),e._v(" "),a("el-divider",{attrs:{"content-position":"left"}},[e._v("打印模板")]),e._v(" "),null!=e.choosePrinter&&null!=e.choosePrinter.printerDataModels?a("div",e._l(e.choosePrinter.printerDataModels,function(t,s){return a("el-radio",{key:s,attrs:{label:t,border:""},model:{value:e.choosePrinterDataModels,callback:function(t){e.choosePrinterDataModels=t},expression:"choosePrinterDataModels"}},[e._v(e._s(t.name))])}),1):a("div",[e._v("\n      暂无打印模板\n    ")]),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.printerDialogTableVisible=!1}}},[e._v("取 消")]),e._v(" "),null!=e.choosePrinter&&null!=e.choosePrinterDataModels?a("el-button",{attrs:{type:"primary"},on:{click:e.printOrder}},[e._v("确 定")]):e._e()],1)],1)],1)},staticRenderFns:[]};var ca=a("VU/8")(la,ra,!1,function(e){a("4qRi")},null,null).exports,da={data:function(){return{baseUrl:E,baseImgPath:B,loading:!1,playUrl:"/static/order_tip.mp3",audio:null,currentSong:null,orderGoods:{id:0,name:"",count:0},pages:{offset:0,pageSize:10,page:1,total:0},tableData:[],tagChecks:[],timer:"",goods_count:0}},created:function(){this.initData(),this.timer=setInterval(this.initData,3e4)},methods:{initData:function(){var e=this,t=this;t.$api.get("/store_user/order_goods/queue",t.pages,function(a){if(a.status>=200&&a.status<300){var s=a.data;0==s.code?(t.tableData=s.data.queue,0==e.goods_count&&t.tableData.length>0&&(null==e.currentSong?e.currentSong=e.playUrl:(e.audio=window.document.getElementById("audio"),e.audio.play()),e.$notify({title:"新订单",dangerouslyUseHTMLString:!0,message:"有新订单来了",duration:5e3,position:"bottom-right",type:"success"})),e.goods_count=t.tableData.length):e.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"})})},handleSizeChange:function(e){console.log("每页 "+e+" 条")},handleCurrentChange:function(e){this.pages.page=e,this.pages.offset=(e-1)*this.pages.pageSize,this.initData()},handleMaking:function(e){var t=this,a=e.count-e.makingCount;this.$confirm("确定要开始制作 "+a+"份 "+e.goodsName+" 吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.handleSave(e,"making")}).catch(function(){})},handleSave:function(e,t){var a=this;this.loading=!0;this.$api.put("/store_user/order_goods/"+e.id+"/"+t,null,function(e){if(e.status>=200&&e.status<300){console.log(e.data);var t=e.data;0==t.code?(a.$message({message:"操作成功",type:"success"}),a.initData()):a.$message({message:t.msg,type:"warning"})}else a.$message({message:"服务器维护中",type:"error"})}),this.loading=!1},handleDeleteAlert:function(e){var t=this,a=e.makingCount-e.makedCount;this.$confirm("确定制作完成了 "+a+"份 "+e.goodsName+" 吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.handleSave(e,"maked")}).catch(function(){})}},beforeDestroy:function(){clearInterval(this.timer)}},ua={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fillcontain"},[a("div",{staticClass:"table_container"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData}},[a("el-table-column",{attrs:{label:"餐桌",prop:"orders.tableNumber"}}),e._v(" "),a("el-table-column",{attrs:{label:"菜品",prop:"goodsName"}}),e._v(" "),a("el-table-column",{attrs:{label:"数量"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.status?a("span",[e._v("\n                "+e._s(t.row.count-t.row.makingCount)+"\n              ")]):e._e(),e._v(" "),2==t.row.status?a("span",[e._v("\n                "+e._s(t.row.makingCount-t.row.makedCount)+"\n              ")]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"备注",prop:"note","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.status?a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleMaking(t.row)}}},[e._v("\n                    制作\n                ")]):e._e(),e._v(" "),2==t.row.status?a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.handleDeleteAlert(t.row)}}},[e._v("\n                  完成\n                ")]):e._e()]}}])})],1),e._v(" "),a("audio",{staticStyle:{display:"none"},attrs:{autoplay:"autoplay",src:e.currentSong,id:"audio"}})],1)])},staticRenderFns:[]};var ga=a("VU/8")(da,ua,!1,function(e){a("Fx4z")},null,null).exports,pa={data:function(){return{baseUrl:E,baseImgPath:B,loading:!1,call_tag:{id:0,content:"",status:"1"},dialog:{dialogFormVisible:!1,title:"新增呼叫标签",close:!1},pages:{offset:0,pageSize:10,page:1,total:0},tableData:[],plugin_msg:null}},created:function(){this.initData()},methods:{initData:function(){var e=this;this.loading=!0;var t=this;t.$api.get("/store_user/call_log",t.pages,function(a){if(a.status>=200&&a.status<300){var s=a.data;0==s.code?(t.tableData=s.data.callLogs.content,t.plugin_msg=s.data.plugin_msg,t.pages.total=s.data.callLogs.totalElements):e.$message({message:s.msg,type:"warning"})}else e.$message({message:"服务器维护中",type:"error"});e.loading=!1})},handleSizeChange:function(e){console.log("每页 "+e+" 条")},handleCurrentChange:function(e){this.pages.page=e,this.pages.offset=(e-1)*this.pages.pageSize,this.initData()},statusFormat:function(e,t){return 2==e.status?"已处理":"未处理"},handleStatusAlert:function(e){var t=this;this.$confirm("此操作将该呼叫记录修改为已处理, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.handleStatus(e)}).catch(function(){})},handleStatus:function(e){var t=this;this.loading=!0;this.$api.put("/store_user/call_log/"+e.id,{status:2},function(e){if(e.status>=200&&e.status<300){console.log(e.data);var a=e.data;0==a.code?(t.$message({message:"处理成功",type:"success"}),t.loading=!1,t.initData()):t.$message({message:a.msg,type:"warning"})}else t.$message({message:"服务器维护中",type:"error"})})}}},ma={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fillcontain"},[a("div",{staticClass:"table_container"},[null!=e.plugin_msg?a("el-row",[a("el-alert",{attrs:{title:e.plugin_msg,type:"error"}})],1):e._e(),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData}},[a("el-table-column",{attrs:{label:"桌号",prop:"tables.number"}}),e._v(" "),a("el-table-column",{attrs:{label:"呼叫内容",prop:"content","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleStatusAlert(t.row)}}},[e._v("\n                处理\n              ")])]}}])})],1),e._v(" "),a("div",{staticClass:"Pagination"},[a("el-pagination",{attrs:{"current-page":e.pages.page,"page-size":e.pages.pageSize,layout:"total, prev, pager, next",total:e.pages.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)])},staticRenderFns:[]};var ha=a("VU/8")(pa,ma,!1,function(e){a("yaC7")},null,null).exports;s.default.use(i.a);var va=new i.a({routes:[{path:"/superAdmin/login",name:"登录",component:R},{path:"/superAdmin/index",name:"餐饮",component:V,children:[{path:"/superAdmin/mainStore",component:G,meta:[{name:"店家管理",path:"/superAdmin/mainStore"}]},{path:"/superAdmin/active",component:q,meta:[{name:"激活系统",path:"/superAdmin/active"}]}]},{path:"/mainStore/login",name:"登录",component:ae},{path:"/mainStore/index",name:"餐饮",component:Z,children:[{path:"/mainStore/store",component:oe,meta:[{name:"分店管理",path:"/mainStore/store"}]},{path:"/mainStore/goodsTag",component:re,meta:[{name:"菜品标签",path:"/mainStore/goodsTag"}]},{path:"/mainStore/goods",component:ue,meta:[{name:"菜品",path:"/mainStore/goods"}]},{path:"/mainStore/payment",component:me,meta:[{name:"支付配置",path:"/mainStore/payment"}]},{path:"/mainStore/oauth",component:fe,meta:[{name:"授权配置",path:"/mainStore/oauth"}]},{path:"/mainStore/printerDataModel",component:ye,meta:[{name:"打印模板配置",path:"/mainStore/printerDataModel"}]},{path:"/mainStore/orders",component:ke,meta:[{name:"订单管理",path:"/mainStore/orders"}]},{path:"/mainStore/orderDetail",component:De,meta:[{name:"订单详情",path:"/mainStore/orderDetail"}]},{path:"/mainStore/pageView",component:Te,meta:[{name:"主题管理",path:"/mainStore/pageView"}]},{path:"/mainStore/pluginsStore",component:ze,meta:[{name:"插件市场",path:"/mainStore/pluginsStore"}]},{path:"/mainStore/chargeItem",component:Be,meta:[{name:"充值项配置",path:"/mainStore/chargeItem"}]}]},{path:"/store/login",name:"登录",component:je},{path:"/store/index",name:"餐饮",component:He,children:[{path:"/store/goodsTag",component:Je,meta:[{name:"菜品标签",path:"/store/goodsTag"}]},{path:"/store/goods",component:Xe,meta:[{name:"菜品",path:"/store/goods"}]},{path:"/store/payment",component:tt,meta:[{name:"支付配置",path:"/store/payment"}]},{path:"/store/oauth",component:it,meta:[{name:"授权配置",path:"/store/oauth"}]},{path:"/store/printerDataModel",component:lt,meta:[{name:"打印模板配置",path:"/store/printerDataModel"}]},{path:"/store/printer",component:dt,meta:[{name:"打印机管理",path:"/store/printer"}]},{path:"/store/storeUser",component:pt,meta:[{name:"店员管理",path:"/store/storeUser"}]},{path:"/store/tables",component:vt,meta:[{name:"餐桌管理",path:"/store/tables"}]},{path:"/store/orders",component:bt,meta:[{name:"订单管理",path:"/store/orders"}]},{path:"/store/setting",component:$t,meta:[{name:"系统设置",path:"/store/setting"}]},{path:"/store/orderDetail",component:St,meta:[{name:"订单详情",path:"/store/orderDetail"}]},{path:"/store/pageView",component:Ft,meta:[{name:"主题管理",path:"/store/pageView"}]},{path:"/store/pluginsStore",component:Vt,meta:[{name:"插件市场",path:"/store/pluginsStore"}]},{path:"/store/callTag",component:Et,meta:[{name:"呼叫服务",path:"/store/callTag"}]},{path:"/store/callLog",component:Mt,meta:[{name:"呼叫记录",path:"/store/callLog"}]},{path:"/store/chargeItem",component:It,meta:[{name:"充值项配置",path:"/store/chargeItem"}]},{path:"/store/consumer",component:Ht,meta:[{name:"会员管理",path:"/store/consumer"}]},{path:"/store/orderFoodPluginsConfig",component:jt,meta:[{name:"客人端功能管理",path:"/store/orderFoodPluginsConfig"}]}]},{path:"/storeUser/login",name:"登录",component:sa},{path:"/storeUser/index",name:"餐饮",component:ea,children:[{path:"/storeUser/cart",component:na,meta:[{name:"下单",path:"/storeUser/cart"}]},{path:"/storeUser/orderDetail",component:ca,meta:[{name:"订单详情",path:"/storeUser/orderDetail"}]},{path:"/storeUser/orderGoods",component:ga,meta:[{name:"菜品队列",path:"/storeUser/orderGoods"}]},{path:"/storeUser/callLog",component:ha,meta:[{name:"呼叫记录",path:"/storeUser/callLog"}]}]},{path:"/",name:"登录",component:sa}]}),fa=a("mtWM"),_a=a.n(fa),ba=(a("OAwv"),_a.a.create({baseURL:E,headers:{"Content-Type":"application/x-www-form-urlencoded;charset=utf-8"},transformRequest:[function(e){var t="";for(var a in e)!0===e.hasOwnProperty(a)&&(t+=encodeURIComponent(a)+"="+encodeURIComponent(e[a])+"&");return t}]}));function ya(e,t,a,s){ba({method:e,url:t,data:"POST"===e||"PUT"===e?a:null,params:"GET"===e||"DELETE"===e?a:null}).then(function(e){console.log(e.data),200!=e.status||5001!=e.data.code&&5002!=e.data.code&&5003!=e.data.code||alert("登录授权失效,请重新登录"),s(e)}).catch(function(e){alert("服务器异常,请重新登录"),s(e)})}function wa(e){var t=window.localStorage.access_token;return e=-1==(e=-1==e.indexOf("?")?e+"?access_token="+t:e+"&access_token="+t).indexOf("?")?e+"?t="+(new Date).getTime():e+"&t="+(new Date).getTime()}var $a={get:function(e,t,a){return ya("GET",e=wa(e),t,a)},post:function(e,t,a){return ya("POST",e=wa(e),t,a)},put:function(e,t,a){return ya("PUT",e=wa(e),t,a)},delete:function(e,t,a){return ya("DELETE",e=wa(e),t,a)}},ka=a("zL8q"),xa=a.n(ka),Sa=(a("tvR6"),a("9n10"),a("slWF"),a("/Cky"),{render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},staticRenderFns:[]});var Da=a("VU/8")({name:"App"},Sa,!1,function(e){a("s347")},null,null).exports;s.default.use(xa.a),s.default.prototype.$api=$a,s.default.config.productionTip=!1,new s.default({el:"#app",router:va,store:D,render:function(e){return e(Da)}})},PYJd:function(e,t){},SWsK:function(e,t){},SeMU:function(e,t){},"T2+6":function(e,t){},TpYb:function(e,t){},VCSu:function(e,t){},Vz5t:function(e,t){},WuM8:function(e,t){},XbXr:function(e,t){},Xzez:function(e,t){},aDtV:function(e,t){},"afH/":function(e,t){},bbGG:function(e,t){},c3yv:function(e,t){},duFb:function(e,t){},eCHU:function(e,t){},hNsE:function(e,t){},lCZh:function(e,t){},lKUa:function(e,t){},lQ6k:function(e,t){},n1kp:function(e,t){},ncbP:function(e,t){},nnuq:function(e,t){},oTwl:function(e,t){},plYR:function(e,t){},poa5:function(e,t){},q405:function(e,t){},qDlq:function(e,t){},qywH:function(e,t){},rIQ4:function(e,t){},rj0c:function(e,t){},s347:function(e,t){},sCHi:function(e,t){},slWF:function(e,t){},tvR6:function(e,t){},x8PG:function(e,t){},xAP0:function(e,t){},yaC7:function(e,t){},zWrd:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.368505aa1cd5149c550d.js.map